<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="These are the Course Notes for 432.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the Course Notes for 432." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="These are the Course Notes for 432." />
  

<meta name="author" content="Thomas E. Love, Ph.D.">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="two-factor-analysis-of-variance-and-interactions.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">432 Course Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a></li>
<li class="chapter" data-level="" data-path="data-used-in-these-notes.html"><a href="data-used-in-these-notes.html"><i class="fa fa-check"></i>Data used in these notes</a></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a><ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.1</b> Two examples from the <em>New England Journal of Medicine</em></a><ul>
<li class="chapter" data-level="1.1.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.1.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.1.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.1.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.2</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.3</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.4</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a><ul>
<li class="chapter" data-level="1.4.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.4.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.4.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.4.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.5</b> <code>fakestroke</code> Table 1: Attempt 2</a><ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.5.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.6</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.7</b> Exporting the Completed Table 1 from R to Excel or Word</a><ul>
<li class="chapter" data-level="1.7.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.7.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.7.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.7.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.8</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.9</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.10</b> A Table 1 for <code>bloodbrain</code></a><ul>
<li class="chapter" data-level="1.10.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.10.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.10.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.10.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html"><i class="fa fa-check"></i><b>2</b> Linear Regression on a small SMART data set</a><ul>
<li class="chapter" data-level="2.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#brfss-and-smart"><i class="fa fa-check"></i><b>2.1</b> BRFSS and SMART</a><ul>
<li class="chapter" data-level="2.1.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#key-resources"><i class="fa fa-check"></i><b>2.1.1</b> Key resources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-smartcle1-data-cookbook"><i class="fa fa-check"></i><b>2.2</b> The <code>smartcle1</code> data: Cookbook</a></li>
<li class="chapter" data-level="2.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#smartcle2-omitting-missing-observations-complete-case-analyses"><i class="fa fa-check"></i><b>2.3</b> <code>smartcle2</code>: Omitting Missing Observations: Complete-Case Analyses</a></li>
<li class="chapter" data-level="2.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#summarizing-the-smartcle2-data-numerically"><i class="fa fa-check"></i><b>2.4</b> Summarizing the <code>smartcle2</code> data numerically</a><ul>
<li class="chapter" data-level="2.4.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-new-toy-the-skim-function"><i class="fa fa-check"></i><b>2.4.1</b> The New Toy: The <code>skim</code> function</a></li>
<li class="chapter" data-level="2.4.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-usual-summary-for-a-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> The usual <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>2.4.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>2.5</b> Counting as exploratory data analysis</a><ul>
<li class="chapter" data-level="2.5.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-respondents-had-exercised-in-the-past-30-days-did-this-vary-by-sex"><i class="fa fa-check"></i><b>2.5.1</b> How many respondents had exercised in the past 30 days? Did this vary by sex?</a></li>
<li class="chapter" data-level="2.5.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#whats-the-distribution-of-sleephrs"><i class="fa fa-check"></i><b>2.5.2</b> What’s the distribution of <code>sleephrs</code>?</a></li>
<li class="chapter" data-level="2.5.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>2.5.3</b> What’s the distribution of <code>BMI</code>?</a></li>
<li class="chapter" data-level="2.5.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>2.5.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="2.5.5" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-of-the-respondents-who-have-a-bmi-30-exercised"><i class="fa fa-check"></i><b>2.5.5</b> How many of the respondents who have a BMI &lt; 30 exercised?</a></li>
<li class="chapter" data-level="2.5.6" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#is-obesity-associated-with-sex-in-these-data"><i class="fa fa-check"></i><b>2.5.6</b> Is obesity associated with sex, in these data?</a></li>
<li class="chapter" data-level="2.5.7" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#comparing-sleephrs-summaries-by-obesity-status"><i class="fa fa-check"></i><b>2.5.7</b> Comparing <code>sleephrs</code> summaries by obesity status</a></li>
<li class="chapter" data-level="2.5.8" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-skim-function-within-a-pipe"><i class="fa fa-check"></i><b>2.5.8</b> The <code>skim</code> function within a pipe</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#first-modeling-attempt-can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>2.6</b> First Modeling Attempt: Can <code>bmi</code> predict <code>physhealth</code>?</a><ul>
<li class="chapter" data-level="2.6.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>2.6.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="2.6.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>2.6.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="2.6.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#using-the-broom-package"><i class="fa fa-check"></i><b>2.6.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="2.6.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-does-the-model-do-residuals-vs.fitted-values"><i class="fa fa-check"></i><b>2.6.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>2.7</b> A New Small Study: Predicting BMI</a><ul>
<li class="chapter" data-level="2.7.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#does-female-predict-bmi-well"><i class="fa fa-check"></i><b>2.7.1</b> Does <code>female</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>2.8</b> <code>c2_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="2.9" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>2.9</b> <code>c2_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="2.10" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>2.10</b> <code>c2_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="2.11" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m4-using-female-and-sleephrs-in-a-model-for-bmi"><i class="fa fa-check"></i><b>2.11</b> <code>c2_m4</code>: Using <code>female</code> and <code>sleephrs</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="2.12" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>2.12</b> <code>c2_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="2.13" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>2.13</b> <code>c2_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="2.14" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m7-what-if-we-added-days-of-work-missed"><i class="fa fa-check"></i><b>2.14</b> <code>c2_m7</code>: What if we added days of work missed?</a></li>
<li class="chapter" data-level="2.15" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#draft-material-how-might-we-validate-this-model"><i class="fa fa-check"></i><b>2.15</b> (DRAFT material) How might we validate this model?</a></li>
<li class="chapter" data-level="2.16" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#coming-soon"><i class="fa fa-check"></i><b>2.16</b> Coming Soon …</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html"><i class="fa fa-check"></i><b>3</b> Two-Factor Analysis of Variance and Interactions</a><ul>
<li class="chapter" data-level="3.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>3.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a><ul>
<li class="chapter" data-level="3.1.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#looking-at-the-data"><i class="fa fa-check"></i><b>3.1.1</b> Looking at the Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>3.2</b> A Means Plot (with standard deviations) to check for interaction</a><ul>
<li class="chapter" data-level="3.2.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#skimming-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>3.2.1</b> Skimming the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>3.3</b> Fitting the Two-Way ANOVA model with Interaction</a><ul>
<li class="chapter" data-level="3.3.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>3.3.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="3.3.2" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#is-the-interaction-important"><i class="fa fa-check"></i><b>3.3.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="3.3.3" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>3.3.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>3.4</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="3.5" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>3.5</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="3.6" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>3.6</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a><ul>
<li class="chapter" data-level="3.6.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>3.6.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>3.6.2</b> Creating a factor combining sex and waist</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>3.7</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="3.8" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>3.8</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a></li>
<li class="chapter" data-level="3.9" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>3.9</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a><ul>
<li class="chapter" data-level="3.9.1" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-graph"><i class="fa fa-check"></i><b>3.9.1</b> The Graph</a></li>
<li class="chapter" data-level="3.9.2" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-anova-model"><i class="fa fa-check"></i><b>3.9.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="3.9.3" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#the-regression-summary"><i class="fa fa-check"></i><b>3.9.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="3.9.4" data-path="two-factor-analysis-of-variance-and-interactions.html"><a href="two-factor-analysis-of-variance-and-interactions.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>3.9.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html"><i class="fa fa-check"></i><b>4</b> Missing Data, 1: Mechanisms and Single Imputation Methods</a><ul>
<li class="chapter" data-level="4.1" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#a-toy-example"><i class="fa fa-check"></i><b>4.1</b> A Toy Example</a><ul>
<li class="chapter" data-level="4.1.1" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#how-many-missing-values-do-we-have-in-each-column"><i class="fa fa-check"></i><b>4.1.1</b> How many missing values do we have in each column?</a></li>
<li class="chapter" data-level="4.1.2" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#what-is-the-pattern-of-missing-data"><i class="fa fa-check"></i><b>4.1.2</b> What is the pattern of missing data?</a></li>
<li class="chapter" data-level="4.1.3" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#how-can-we-identify-the-subjects-with-missing-data"><i class="fa fa-check"></i><b>4.1.3</b> How can we identify the subjects with missing data?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>4.2</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="4.3" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>4.3</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="4.4" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>4.4</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="4.5" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#single-imputation"><i class="fa fa-check"></i><b>4.5</b> Single Imputation</a></li>
<li class="chapter" data-level="4.6" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#multiple-imputation"><i class="fa fa-check"></i><b>4.6</b> Multiple Imputation</a></li>
<li class="chapter" data-level="4.7" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#building-a-complete-case-analysis"><i class="fa fa-check"></i><b>4.7</b> Building a Complete Case Analysis</a></li>
<li class="chapter" data-level="4.8" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#single-imputation-with-the-mean-or-mode"><i class="fa fa-check"></i><b>4.8</b> Single Imputation with the Mean or Mode</a></li>
<li class="chapter" data-level="4.9" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#doing-single-imputation-with-simputation"><i class="fa fa-check"></i><b>4.9</b> Doing Single Imputation with <code>simputation</code></a><ul>
<li class="chapter" data-level="4.9.1" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#mirroring-our-prior-approach-imputing-meansmediansmodes"><i class="fa fa-check"></i><b>4.9.1</b> Mirroring Our Prior Approach (imputing means/medians/modes)</a></li>
<li class="chapter" data-level="4.9.2" data-path="missing-data-1-mechanisms-and-single-imputation-methods.html"><a href="missing-data-1-mechanisms-and-single-imputation-methods.html#using-a-model-to-impute-sbp.before-and-diabetes"><i class="fa fa-check"></i><b>4.9.2</b> Using a model to impute <code>sbp.before</code> and <code>diabetes</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="missing-data-1-mechanisms-and-single-imputation-methods" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Missing Data, 1: Mechanisms and Single Imputation Methods</h1>
<p>Almost all serious statistical analyses have to deal with missing data. Data values that are missing are indicated in R, and to R, by the symbol <code>NA</code>.</p>
<div id="a-toy-example" class="section level2">
<h2><span class="header-section-number">4.1</span> A Toy Example</h2>
<p>In the following tiny data set called <code>sbp_example</code>, we have four variables for a set of 15 subjects. In addition to a subject id, we have:</p>
<ul>
<li>the treatment this subject received (A, B or C are the treatments),</li>
<li>an indicator (1 = yes, 0 = no) of whether the subject has diabetes,</li>
<li>the subject’s systolic blood pressure at baseline</li>
<li>the subject’s systolic blood pressure after the application of the treatment</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create some temporary variables</span>

subject &lt;-<span class="st"> </span><span class="dv">101</span><span class="op">:</span><span class="dv">115</span>
x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)
x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="ot">NA</span>)
x3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">120</span>, <span class="dv">145</span>, <span class="dv">150</span>, <span class="ot">NA</span>, <span class="dv">155</span>, <span class="ot">NA</span>, <span class="dv">135</span>, <span class="ot">NA</span>, <span class="dv">115</span>, <span class="dv">170</span>, <span class="dv">150</span>, <span class="dv">145</span>, <span class="dv">140</span>, <span class="dv">160</span>, <span class="dv">135</span>)
x4 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">105</span>, <span class="dv">135</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">135</span>, <span class="dv">115</span>, <span class="dv">160</span>, <span class="dv">150</span>, <span class="dv">130</span>, <span class="dv">155</span>, <span class="dv">140</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">135</span>, <span class="dv">120</span>)

sbp_example &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>(subject, <span class="dt">treat =</span> x1, <span class="dt">diabetes =</span> x2, 
             <span class="dt">sbp.before =</span> x3, <span class="dt">sbp.after =</span> x4) <span class="op">%&gt;%</span>
<span class="st">  </span>tbl_df

<span class="kw">rm</span>(subject, x1, x2, x3, x4) <span class="co"># just cleaning up</span>

sbp_example</code></pre></div>
<pre><code># A tibble: 15 x 5
   subject treat diabetes sbp.before sbp.after
     &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1     101 A         1.00        120       105
 2     102 B         0           145       135
 3     103 C         0           150       150
 4     104 A         1.00         NA       120
 5     105 C        NA           155       135
 6     106 A         1.00         NA       115
 7     107 A         0           135       160
 8     108 &lt;NA&gt;      1.00         NA       150
 9     109 B        NA           115       130
10     110 C         1.00        170       155
11     111 A         0           150       140
12     112 B         0           145       140
13     113 C         1.00        140       150
14     114 A         1.00        160       135
15     115 B        NA           135       120</code></pre>
<div id="how-many-missing-values-do-we-have-in-each-column" class="section level3">
<h3><span class="header-section-number">4.1.1</span> How many missing values do we have in each column?</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(<span class="kw">is.na</span>(sbp_example))</code></pre></div>
<pre><code>   subject      treat   diabetes sbp.before  sbp.after 
         0          1          3          3          0 </code></pre>
<p>We are missing one <code>treat</code>, 3 <code>diabetes</code> and 3 <code>sbp.before</code> values.</p>
</div>
<div id="what-is-the-pattern-of-missing-data" class="section level3">
<h3><span class="header-section-number">4.1.2</span> What is the pattern of missing data?</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mice<span class="op">::</span><span class="kw">md.pattern</span>(sbp_example)</code></pre></div>
<pre><code>  subject sbp.after treat diabetes sbp.before  
9       1         1     1        1          1 0
3       1         1     1        0          1 1
2       1         1     1        1          0 1
1       1         1     0        1          0 2
        0         0     1        3          3 7</code></pre>
<p>We have nine subjects with complete data, three subjects with missing <code>diabetes</code> (only), two subjects with missing <code>sbp.before</code> (only), and 1 subject with missing <code>treat</code> and <code>sbp.before</code>.</p>
</div>
<div id="how-can-we-identify-the-subjects-with-missing-data" class="section level3">
<h3><span class="header-section-number">4.1.3</span> How can we identify the subjects with missing data?</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sbp_example <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">complete.cases</span>(.))</code></pre></div>
<pre><code># A tibble: 6 x 5
  subject treat diabetes sbp.before sbp.after
    &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1     104 A         1.00         NA       120
2     105 C        NA           155       135
3     106 A         1.00         NA       115
4     108 &lt;NA&gt;      1.00         NA       150
5     109 B        NA           115       130
6     115 B        NA           135       120</code></pre>
</div>
</div>
<div id="missing-data-mechanisms" class="section level2">
<h2><span class="header-section-number">4.2</span> Missing-data mechanisms</h2>
<p>My source for this description of mechanisms is Chapter 25 of <span class="citation">Gelman and Hill (<a href="#ref-GelmanHill2007">2007</a>)</span>, and that chapter is <a href="http://www.stat.columbia.edu/~gelman/arm/missing.pdf">available at this link</a>.</p>
<ol style="list-style-type: decimal">
<li><strong>MCAR = Missingness completely at random</strong>. A variable is missing completely at random if the probability of missingness is the same for all units, for example, if for each subject, we decide whether to collect the <code>diabetes</code> status by rolling a die and refusing to answer if a “6” shows up. If data are missing completely at random, then throwing out cases with missing data does not bias your inferences.</li>
<li><strong>Missingness that depends only on observed predictors</strong>. A more general assumption, called <strong>missing at random</strong> or <strong>MAR</strong>, is that the probability a variable is missing depends only on available information. Here, we would have to be willing to assume that the probability of nonresponse to <code>diabetes</code> depends only on the other, fully recorded variables in the data. It is often reasonable to model this process as a logistic regression, where the outcome variable equals 1 for observed cases and 0 for missing. When an outcome variable is missing at random, it is acceptable to exclude the missing cases (that is, to treat them as NA), as long as the regression controls for all the variables that affect the probability of missingness.</li>
<li><strong>Missingness that depends on unobserved predictors</strong>. Missingness is no longer “at random” if it depends on information that has not been recorded and this information also predicts the missing values. If a particular treatment causes discomfort, a patient is more likely to drop out of the study. This missingness is not at random (unless “discomfort” is measured and observed for all patients). If missingness is not at random, it must be explicitly modeled, or else you must accept some bias in your inferences.</li>
<li><strong>Missingness that depends on the missing value itself.</strong> Finally, a particularly difficult situation arises when the probability of missingness depends on the (potentially missing) variable itself. For example, suppose that people with higher earnings are less likely to reveal them.</li>
</ol>
<p>Essentially, situations 3 and 4 are referred to collectively as <strong>non-random missingness</strong>, and cause more trouble for us than 1 and 2.</p>
</div>
<div id="options-for-dealing-with-missingness" class="section level2">
<h2><span class="header-section-number">4.3</span> Options for Dealing with Missingness</h2>
<p>There are several available methods for dealing with missing data that are MCAR or MAR, but they basically boil down to:</p>
<ul>
<li>Complete Case (or Available Case) analyses</li>
<li>Single Imputation</li>
<li>Multiple Imputation</li>
</ul>
</div>
<div id="complete-case-and-available-case-analyses" class="section level2">
<h2><span class="header-section-number">4.4</span> Complete Case (and Available Case) analyses</h2>
<p>In <strong>Complete Case</strong> analyses, rows containing NA values are omitted from the data before analyses commence. This is the default approach for many statistical software packages, and may introduce unpredictable bias and fail to include some useful, often hard-won information.</p>
<ul>
<li>A complete case analysis can be appropriate when the number of missing observations is not large, and the missing pattern is either MCAR (missing completely at random) or MAR (missing at random.)</li>
<li>Two problems arise with complete-case analysis:
<ol style="list-style-type: decimal">
<li>If the units with missing values differ systematically from the completely observed cases, this could bias the complete-case analysis.</li>
<li>If many variables are included in a model, there may be very few complete cases, so that most of the data would be discarded for the sake of a straightforward analysis.</li>
</ol></li>
<li>A related approach is <em>available-case</em> analysis where different aspects of a problem are studied with different subsets of the data, perhaps identified on the basis of what is missing in them.</li>
</ul>
</div>
<div id="single-imputation" class="section level2">
<h2><span class="header-section-number">4.5</span> Single Imputation</h2>
<p>In <strong>single imputation</strong> analyses, NA values are estimated/replaced <em>one time</em> with <em>one particular data value</em> for the purpose of obtaining more complete samples, at the expense of creating some potential bias in the eventual conclusions or obtaining slightly <em>less</em> accurate estimates than would be available if there were no missing values in the data.</p>
<ul>
<li>A single imputation can be just a replacement with the mean or median (for a quantity) or the mode (for a categorical variable.) However, such an approach, though easy to understand, underestimates variance and ignores the relationship of missing values to other variables.</li>
<li>Single imputation can also be done using a variety of models to try to capture information about the NA values that are available in other variables within the data set.</li>
<li>The <code>simputation</code> package can help us execute single imputations using a wide variety of techniques, within the pipe approach used by the <code>tidyverse</code>. Another approach I have used in the past is the <code>mice</code> package, which can also perform single imputations.</li>
</ul>
</div>
<div id="multiple-imputation" class="section level2">
<h2><span class="header-section-number">4.6</span> Multiple Imputation</h2>
<p><strong>Multiple imputation</strong>, where NA values are repeatedly estimated/replaced with multiple data values, for the purpose of obtaining mode complete samples <em>and</em> capturing details of the variation inherent in the fact that the data have missingness, so as to obtain <em>more</em> accurate estimates than are possible with single imputation.</p>
<ul>
<li>We’ll postpone the discussion of multiple imputation for a while.</li>
</ul>
</div>
<div id="building-a-complete-case-analysis" class="section level2">
<h2><span class="header-section-number">4.7</span> Building a Complete Case Analysis</h2>
<p>We can drop all of the missing values from a data set with <code>drop_na</code> or with <code>na.omit</code> or by filtering for <code>complete.cases</code>. Any of these approaches produces the same result - a new data set with 9 rows (after dropping the six subjects with any NA values) and 5 columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">na.omit</span>(sbp_example)
cc.<span class="dv">2</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span><span class="st"> </span>drop_na
cc.<span class="dv">3</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))</code></pre></div>
</div>
<div id="single-imputation-with-the-mean-or-mode" class="section level2">
<h2><span class="header-section-number">4.8</span> Single Imputation with the Mean or Mode</h2>
<p>The most straightforward approach to single imputation is to impute a single summary of the variable, such as the mean, median or mode.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">skim</span>(sbp_example)</code></pre></div>
<pre><code>Skim summary statistics
 n obs: 15 
 n variables: 5 

Variable type: factor 
 variable missing complete  n n_unique              top_counts ordered
    treat       1       14 15        3 A: 6, B: 4, C: 4, NA: 1   FALSE

Variable type: integer 
 variable missing complete  n mean   sd  p0   p25 median   p75 p100
  subject       0       15 15  108 4.47 101 104.5    108 111.5  115

Variable type: numeric 
   variable missing complete  n   mean    sd  p0 p25 median    p75 p100
   diabetes       3       12 15   0.58  0.51   0   0      1   1       1
  sbp.after       0       15 15 136    15.83 105 125    135 150     160
 sbp.before       3       12 15 143.33 15.72 115 135    145 151.25  170</code></pre>
<p>Here, suppose we decide to impute</p>
<ul>
<li><code>sbp.before</code> with the mean (143.33) among non-missing values,</li>
<li><code>diabetes</code> with its median (1) among non-missing values, and</li>
<li><code>treat</code> with its most common value, or mode (A)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">si.<span class="dv">1</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">sbp.before =</span> <span class="fl">143.33</span>,
                    <span class="dt">diabetes =</span> <span class="dv">1</span>,
                    <span class="dt">treat =</span> <span class="st">&quot;A&quot;</span>))
si.<span class="dv">1</span></code></pre></div>
<pre><code># A tibble: 15 x 5
   subject treat diabetes sbp.before sbp.after
     &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1     101 A         1.00        120       105
 2     102 B         0           145       135
 3     103 C         0           150       150
 4     104 A         1.00        143       120
 5     105 C         1.00        155       135
 6     106 A         1.00        143       115
 7     107 A         0           135       160
 8     108 A         1.00        143       150
 9     109 B         1.00        115       130
10     110 C         1.00        170       155
11     111 A         0           150       140
12     112 B         0           145       140
13     113 C         1.00        140       150
14     114 A         1.00        160       135
15     115 B         1.00        135       120</code></pre>
<p>We could accomplish the same thing with, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">si.<span class="dv">2</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">sbp.before =</span> <span class="kw">mean</span>(sbp_example<span class="op">$</span>sbp.before, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                    <span class="dt">diabetes =</span> <span class="kw">median</span>(sbp_example<span class="op">$</span>diabetes, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                    <span class="dt">treat =</span> <span class="st">&quot;A&quot;</span>))</code></pre></div>
</div>
<div id="doing-single-imputation-with-simputation" class="section level2">
<h2><span class="header-section-number">4.9</span> Doing Single Imputation with <code>simputation</code></h2>
<p>Single imputation is a potentially appropriate method when missingness can be assumed to be either completely at random (MCAR) or dependent only on observed predictors (MAR). We’ll use the <code>simputation</code> package to accomplish it.</p>
<ul>
<li>The <code>simputation</code> vignette is available at <a href="https://cran.r-project.org/web/packages/simputation/vignettes/intro.html" class="uri">https://cran.r-project.org/web/packages/simputation/vignettes/intro.html</a></li>
<li>The <code>simputation</code> reference manual is available at <a href="https://cran.r-project.org/web/packages/simputation/simputation.pdf" class="uri">https://cran.r-project.org/web/packages/simputation/simputation.pdf</a></li>
</ul>
<div id="mirroring-our-prior-approach-imputing-meansmediansmodes" class="section level3">
<h3><span class="header-section-number">4.9.1</span> Mirroring Our Prior Approach (imputing means/medians/modes)</h3>
<p>Suppose we want to mirror what we did above, simply impute the mean for <code>sbp.before</code> and the median for <code>diabetes</code> again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">si.<span class="dv">3</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_lm</span>(sbp.before <span class="op">~</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_median</span>(diabetes <span class="op">~</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">treat =</span> <span class="st">&quot;A&quot;</span>))

si.<span class="dv">3</span></code></pre></div>
<pre><code># A tibble: 15 x 5
   subject treat diabetes sbp.before sbp.after
 *   &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1     101 A         1.00        120       105
 2     102 B         0           145       135
 3     103 C         0           150       150
 4     104 A         1.00        143       120
 5     105 C         1.00        155       135
 6     106 A         1.00        143       115
 7     107 A         0           135       160
 8     108 A         1.00        143       150
 9     109 B         1.00        115       130
10     110 C         1.00        170       155
11     111 A         0           150       140
12     112 B         0           145       140
13     113 C         1.00        140       150
14     114 A         1.00        160       135
15     115 B         1.00        135       120</code></pre>
</div>
<div id="using-a-model-to-impute-sbp.before-and-diabetes" class="section level3">
<h3><span class="header-section-number">4.9.2</span> Using a model to impute <code>sbp.before</code> and <code>diabetes</code></h3>
<p>Suppose we wanted to use:</p>
<ul>
<li>a robust linear model to predict <code>sbp.before</code> missing values, on the basis of <code>sbp.after</code> and <code>diabetes</code> status, and</li>
<li>a predictive mean matching approach to predict <code>diabetes</code> status, on the basis of <code>sbp.after</code>, and</li>
<li>a decision tree approach to predict <code>treat</code> status, using all other variables in the data</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">50001</span>)

imp.<span class="dv">4</span> &lt;-<span class="st"> </span>sbp_example <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_rlm</span>(sbp.before <span class="op">~</span><span class="st"> </span>sbp.after <span class="op">+</span><span class="st"> </span>diabetes) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_pmm</span>(diabetes <span class="op">~</span><span class="st"> </span>sbp.after) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_cart</span>(treat <span class="op">~</span><span class="st"> </span>.)

imp.<span class="dv">4</span></code></pre></div>
<pre><code># A tibble: 15 x 5
   subject treat diabetes sbp.before sbp.after
 *   &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1     101 A         1.00        120       105
 2     102 B         0           145       135
 3     103 C         0           150       150
 4     104 A         1.00        139       120
 5     105 C         1.00        155       135
 6     106 A         1.00        136       115
 7     107 A         0           135       160
 8     108 A         1.00        155       150
 9     109 B         1.00        115       130
10     110 C         1.00        170       155
11     111 A         0           150       140
12     112 B         0           145       140
13     113 C         1.00        140       150
14     114 A         1.00        160       135
15     115 B         1.00        135       120</code></pre>
<p>Details on the many available methods in <code>simputation</code> are provided <a href="https://cran.r-project.org/web/packages/simputation/simputation.pdf">in its manual</a>. These include:</p>
<ul>
<li><code>impute_cart</code> uses a Classification and Regression Tree approach for numerical or categorical data. There is also an <code>impute_rf</code> command which uses Random Forests for imputation.</li>
<li><code>impute_pmm</code> is one of several “hot deck” options for imputation, this one is predictive mean matching, which can be used with numeric data (only). Missing values are first imputed using a predictive model. Next, these predictions are replaced with the observed values which are nearest to the prediction. Other imputation options in this group include random hot deck, sequential hot deck and k-nearest neighbor imputation.</li>
<li><code>impute_rlm</code> is one of several regression imputation methods, including linear models, robust linear models (which use what is called M-estimation to impute numerical variables) and lasso/elastic net/ridge regression models.</li>
</ul>
<p><code>simputation</code> can also do EM-based multivariate imputation, and multivariate random forest imputation, as well as many other sorts of approaches.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-GelmanHill2007">
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. New York: Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="two-factor-analysis-of-variance-and-interactions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-missingdata1.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
