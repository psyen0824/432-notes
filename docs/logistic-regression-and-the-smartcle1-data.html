<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="These are the Course Notes for 432.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the Course Notes for 432." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="These are the Course Notes for 432." />
  

<meta name="author" content="Thomas E. Love, Ph.D.">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="logistic-regression-and-the-resect-data.html">
<link rel="next" href="linear-regression-and-the-smartcle1-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">432 Course Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a></li>
<li class="chapter" data-level="" data-path="data-used-in-these-notes.html"><a href="data-used-in-these-notes.html"><i class="fa fa-check"></i>Data used in these notes</a></li>
<li class="chapter" data-level="" data-path="special-functions-used-in-these-notes.html"><a href="special-functions-used-in-these-notes.html"><i class="fa fa-check"></i>Special Functions used in these notes</a></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a><ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.1</b> Two examples from the <em>New England Journal of Medicine</em></a><ul>
<li class="chapter" data-level="1.1.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.1.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.1.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.1.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.2</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.3</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.4</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a><ul>
<li class="chapter" data-level="1.4.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.4.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.4.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.4.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.5</b> <code>fakestroke</code> Table 1: Attempt 2</a><ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.5.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.6</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.7</b> Exporting the Completed Table 1 from R to Excel or Word</a><ul>
<li class="chapter" data-level="1.7.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.7.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.7.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.7.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.8</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.9</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.10</b> A Table 1 for <code>bloodbrain</code></a><ul>
<li class="chapter" data-level="1.10.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.10.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.10.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.10.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html"><i class="fa fa-check"></i><b>2</b> Linear Regression on a small SMART data set</a><ul>
<li class="chapter" data-level="2.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#brfss-and-smart"><i class="fa fa-check"></i><b>2.1</b> BRFSS and SMART</a><ul>
<li class="chapter" data-level="2.1.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#key-resources"><i class="fa fa-check"></i><b>2.1.1</b> Key resources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-smartcle1-data-cookbook"><i class="fa fa-check"></i><b>2.2</b> The <code>smartcle1</code> data: Cookbook</a></li>
<li class="chapter" data-level="2.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#smartcle2-omitting-missing-observations-complete-case-analyses"><i class="fa fa-check"></i><b>2.3</b> <code>smartcle2</code>: Omitting Missing Observations: Complete-Case Analyses</a></li>
<li class="chapter" data-level="2.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#summarizing-the-smartcle2-data-numerically"><i class="fa fa-check"></i><b>2.4</b> Summarizing the <code>smartcle2</code> data numerically</a><ul>
<li class="chapter" data-level="2.4.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-new-toy-the-skim-function"><i class="fa fa-check"></i><b>2.4.1</b> The New Toy: The <code>skim</code> function</a></li>
<li class="chapter" data-level="2.4.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-usual-summary-for-a-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> The usual <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>2.4.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>2.5</b> Counting as exploratory data analysis</a><ul>
<li class="chapter" data-level="2.5.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-respondents-had-exercised-in-the-past-30-days-did-this-vary-by-sex"><i class="fa fa-check"></i><b>2.5.1</b> How many respondents had exercised in the past 30 days? Did this vary by sex?</a></li>
<li class="chapter" data-level="2.5.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#whats-the-distribution-of-sleephrs"><i class="fa fa-check"></i><b>2.5.2</b> What’s the distribution of <code>sleephrs</code>?</a></li>
<li class="chapter" data-level="2.5.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>2.5.3</b> What’s the distribution of <code>BMI</code>?</a></li>
<li class="chapter" data-level="2.5.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>2.5.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="2.5.5" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-many-of-the-respondents-who-have-a-bmi-30-exercised"><i class="fa fa-check"></i><b>2.5.5</b> How many of the respondents who have a BMI &lt; 30 exercised?</a></li>
<li class="chapter" data-level="2.5.6" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#is-obesity-associated-with-sex-in-these-data"><i class="fa fa-check"></i><b>2.5.6</b> Is obesity associated with sex, in these data?</a></li>
<li class="chapter" data-level="2.5.7" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#comparing-sleephrs-summaries-by-obesity-status"><i class="fa fa-check"></i><b>2.5.7</b> Comparing <code>sleephrs</code> summaries by obesity status</a></li>
<li class="chapter" data-level="2.5.8" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#the-skim-function-within-a-pipe"><i class="fa fa-check"></i><b>2.5.8</b> The <code>skim</code> function within a pipe</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#first-modeling-attempt-can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>2.6</b> First Modeling Attempt: Can <code>bmi</code> predict <code>physhealth</code>?</a><ul>
<li class="chapter" data-level="2.6.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>2.6.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="2.6.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>2.6.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="2.6.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#using-the-broom-package"><i class="fa fa-check"></i><b>2.6.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="2.6.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#how-does-the-model-do-residuals-vs.fitted-values"><i class="fa fa-check"></i><b>2.6.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>2.7</b> A New Small Study: Predicting BMI</a><ul>
<li class="chapter" data-level="2.7.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#does-female-predict-bmi-well"><i class="fa fa-check"></i><b>2.7.1</b> Does <code>female</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>2.8</b> <code>c2_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="2.9" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>2.9</b> <code>c2_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="2.10" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>2.10</b> <code>c2_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="2.11" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m4-using-female-and-sleephrs-in-a-model-for-bmi"><i class="fa fa-check"></i><b>2.11</b> <code>c2_m4</code>: Using <code>female</code> and <code>sleephrs</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="2.12" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#making-predictions-with-a-linear-regression-model"><i class="fa fa-check"></i><b>2.12</b> Making Predictions with a Linear Regression Model</a><ul>
<li class="chapter" data-level="2.12.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#fitting-an-individual-prediction-and-95-prediction-interval"><i class="fa fa-check"></i><b>2.12.1</b> Fitting an Individual Prediction and 95% Prediction Interval</a></li>
<li class="chapter" data-level="2.12.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#confidence-interval-for-an-average-prediction"><i class="fa fa-check"></i><b>2.12.2</b> Confidence Interval for an Average Prediction</a></li>
<li class="chapter" data-level="2.12.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#fitting-multiple-individual-predictions-to-new-data"><i class="fa fa-check"></i><b>2.12.3</b> Fitting Multiple Individual Predictions to New Data</a></li>
<li class="chapter" data-level="2.12.4" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#simulation-to-represent-predictive-uncertainty-in-model-4"><i class="fa fa-check"></i><b>2.12.4</b> Simulation to represent predictive uncertainty in Model 4</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#centering-the-model"><i class="fa fa-check"></i><b>2.13</b> Centering the model</a><ul>
<li class="chapter" data-level="2.13.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#plot-of-model-4-on-centered-sleephrs-c2_m4_c"><i class="fa fa-check"></i><b>2.13.1</b> Plot of Model 4 on Centered <code>sleephrs</code>: <code>c2_m4_c</code></a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#rescaling-an-input-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>2.14</b> Rescaling an input by subtracting the mean and dividing by 2 standard deviations</a><ul>
<li class="chapter" data-level="2.14.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#refitting-model-c2_m4-to-the-rescaled-data"><i class="fa fa-check"></i><b>2.14.1</b> Refitting model <code>c2_m4</code> to the rescaled data</a></li>
<li class="chapter" data-level="2.14.2" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#interpreting-the-model-on-rescaled-data"><i class="fa fa-check"></i><b>2.14.2</b> Interpreting the model on rescaled data</a></li>
<li class="chapter" data-level="2.14.3" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#plot-of-model-on-rescaled-data"><i class="fa fa-check"></i><b>2.14.3</b> Plot of model on rescaled data</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>2.15</b> <code>c2_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="2.16" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>2.16</b> <code>c2_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="2.17" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#c2_m7-what-if-we-added-the-menthealth-variable"><i class="fa fa-check"></i><b>2.17</b> <code>c2_m7</code>: What if we added the <code>menthealth</code> variable?</a></li>
<li class="chapter" data-level="2.18" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#key-regression-assumptions-for-building-effective-prediction-models"><i class="fa fa-check"></i><b>2.18</b> Key Regression Assumptions for Building Effective Prediction Models</a><ul>
<li class="chapter" data-level="2.18.1" data-path="linear-regression-on-a-small-smart-data-set.html"><a href="linear-regression-on-a-small-smart-data-set.html#checking-assumptions-in-model-c2_m7"><i class="fa fa-check"></i><b>2.18.1</b> Checking Assumptions in model <code>c2_m7</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>3</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="3.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>3.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a></li>
<li class="chapter" data-level="3.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-one-factor-analysis-of-variance"><i class="fa fa-check"></i><b>3.2</b> A One-Factor Analysis of Variance</a><ul>
<li class="chapter" data-level="3.2.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#look-at-the-data"><i class="fa fa-check"></i><b>3.2.1</b> Look at the Data!</a></li>
<li class="chapter" data-level="3.2.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#table-of-summary-statistics"><i class="fa fa-check"></i><b>3.2.2</b> Table of Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-looking-at-two-factors"><i class="fa fa-check"></i><b>3.3</b> A Two-Way ANOVA: Looking at Two Factors</a></li>
<li class="chapter" data-level="3.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>3.4</b> A Means Plot (with standard deviations) to check for interaction</a><ul>
<li class="chapter" data-level="3.4.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#skimming-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>3.4.1</b> Skimming the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>3.5</b> Fitting the Two-Way ANOVA model with Interaction</a><ul>
<li class="chapter" data-level="3.5.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>3.5.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="3.5.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#is-the-interaction-important"><i class="fa fa-check"></i><b>3.5.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="3.5.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>3.5.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>3.6</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="3.7" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>3.7</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="3.8" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>3.8</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a><ul>
<li class="chapter" data-level="3.8.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>3.8.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>3.9</b> Creating a factor combining sex and waist</a></li>
<li class="chapter" data-level="3.10" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>3.10</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="3.11" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>3.11</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a></li>
<li class="chapter" data-level="3.12" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>3.12</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a><ul>
<li class="chapter" data-level="3.12.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-graph"><i class="fa fa-check"></i><b>3.12.1</b> The Graph</a></li>
<li class="chapter" data-level="3.12.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-model"><i class="fa fa-check"></i><b>3.12.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="3.12.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-regression-summary"><i class="fa fa-check"></i><b>3.12.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="3.12.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>3.12.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>4</b> Analysis of Covariance</a><ul>
<li class="chapter" data-level="4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#an-emphysema-study"><i class="fa fa-check"></i><b>4.1</b> An Emphysema Study</a><ul>
<li class="chapter" data-level="4.1.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#codebook"><i class="fa fa-check"></i><b>4.1.1</b> Codebook</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#does-sex-affect-the-mean-change-in-theophylline"><i class="fa fa-check"></i><b>4.2</b> Does <code>sex</code> affect the mean change in theophylline?</a></li>
<li class="chapter" data-level="4.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#is-there-an-association-between-age-and-sex-in-this-study"><i class="fa fa-check"></i><b>4.3</b> Is there an association between <code>age</code> and <code>sex</code> in this study?</a></li>
<li class="chapter" data-level="4.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#adding-a-quantitative-covariate-age-to-the-model"><i class="fa fa-check"></i><b>4.4</b> Adding a quantitative covariate, <code>age</code>, to the model</a><ul>
<li class="chapter" data-level="4.4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-model"><i class="fa fa-check"></i><b>4.4.1</b> The ANCOVA model</a></li>
<li class="chapter" data-level="4.4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-table"><i class="fa fa-check"></i><b>4.4.2</b> The ANCOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#rerunning-the-ancova-model-after-simple-imputation"><i class="fa fa-check"></i><b>4.5</b> Rerunning the ANCOVA model after simple imputation</a></li>
<li class="chapter" data-level="4.6" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#looking-at-a-factor-covariate-interaction"><i class="fa fa-check"></i><b>4.6</b> Looking at a factor-covariate interaction</a></li>
<li class="chapter" data-level="4.7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#centering-the-covariate-to-facilitate-ancova-interpretation"><i class="fa fa-check"></i><b>4.7</b> Centering the Covariate to Facilitate ANCOVA Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html"><i class="fa fa-check"></i><b>5</b> Missing Data Mechanisms and Single Imputation</a><ul>
<li class="chapter" data-level="5.1" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#a-toy-example"><i class="fa fa-check"></i><b>5.1</b> A Toy Example</a><ul>
<li class="chapter" data-level="5.1.1" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#how-many-missing-values-do-we-have-in-each-column"><i class="fa fa-check"></i><b>5.1.1</b> How many missing values do we have in each column?</a></li>
<li class="chapter" data-level="5.1.2" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#what-is-the-pattern-of-missing-data"><i class="fa fa-check"></i><b>5.1.2</b> What is the pattern of missing data?</a></li>
<li class="chapter" data-level="5.1.3" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#how-can-we-identify-the-subjects-with-missing-data"><i class="fa fa-check"></i><b>5.1.3</b> How can we identify the subjects with missing data?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>5.2</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="5.3" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>5.3</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="5.4" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>5.4</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="5.5" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#single-imputation"><i class="fa fa-check"></i><b>5.5</b> Single Imputation</a></li>
<li class="chapter" data-level="5.6" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#multiple-imputation"><i class="fa fa-check"></i><b>5.6</b> Multiple Imputation</a></li>
<li class="chapter" data-level="5.7" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#building-a-complete-case-analysis"><i class="fa fa-check"></i><b>5.7</b> Building a Complete Case Analysis</a></li>
<li class="chapter" data-level="5.8" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#single-imputation-with-the-mean-or-mode"><i class="fa fa-check"></i><b>5.8</b> Single Imputation with the Mean or Mode</a></li>
<li class="chapter" data-level="5.9" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#doing-single-imputation-with-simputation"><i class="fa fa-check"></i><b>5.9</b> Doing Single Imputation with <code>simputation</code></a><ul>
<li class="chapter" data-level="5.9.1" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#mirroring-our-prior-approach-imputing-meansmediansmodes"><i class="fa fa-check"></i><b>5.9.1</b> Mirroring Our Prior Approach (imputing means/medians/modes)</a></li>
<li class="chapter" data-level="5.9.2" data-path="missing-data-mechanisms-and-single-imputation.html"><a href="missing-data-mechanisms-and-single-imputation.html#using-a-model-to-impute-sbp.before-and-diabetes"><i class="fa fa-check"></i><b>5.9.2</b> Using a model to impute <code>sbp.before</code> and <code>diabetes</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html"><i class="fa fa-check"></i><b>6</b> A Study of Prostate Cancer</a><ul>
<li class="chapter" data-level="6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#data-load-and-background"><i class="fa fa-check"></i><b>6.1</b> Data Load and Background</a></li>
<li class="chapter" data-level="6.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#code-book"><i class="fa fa-check"></i><b>6.2</b> Code Book</a></li>
<li class="chapter" data-level="6.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#additions-for-later-use"><i class="fa fa-check"></i><b>6.3</b> Additions for Later Use</a></li>
<li class="chapter" data-level="6.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#fitting-and-evaluating-a-two-predictor-model"><i class="fa fa-check"></i><b>6.4</b> Fitting and Evaluating a Two-Predictor Model</a><ul>
<li class="chapter" data-level="6.4.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#using-tidy"><i class="fa fa-check"></i><b>6.4.1</b> Using <code>tidy</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#interpretation"><i class="fa fa-check"></i><b>6.4.2</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#exploring-model-c5_prost_a"><i class="fa fa-check"></i><b>6.5</b> Exploring Model <code>c5_prost_A</code></a><ul>
<li class="chapter" data-level="6.5.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#summary-for-model-c5_prost_a"><i class="fa fa-check"></i><b>6.5.1</b> <code>summary</code> for Model <code>c5_prost_A</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#adjusted-r2"><i class="fa fa-check"></i><b>6.5.2</b> Adjusted R<sup>2</sup></a></li>
<li class="chapter" data-level="6.5.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#coefficient-confidence-intervals"><i class="fa fa-check"></i><b>6.5.3</b> Coefficient Confidence Intervals</a></li>
<li class="chapter" data-level="6.5.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#anova-for-model-c5_prost_a"><i class="fa fa-check"></i><b>6.5.4</b> ANOVA for Model <code>c5_prost_A</code></a></li>
<li class="chapter" data-level="6.5.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residuals-fitted-values-and-standard-errors-with-augment"><i class="fa fa-check"></i><b>6.5.5</b> Residuals, Fitted Values and Standard Errors with <code>augment</code></a></li>
<li class="chapter" data-level="6.5.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#making-predictions-with-c5_prost_a"><i class="fa fa-check"></i><b>6.5.6</b> Making Predictions with <code>c5_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#plotting-model-c5_prost_a"><i class="fa fa-check"></i><b>6.6</b> Plotting Model <code>c5_prost_A</code></a><ul>
<li class="chapter" data-level="6.6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residual-plots-of-c5_prost_a"><i class="fa fa-check"></i><b>6.6.1</b> Residual Plots of <code>c5_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validation-of-model-c5_prost_a"><i class="fa fa-check"></i><b>6.7</b> Cross-Validation of Model <code>c5_prost_A</code></a><ul>
<li class="chapter" data-level="6.7.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validated-summaries-of-prediction-quality"><i class="fa fa-check"></i><b>6.7.1</b> Cross-Validated Summaries of Prediction Quality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html"><i class="fa fa-check"></i><b>7</b> Stepwise Variable Selection</a><ul>
<li class="chapter" data-level="7.1" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#strategy-for-model-selection"><i class="fa fa-check"></i><b>7.1</b> Strategy for Model Selection</a><ul>
<li class="chapter" data-level="7.1.1" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#how-do-we-choose-potential-subsets-of-predictors"><i class="fa fa-check"></i><b>7.1.1</b> How Do We Choose Potential Subsets of Predictors?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#a-kitchen-sink-model-model-c5_prost_ks"><i class="fa fa-check"></i><b>7.2</b> A “Kitchen Sink” Model (Model <code>c5_prost_ks</code>)</a></li>
<li class="chapter" data-level="7.3" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#sequential-variable-selection-stepwise-approaches"><i class="fa fa-check"></i><b>7.3</b> Sequential Variable Selection: Stepwise Approaches</a><ul>
<li class="chapter" data-level="7.3.1" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#the-big-problems-with-stepwise-regression"><i class="fa fa-check"></i><b>7.3.1</b> The Big Problems with Stepwise Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#forward-selection-with-the-step-function"><i class="fa fa-check"></i><b>7.4</b> Forward Selection with the <code>step</code> function</a></li>
<li class="chapter" data-level="7.5" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#backward-elimination-using-the-step-function"><i class="fa fa-check"></i><b>7.5</b> Backward Elimination using the <code>step</code> function</a></li>
<li class="chapter" data-level="7.6" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#allen-cady-modified-backward-elimination"><i class="fa fa-check"></i><b>7.6</b> Allen-Cady Modified Backward Elimination</a><ul>
<li class="chapter" data-level="7.6.1" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#demonstration-of-the-allen-cady-approach"><i class="fa fa-check"></i><b>7.6.1</b> Demonstration of the Allen-Cady approach</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#summarizing-the-results"><i class="fa fa-check"></i><b>7.7</b> Summarizing the Results</a><ul>
<li class="chapter" data-level="7.7.1" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#in-sample-testing-and-summaries"><i class="fa fa-check"></i><b>7.7.1</b> In-Sample Testing and Summaries</a></li>
<li class="chapter" data-level="7.7.2" data-path="stepwise-variable-selection.html"><a href="stepwise-variable-selection.html#validating-the-results-of-the-various-models"><i class="fa fa-check"></i><b>7.7.2</b> Validating the Results of the Various Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><i class="fa fa-check"></i><b>8</b> “Best Subsets” Variable Selection in our Prostate Cancer Study</a><ul>
<li class="chapter" data-level="8.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#four-key-summaries-well-use-to-evaluate-potential-models"><i class="fa fa-check"></i><b>8.1</b> Four Key Summaries We’ll Use to Evaluate Potential Models</a></li>
<li class="chapter" data-level="8.2" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#using-regsubsets-in-the-leaps-package"><i class="fa fa-check"></i><b>8.2</b> Using <code>regsubsets</code> in the <code>leaps</code> package</a><ul>
<li class="chapter" data-level="8.2.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#identifying-the-models-with-which-and-outmat"><i class="fa fa-check"></i><b>8.2.1</b> Identifying the models with <code>which</code> and <code>outmat</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#calculating-bias-corrected-aic"><i class="fa fa-check"></i><b>8.3</b> Calculating bias-corrected AIC</a><ul>
<li class="chapter" data-level="8.3.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#calculation-of-aic.c-in-our-setting"><i class="fa fa-check"></i><b>8.3.1</b> Calculation of aic.c in our setting</a></li>
<li class="chapter" data-level="8.3.2" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#the-uncorrected-aic-provides-no-more-useful-information-here"><i class="fa fa-check"></i><b>8.3.2</b> The Uncorrected AIC provides no more useful information here</a></li>
<li class="chapter" data-level="8.3.3" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#building-a-tibble-containing-the-necessary-information"><i class="fa fa-check"></i><b>8.3.3</b> Building a Tibble containing the necessary information</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#plotting-the-best-subsets-results-using-ggplot2"><i class="fa fa-check"></i><b>8.4</b> Plotting the Best Subsets Results using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="8.4.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#the-adjusted-r2-plot"><i class="fa fa-check"></i><b>8.4.1</b> The Adjusted R<sup>2</sup> Plot</a></li>
<li class="chapter" data-level="8.4.2" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#mallows-c_p"><i class="fa fa-check"></i><b>8.4.2</b> Mallows’ <span class="math inline">\(C_p\)</span></a></li>
<li class="chapter" data-level="8.4.3" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#the-c_p-plot"><i class="fa fa-check"></i><b>8.4.3</b> The <span class="math inline">\(C_p\)</span> Plot</a></li>
<li class="chapter" data-level="8.4.4" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#all-subsets-regression-and-information-criteria"><i class="fa fa-check"></i><b>8.4.4</b> “All Subsets” Regression and Information Criteria</a></li>
<li class="chapter" data-level="8.4.5" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#the-bias-corrected-aic-plot"><i class="fa fa-check"></i><b>8.4.5</b> The bias-corrected AIC plot</a></li>
<li class="chapter" data-level="8.4.6" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#the-bic-plot"><i class="fa fa-check"></i><b>8.4.6</b> The BIC plot</a></li>
<li class="chapter" data-level="8.4.7" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#all-four-plots-in-one-figure-via-ggplot2"><i class="fa fa-check"></i><b>8.4.7</b> All Four Plots in One Figure (via ggplot2)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#table-of-key-results"><i class="fa fa-check"></i><b>8.5</b> Table of Key Results</a></li>
<li class="chapter" data-level="8.6" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#models-worth-considering"><i class="fa fa-check"></i><b>8.6</b> Models Worth Considering?</a></li>
<li class="chapter" data-level="8.7" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#compare-these-candidate-models-in-sample"><i class="fa fa-check"></i><b>8.7</b> Compare these candidate models in-sample?</a><ul>
<li class="chapter" data-level="8.7.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#using-anova-to-compare-nested-models"><i class="fa fa-check"></i><b>8.7.1</b> Using <code>anova</code> to compare nested models</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#aic-and-bic-comparisons-within-the-training-sample"><i class="fa fa-check"></i><b>8.8</b> AIC and BIC comparisons, within the training sample</a></li>
<li class="chapter" data-level="8.9" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#cross-validation-of-candidate-models-out-of-sample"><i class="fa fa-check"></i><b>8.9</b> Cross-Validation of Candidate Models out of Sample</a><ul>
<li class="chapter" data-level="8.9.1" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#fold-cross-validation-of-model-m04"><i class="fa fa-check"></i><b>8.9.1</b> 20-fold Cross-Validation of model <code>m04</code></a></li>
<li class="chapter" data-level="8.9.2" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#fold-cross-validation-of-model-m07"><i class="fa fa-check"></i><b>8.9.2</b> 20-fold Cross-Validation of model <code>m07</code></a></li>
<li class="chapter" data-level="8.9.3" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#fold-cross-validation-of-model-m08"><i class="fa fa-check"></i><b>8.9.3</b> 20-fold Cross-Validation of model <code>m08</code></a></li>
<li class="chapter" data-level="8.9.4" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#comparing-the-results-of-the-cross-validations"><i class="fa fa-check"></i><b>8.9.4</b> Comparing the Results of the Cross-Validations</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="best-subsets-variable-selection-in-our-prostate-cancer-study.html"><a href="best-subsets-variable-selection-in-our-prostate-cancer-study.html#what-about-interaction-terms"><i class="fa fa-check"></i><b>8.10</b> What about Interaction Terms?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html"><i class="fa fa-check"></i><b>9</b> Adding Non-linear Terms to a Linear Regression Model</a><ul>
<li class="chapter" data-level="9.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-pollution-data"><i class="fa fa-check"></i><b>9.1</b> The <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-straight-line-model-to-predict-y-from-x2"><i class="fa fa-check"></i><b>9.2</b> Fitting a straight line model to predict <code>y</code> from <code>x2</code></a></li>
<li class="chapter" data-level="9.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#quadratic-polynomial-model-to-predict-y-using-x2"><i class="fa fa-check"></i><b>9.3</b> Quadratic polynomial model to predict <code>y</code> using <code>x2</code></a><ul>
<li class="chapter" data-level="9.3.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-raw-quadratic-model"><i class="fa fa-check"></i><b>9.3.1</b> The raw quadratic model</a></li>
<li class="chapter" data-level="9.3.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#raw-quadratic-fit-after-centering-x2"><i class="fa fa-check"></i><b>9.3.2</b> Raw quadratic fit after centering <code>x2</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>9.4</b> Orthogonal Polynomials</a></li>
<li class="chapter" data-level="9.5" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fit-a-cubic-polynomial-to-predict-y-from-x3"><i class="fa fa-check"></i><b>9.5</b> Fit a cubic polynomial to predict <code>y</code> from <code>x3</code></a></li>
<li class="chapter" data-level="9.6" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-restricted-cubic-spline-in-a-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Fitting a restricted cubic spline in a linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-degrees-of-freedom"><i class="fa fa-check"></i><b>9.7</b> “Spending” Degrees of Freedom</a><ul>
<li class="chapter" data-level="9.7.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#overfitting-and-limits-on-the-of-predictors"><i class="fa fa-check"></i><b>9.7.1</b> Overfitting and Limits on the # of Predictors</a></li>
<li class="chapter" data-level="9.7.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-importance-of-collinearity"><i class="fa fa-check"></i><b>9.7.2</b> The Importance of Collinearity</a></li>
<li class="chapter" data-level="9.7.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-an-explanatory-model"><i class="fa fa-check"></i><b>9.7.3</b> Collinearity in an Explanatory Model</a></li>
<li class="chapter" data-level="9.7.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-a-prediction-model"><i class="fa fa-check"></i><b>9.7.4</b> Collinearity in a Prediction Model</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-df-on-non-linearity-the-spearman-rho2-plot"><i class="fa fa-check"></i><b>9.8</b> Spending DF on Non-Linearity: The Spearman <span class="math inline">\(\rho^2\)</span> Plot</a><ul>
<li class="chapter" data-level="9.8.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-big-model-to-the-pollution-data"><i class="fa fa-check"></i><b>9.8.1</b> Fitting a Big Model to the <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.8.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#limitations-of-lm-for-fitting-complex-linear-regression-models"><i class="fa fa-check"></i><b>9.8.2</b> Limitations of <code>lm</code> for fitting complex linear regression models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html"><i class="fa fa-check"></i><b>10</b> Using <code>ols</code> from the <code>rms</code> package to fit linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#fitting-a-model-with-ols"><i class="fa fa-check"></i><b>10.1</b> Fitting a model with <code>ols</code></a><ul>
<li class="chapter" data-level="10.1.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-model-likelihood-ratio-test"><i class="fa fa-check"></i><b>10.1.1</b> The Model Likelihood Ratio Test</a></li>
<li class="chapter" data-level="10.1.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-g-statistic"><i class="fa fa-check"></i><b>10.1.2</b> The g statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#anova-for-an-ols-model"><i class="fa fa-check"></i><b>10.2</b> ANOVA for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.3" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#effect-estimates"><i class="fa fa-check"></i><b>10.3</b> Effect Estimates</a><ul>
<li class="chapter" data-level="10.3.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#simultaneous-confidence-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Simultaneous Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-predict-function-for-an-ols-model"><i class="fa fa-check"></i><b>10.4</b> The <code>Predict</code> function for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.5" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#checking-influence-via-dfbeta"><i class="fa fa-check"></i><b>10.5</b> Checking Influence via <code>dfbeta</code></a><ul>
<li class="chapter" data-level="10.5.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-dfbetas"><i class="fa fa-check"></i><b>10.5.1</b> Using the <code>residuals</code> command for <code>dfbetas</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-other-summaries"><i class="fa fa-check"></i><b>10.5.2</b> Using the <code>residuals</code> command for other summaries</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#model-validation-and-correcting-for-optimism"><i class="fa fa-check"></i><b>10.6</b> Model Validation and Correcting for Optimism</a></li>
<li class="chapter" data-level="10.7" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#building-a-nomogram-for-our-model"><i class="fa fa-check"></i><b>10.7</b> Building a Nomogram for Our Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html"><i class="fa fa-check"></i><b>11</b> Other Variable Selection Strategies</a><ul>
<li class="chapter" data-level="11.1" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#why-not-use-stepwise-procedures"><i class="fa fa-check"></i><b>11.1</b> Why not use stepwise procedures?</a></li>
<li class="chapter" data-level="11.2" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#ridge-regression"><i class="fa fa-check"></i><b>11.2</b> Ridge Regression</a><ul>
<li class="chapter" data-level="11.2.1" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#assessing-a-ridge-regression-approach"><i class="fa fa-check"></i><b>11.2.1</b> Assessing a Ridge Regression Approach</a></li>
<li class="chapter" data-level="11.2.2" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#the-lm.ridge-plot---where-do-coefficients-stabilize"><i class="fa fa-check"></i><b>11.2.2</b> The <code>lm.ridge</code> plot - where do coefficients stabilize?</a></li>
<li class="chapter" data-level="11.2.3" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#ridge-regression-the-bottom-line"><i class="fa fa-check"></i><b>11.2.3</b> Ridge Regression: The Bottom Line</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#the-lasso"><i class="fa fa-check"></i><b>11.3</b> The Lasso</a><ul>
<li class="chapter" data-level="11.3.1" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#consequences-of-the-lasso-approach"><i class="fa fa-check"></i><b>11.3.1</b> Consequences of the Lasso Approach</a></li>
<li class="chapter" data-level="11.3.2" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#how-the-lasso-works"><i class="fa fa-check"></i><b>11.3.2</b> How The Lasso Works</a></li>
<li class="chapter" data-level="11.3.3" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#cross-validation-with-the-lasso"><i class="fa fa-check"></i><b>11.3.3</b> Cross-Validation with the Lasso</a></li>
<li class="chapter" data-level="11.3.4" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#what-value-of-the-key-fraction-minimizes-cross-validated-mse"><i class="fa fa-check"></i><b>11.3.4</b> What value of the key fraction minimizes cross-validated MSE?</a></li>
<li class="chapter" data-level="11.3.5" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#coefficients-for-the-model-identified-by-the-cross-validation"><i class="fa fa-check"></i><b>11.3.5</b> Coefficients for the Model Identified by the Cross-Validation</a></li>
<li class="chapter" data-level="11.3.6" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#obtaining-fitted-values-from-lasso"><i class="fa fa-check"></i><b>11.3.6</b> Obtaining Fitted Values from Lasso</a></li>
<li class="chapter" data-level="11.3.7" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#complete-set-of-fitted-values-from-the-lasso"><i class="fa fa-check"></i><b>11.3.7</b> Complete Set of Fitted Values from the Lasso</a></li>
<li class="chapter" data-level="11.3.8" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#when-is-the-lasso-most-useful"><i class="fa fa-check"></i><b>11.3.8</b> When is the Lasso Most Useful?</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="other-variable-selection-strategies.html"><a href="other-variable-selection-strategies.html#applying-the-lasso-to-the-pollution-data"><i class="fa fa-check"></i><b>11.4</b> Applying the Lasso to the <code>pollution</code> data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression: The Foundations</a><ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#a-first-attempt-a-linear-probability-model"><i class="fa fa-check"></i><b>12.1</b> A First Attempt: A Linear Probability Model</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#logistic-regression"><i class="fa fa-check"></i><b>12.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>12.3</b> The Logistic Regression Model</a></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-link-function"><i class="fa fa-check"></i><b>12.4</b> The Link Function</a></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logit-or-log-odds"><i class="fa fa-check"></i><b>12.5</b> The logit or log odds</a></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#interpreting-the-coefficients-of-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.6</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-has-non-constant-variance"><i class="fa fa-check"></i><b>12.7</b> The Logistic Regression has non-constant variance</a></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#fitting-a-logistic-regression-model-to-our-simulated-data"><i class="fa fa-check"></i><b>12.8</b> Fitting a Logistic Regression Model to our Simulated Data</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#plotting-the-logistic-regression-model"><i class="fa fa-check"></i><b>12.9</b> Plotting the Logistic Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html"><i class="fa fa-check"></i><b>13</b> Logistic Regression and the <code>resect</code> data</a><ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-resect-data"><i class="fa fa-check"></i><b>13.1</b> The <code>resect</code> data</a></li>
<li class="chapter" data-level="13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#running-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>13.2</b> Running A Simple Logistic Regression Model</a><ul>
<li class="chapter" data-level="13.2.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-can-be-harder-than-linear-regression"><i class="fa fa-check"></i><b>13.2.1</b> Logistic Regression Can Be Harder than Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-glm"><i class="fa fa-check"></i><b>13.3</b> Logistic Regression using <code>glm</code></a><ul>
<li class="chapter" data-level="13.3.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-coefficients-of-a-logistic-regression-model-1"><i class="fa fa-check"></i><b>13.3.1</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="13.3.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-predict-to-describe-the-models-fits"><i class="fa fa-check"></i><b>13.3.2</b> Using <code>predict</code> to describe the model’s fits</a></li>
<li class="chapter" data-level="13.3.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#odds-ratio-interpretation-of-coefficients"><i class="fa fa-check"></i><b>13.3.3</b> Odds Ratio interpretation of Coefficients</a></li>
<li class="chapter" data-level="13.3.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-rest-of-the-model-output-from-glm"><i class="fa fa-check"></i><b>13.3.4</b> Interpreting the rest of the model output from <code>glm</code></a></li>
<li class="chapter" data-level="13.3.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-and-comparing-our-model-to-the-null-model"><i class="fa fa-check"></i><b>13.3.5</b> Deviance and Comparing Our Model to the Null Model</a></li>
<li class="chapter" data-level="13.3.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-glance-with-a-logistic-regression-model"><i class="fa fa-check"></i><b>13.3.6</b> Using <code>glance</code> with a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>13.4</b> Interpreting the Model Summary</a><ul>
<li class="chapter" data-level="13.4.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#wald-z-tests-for-coefficients-in-a-logistic-regression"><i class="fa fa-check"></i><b>13.4.1</b> Wald Z tests for Coefficients in a Logistic Regression</a></li>
<li class="chapter" data-level="13.4.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>13.4.2</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="13.4.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-residuals"><i class="fa fa-check"></i><b>13.4.3</b> Deviance Residuals</a></li>
<li class="chapter" data-level="13.4.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#dispersion-parameter"><i class="fa fa-check"></i><b>13.4.4</b> Dispersion Parameter</a></li>
<li class="chapter" data-level="13.4.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fisher-scoring-iterations"><i class="fa fa-check"></i><b>13.4.5</b> Fisher Scoring iterations</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>13.5</b> Plotting a Simple Logistic Regression Model</a><ul>
<li class="chapter" data-level="13.5.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities"><i class="fa fa-check"></i><b>13.5.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="13.5.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-logistic-regression-models-fitted-values"><i class="fa fa-check"></i><b>13.5.2</b> Plotting a Logistic Regression Model’s Fitted Values</a></li>
<li class="chapter" data-level="13.5.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-model-using-binomial_smooth"><i class="fa fa-check"></i><b>13.5.3</b> Plotting a Simple Logistic Model using <code>binomial_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#how-well-does-model-a-classify-subjects"><i class="fa fa-check"></i><b>13.6</b> How well does Model A classify subjects?</a></li>
<li class="chapter" data-level="13.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#receiver-operating-characteristic-curve-analysis"><i class="fa fa-check"></i><b>13.7</b> Receiver Operating Characteristic Curve Analysis</a><ul>
<li class="chapter" data-level="13.7.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-area-under-the-roc-curve"><i class="fa fa-check"></i><b>13.7.1</b> Interpreting the Area under the ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-plot-for-res_moda"><i class="fa fa-check"></i><b>13.8</b> The ROC Plot for <code>res_modA</code></a><ul>
<li class="chapter" data-level="13.8.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#another-way-to-plot-the-roc-curve"><i class="fa fa-check"></i><b>13.8.1</b> Another way to plot the ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-residual-plots-from-model-a"><i class="fa fa-check"></i><b>13.9</b> Assessing Residual Plots from Model A</a></li>
<li class="chapter" data-level="13.10" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-b-a-kitchen-sink-logistic-regression-model"><i class="fa fa-check"></i><b>13.10</b> Model B: A “Kitchen Sink” Logistic Regression Model</a><ul>
<li class="chapter" data-level="13.10.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#comparing-model-a-to-model-b"><i class="fa fa-check"></i><b>13.10.1</b> Comparing Model A to Model B</a></li>
<li class="chapter" data-level="13.10.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-model-b"><i class="fa fa-check"></i><b>13.10.2</b> Interpreting Model B</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b"><i class="fa fa-check"></i><b>13.11</b> Plotting Model B</a><ul>
<li class="chapter" data-level="13.11.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities-1"><i class="fa fa-check"></i><b>13.11.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="13.11.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b-fits-by-observed-mortality"><i class="fa fa-check"></i><b>13.11.2</b> Plotting Model B Fits by Observed Mortality</a></li>
<li class="chapter" data-level="13.11.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-curve-for-model-b"><i class="fa fa-check"></i><b>13.11.3</b> The ROC curve for Model B</a></li>
<li class="chapter" data-level="13.11.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#residuals-leverage-and-influence"><i class="fa fa-check"></i><b>13.11.4</b> Residuals, Leverage and Influence</a></li>
</ul></li>
<li class="chapter" data-level="13.12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-lrm"><i class="fa fa-check"></i><b>13.12</b> Logistic Regression using <code>lrm</code></a><ul>
<li class="chapter" data-level="13.12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-nagelkerke-r2"><i class="fa fa-check"></i><b>13.12.1</b> Interpreting Nagelkerke R<sup>2</sup></a></li>
<li class="chapter" data-level="13.12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-c-statistic-and-plotting-the-roc-curve"><i class="fa fa-check"></i><b>13.12.2</b> Interpreting the C statistic and Plotting the ROC Curve</a></li>
<li class="chapter" data-level="13.12.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-c-statistic-and-somers-d"><i class="fa fa-check"></i><b>13.12.3</b> The C statistic and Somers’ D</a></li>
<li class="chapter" data-level="13.12.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validating-the-logistic-regression-model-summary-statistics"><i class="fa fa-check"></i><b>13.12.4</b> Validating the Logistic Regression Model Summary Statistics</a></li>
<li class="chapter" data-level="13.12.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-summary-of-the-lrm-approach"><i class="fa fa-check"></i><b>13.12.5</b> Plotting the Summary of the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="13.12.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-c"><i class="fa fa-check"></i><b>13.12.6</b> Plot In-Sample Predictions for Model C</a></li>
<li class="chapter" data-level="13.12.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-from-the-lrm-approach"><i class="fa fa-check"></i><b>13.12.7</b> ANOVA from the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="13.12.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#are-any-points-particularly-influential"><i class="fa fa-check"></i><b>13.12.8</b> Are any points particularly influential?</a></li>
<li class="chapter" data-level="13.12.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-nomogram-for-model-c"><i class="fa fa-check"></i><b>13.12.9</b> A Nomogram for Model C</a></li>
</ul></li>
<li class="chapter" data-level="13.13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-d-an-augmented-kitchen-sink-model"><i class="fa fa-check"></i><b>13.13</b> Model D: An Augmented Kitchen Sink Model</a><ul>
<li class="chapter" data-level="13.13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#spearman-rho2-plot"><i class="fa fa-check"></i><b>13.13.1</b> Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="13.13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-d-using-lrm"><i class="fa fa-check"></i><b>13.13.2</b> Fitting Model D using <code>lrm</code></a></li>
<li class="chapter" data-level="13.13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-model-d-using-lrms-tools"><i class="fa fa-check"></i><b>13.13.3</b> Assessing Model D using <code>lrm</code>’s tools</a></li>
<li class="chapter" data-level="13.13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-and-wald-tests-for-model-d"><i class="fa fa-check"></i><b>13.13.4</b> ANOVA and Wald Tests for Model D</a></li>
<li class="chapter" data-level="13.13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-in-model-d"><i class="fa fa-check"></i><b>13.13.5</b> Effect Sizes in Model D</a></li>
<li class="chapter" data-level="13.13.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-d"><i class="fa fa-check"></i><b>13.13.6</b> Plot In-Sample Predictions for Model D</a></li>
<li class="chapter" data-level="13.13.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-roc-curve-for-model-d"><i class="fa fa-check"></i><b>13.13.7</b> Plotting the ROC curve for Model D</a></li>
<li class="chapter" data-level="13.13.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-d-summaries"><i class="fa fa-check"></i><b>13.13.8</b> Validation of Model D summaries</a></li>
</ul></li>
<li class="chapter" data-level="13.14" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-e-fitting-a-reduced-model-in-light-of-model-d"><i class="fa fa-check"></i><b>13.14</b> Model E: Fitting a Reduced Model in light of Model D</a><ul>
<li class="chapter" data-level="13.14.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-plot-comparing-the-two-intubation-groups"><i class="fa fa-check"></i><b>13.14.1</b> A Plot comparing the two intubation groups</a></li>
<li class="chapter" data-level="13.14.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#nomogram-for-model-e"><i class="fa fa-check"></i><b>13.14.2</b> Nomogram for Model E</a></li>
<li class="chapter" data-level="13.14.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-from-model-e"><i class="fa fa-check"></i><b>13.14.3</b> Effect Sizes from Model E</a></li>
<li class="chapter" data-level="13.14.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-e"><i class="fa fa-check"></i><b>13.14.4</b> Plot In-Sample Predictions for Model E</a></li>
<li class="chapter" data-level="13.14.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-for-model-e"><i class="fa fa-check"></i><b>13.14.5</b> ANOVA for Model E</a></li>
<li class="chapter" data-level="13.14.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-e"><i class="fa fa-check"></i><b>13.14.6</b> Validation of Model E</a></li>
<li class="chapter" data-level="13.14.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#do-any-points-seem-particularly-influential"><i class="fa fa-check"></i><b>13.14.7</b> Do any points seem particularly influential?</a></li>
<li class="chapter" data-level="13.14.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-e-using-glm-to-get-plots-about-influence"><i class="fa fa-check"></i><b>13.14.8</b> Fitting Model E using <code>glm</code> to get plots about influence</a></li>
</ul></li>
<li class="chapter" data-level="13.15" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#concordance-comparing-model-c-d-and-es-predictions"><i class="fa fa-check"></i><b>13.15</b> Concordance: Comparing Model C, D and E’s predictions</a></li>
<li class="chapter" data-level="13.16" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#conclusions"><i class="fa fa-check"></i><b>13.16</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html"><i class="fa fa-check"></i><b>14</b> Logistic Regression and the <code>smartcle1</code> data</a><ul>
<li class="chapter" data-level="14.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#the-smartcle1-data"><i class="fa fa-check"></i><b>14.1</b> The <code>smartcle1</code> data</a></li>
<li class="chapter" data-level="14.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#thinking-about-non-linear-terms"><i class="fa fa-check"></i><b>14.2</b> Thinking About Non-Linear Terms</a></li>
<li class="chapter" data-level="14.3" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#a-first-model-for-exerany-complete-case-analysis"><i class="fa fa-check"></i><b>14.3</b> A First Model for <code>exerany</code> (Complete Case Analysis)</a></li>
<li class="chapter" data-level="14.4" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#building-a-larger-model-spearman-rho2-plot"><i class="fa fa-check"></i><b>14.4</b> Building a Larger Model: Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="14.5" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#a-second-model-for-exerany-complete-cases"><i class="fa fa-check"></i><b>14.5</b> A Second Model for <code>exerany</code> (Complete Cases)</a></li>
<li class="chapter" data-level="14.6" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#dealing-with-missing-data-via-simple-imputation"><i class="fa fa-check"></i><b>14.6</b> Dealing with Missing Data via Simple Imputation</a><ul>
<li class="chapter" data-level="14.6.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#omit-cases-where-the-outcome-is-missing"><i class="fa fa-check"></i><b>14.6.1</b> Omit cases where the outcome is missing</a></li>
<li class="chapter" data-level="14.6.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#plot-the-remaining-missingness"><i class="fa fa-check"></i><b>14.6.2</b> Plot the remaining missingness</a></li>
<li class="chapter" data-level="14.6.3" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#use-simple-imputation-build-a-new-data-set"><i class="fa fa-check"></i><b>14.6.3</b> Use simple imputation, build a new data set</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#refitting-model-1-with-simply-imputed-data"><i class="fa fa-check"></i><b>14.7</b> Refitting Model 1 with simply imputed data</a><ul>
<li class="chapter" data-level="14.7.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#validating-summary-statistics"><i class="fa fa-check"></i><b>14.7.1</b> Validating Summary Statistics</a></li>
<li class="chapter" data-level="14.7.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#anova-for-the-model"><i class="fa fa-check"></i><b>14.7.2</b> ANOVA for the model</a></li>
<li class="chapter" data-level="14.7.3" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#summarizing-effect-size"><i class="fa fa-check"></i><b>14.7.3</b> Summarizing Effect Size</a></li>
<li class="chapter" data-level="14.7.4" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#plotting-the-model-with-ggplot-and-predict"><i class="fa fa-check"></i><b>14.7.4</b> Plotting the Model with <code>ggplot</code> and <code>Predict</code></a></li>
<li class="chapter" data-level="14.7.5" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#plotting-the-model-with-a-nomogram"><i class="fa fa-check"></i><b>14.7.5</b> Plotting the model with a nomogram</a></li>
<li class="chapter" data-level="14.7.6" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#checking-the-goodness-of-fit-of-our-model"><i class="fa fa-check"></i><b>14.7.6</b> Checking the Goodness of Fit of our model</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#refitting-model-2-with-simply-imputed-data"><i class="fa fa-check"></i><b>14.8</b> Refitting Model 2 with simply imputed data</a><ul>
<li class="chapter" data-level="14.8.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#validating-summary-statistics-1"><i class="fa fa-check"></i><b>14.8.1</b> Validating Summary Statistics</a></li>
<li class="chapter" data-level="14.8.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#anova-for-the-model-1"><i class="fa fa-check"></i><b>14.8.2</b> ANOVA for the model</a></li>
<li class="chapter" data-level="14.8.3" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#summarizing-effect-size-1"><i class="fa fa-check"></i><b>14.8.3</b> Summarizing Effect Size</a></li>
<li class="chapter" data-level="14.8.4" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#plotting-the-model-with-ggplot-and-predict-1"><i class="fa fa-check"></i><b>14.8.4</b> Plotting the Model with <code>ggplot</code> and <code>Predict</code></a></li>
<li class="chapter" data-level="14.8.5" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#plotting-the-model-with-a-nomogram-1"><i class="fa fa-check"></i><b>14.8.5</b> Plotting the model with a nomogram</a></li>
<li class="chapter" data-level="14.8.6" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#checking-the-goodness-of-fit-of-our-model-1"><i class="fa fa-check"></i><b>14.8.6</b> Checking the Goodness of Fit of our model</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#comparing-model-2-to-model-1-after-simple-imputation"><i class="fa fa-check"></i><b>14.9</b> Comparing Model 2 to Model 1 after simple imputation</a><ul>
<li class="chapter" data-level="14.9.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#comparison-by-analysis-of-deviance"><i class="fa fa-check"></i><b>14.9.1</b> Comparison by Analysis of Deviance</a></li>
<li class="chapter" data-level="14.9.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#comparing-aic-and-bic"><i class="fa fa-check"></i><b>14.9.2</b> Comparing AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#dealing-with-missing-data-via-multiple-imputation"><i class="fa fa-check"></i><b>14.10</b> Dealing with Missing Data via Multiple Imputation</a><ul>
<li class="chapter" data-level="14.10.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#using-aregimpute-to-fit-a-multiple-imputation-model"><i class="fa fa-check"></i><b>14.10.1</b> Using <code>aregImpute</code> to fit a multiple imputation model</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#combining-the-imputation-and-outcome-models"><i class="fa fa-check"></i><b>14.11</b> Combining the Imputation and Outcome Models</a><ul>
<li class="chapter" data-level="14.11.1" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#model-1-with-multiple-imputation"><i class="fa fa-check"></i><b>14.11.1</b> Model 1 with Multiple Imputation</a></li>
<li class="chapter" data-level="14.11.2" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#model-2-with-multiple-imputation"><i class="fa fa-check"></i><b>14.11.2</b> Model 2 with Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="logistic-regression-and-the-smartcle1-data.html"><a href="logistic-regression-and-the-smartcle1-data.html#models-with-and-without-imputation"><i class="fa fa-check"></i><b>14.12</b> Models with and without Imputation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html"><i class="fa fa-check"></i><b>15</b> Linear Regression and the <code>smartcle1</code> data</a><ul>
<li class="chapter" data-level="15.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#the-smartcle1-data-1"><i class="fa fa-check"></i><b>15.1</b> The <code>smartcle1</code> data</a></li>
<li class="chapter" data-level="15.2" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#thinking-about-non-linear-terms-1"><i class="fa fa-check"></i><b>15.2</b> Thinking About Non-Linear Terms</a></li>
<li class="chapter" data-level="15.3" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#a-first-model-for-sleephrs-complete-case-analysis"><i class="fa fa-check"></i><b>15.3</b> A First Model for <code>sleephrs</code> (Complete Case Analysis)</a></li>
<li class="chapter" data-level="15.4" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#building-a-larger-model-spearman-rho2-plot-1"><i class="fa fa-check"></i><b>15.4</b> Building a Larger Model: Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="15.5" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#a-second-model-for-sleephrs-complete-cases"><i class="fa fa-check"></i><b>15.5</b> A Second Model for <code>sleephrs</code> (Complete Cases)</a></li>
<li class="chapter" data-level="15.6" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#dealing-with-missing-data-via-simple-imputation-1"><i class="fa fa-check"></i><b>15.6</b> Dealing with Missing Data via Simple Imputation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#omit-cases-where-the-outcome-is-missing-1"><i class="fa fa-check"></i><b>15.6.1</b> Omit cases where the outcome is missing</a></li>
<li class="chapter" data-level="15.6.2" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#plot-the-remaining-missingness-1"><i class="fa fa-check"></i><b>15.6.2</b> Plot the remaining missingness</a></li>
<li class="chapter" data-level="15.6.3" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#use-simple-imputation-build-a-new-data-set-1"><i class="fa fa-check"></i><b>15.6.3</b> Use simple imputation, build a new data set</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#refitting-model-a-with-simply-imputed-data"><i class="fa fa-check"></i><b>15.7</b> Refitting Model A with simply imputed data</a><ul>
<li class="chapter" data-level="15.7.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#validating-summary-statistics-2"><i class="fa fa-check"></i><b>15.7.1</b> Validating Summary Statistics</a></li>
<li class="chapter" data-level="15.7.2" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#anova-for-the-model-2"><i class="fa fa-check"></i><b>15.7.2</b> ANOVA for the model</a></li>
<li class="chapter" data-level="15.7.3" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#summarizing-effect-size-2"><i class="fa fa-check"></i><b>15.7.3</b> Summarizing Effect Size</a></li>
<li class="chapter" data-level="15.7.4" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#plotting-the-model-with-ggplot-and-predict-2"><i class="fa fa-check"></i><b>15.7.4</b> Plotting the Model with <code>ggplot</code> and <code>Predict</code></a></li>
<li class="chapter" data-level="15.7.5" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#plotting-the-model-with-a-nomogram-2"><i class="fa fa-check"></i><b>15.7.5</b> Plotting the model with a nomogram</a></li>
<li class="chapter" data-level="15.7.6" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#residual-plots-for-mod.a2"><i class="fa fa-check"></i><b>15.7.6</b> Residual Plots for mod.A2</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#refitting-model-b-with-simply-imputed-data"><i class="fa fa-check"></i><b>15.8</b> Refitting Model B with simply imputed data</a><ul>
<li class="chapter" data-level="15.8.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#validating-summary-statistics-3"><i class="fa fa-check"></i><b>15.8.1</b> Validating Summary Statistics</a></li>
<li class="chapter" data-level="15.8.2" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#anova-for-the-model-3"><i class="fa fa-check"></i><b>15.8.2</b> ANOVA for the model</a></li>
<li class="chapter" data-level="15.8.3" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#summarizing-effect-size-3"><i class="fa fa-check"></i><b>15.8.3</b> Summarizing Effect Size</a></li>
<li class="chapter" data-level="15.8.4" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#plotting-the-model-with-ggplot-and-predict-3"><i class="fa fa-check"></i><b>15.8.4</b> Plotting the Model with <code>ggplot</code> and <code>Predict</code></a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#comparing-model-b.2-to-model-a.2-after-simple-imputation"><i class="fa fa-check"></i><b>15.9</b> Comparing Model B.2 to Model A.2 after simple imputation</a><ul>
<li class="chapter" data-level="15.9.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#comparison-by-analysis-of-variance"><i class="fa fa-check"></i><b>15.9.1</b> Comparison by Analysis of Variance</a></li>
<li class="chapter" data-level="15.9.2" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#comparing-aic-and-bic-1"><i class="fa fa-check"></i><b>15.9.2</b> Comparing AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#dealing-with-missing-data-via-multiple-imputation-1"><i class="fa fa-check"></i><b>15.10</b> Dealing with Missing Data via Multiple Imputation</a><ul>
<li class="chapter" data-level="15.10.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#using-aregimpute-to-fit-a-multiple-imputation-model-1"><i class="fa fa-check"></i><b>15.10.1</b> Using <code>aregImpute</code> to fit a multiple imputation model</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#combining-the-imputation-and-outcome-models-1"><i class="fa fa-check"></i><b>15.11</b> Combining the Imputation and Outcome Models</a><ul>
<li class="chapter" data-level="15.11.1" data-path="linear-regression-and-the-smartcle1-data.html"><a href="linear-regression-and-the-smartcle1-data.html#model-a-with-multiple-imputation"><i class="fa fa-check"></i><b>15.11.1</b> Model A with Multiple Imputation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html"><i class="fa fa-check"></i><b>16</b> Colorectal Cancer Screening and Some Special Cases</a><ul>
<li class="chapter" data-level="16.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#logistic-regression-for-aggregated-data"><i class="fa fa-check"></i><b>16.1</b> Logistic Regression for Aggregated Data</a><ul>
<li class="chapter" data-level="16.1.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data"><i class="fa fa-check"></i><b>16.1.1</b> Colorectal Cancer Screening Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-proportion-data"><i class="fa fa-check"></i><b>16.1.2</b> Fitting a Logistic Regression Model to Proportion Data</a></li>
<li class="chapter" data-level="16.1.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-counts-of-successes-and-failures"><i class="fa fa-check"></i><b>16.1.3</b> Fitting a Logistic Regression Model to Counts of Successes and Failures</a></li>
<li class="chapter" data-level="16.1.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#how-does-one-address-this-problem-in-rms"><i class="fa fa-check"></i><b>16.1.4</b> How does one address this problem in <code>rms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#probit-regression"><i class="fa fa-check"></i><b>16.2</b> Probit Regression</a><ul>
<li class="chapter" data-level="16.2.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data-on-individuals"><i class="fa fa-check"></i><b>16.2.1</b> Colorectal Cancer Screening Data on Individuals</a></li>
<li class="chapter" data-level="16.2.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-logistic-regression-model"><i class="fa fa-check"></i><b>16.2.2</b> A logistic regression model</a></li>
<li class="chapter" data-level="16.2.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#predicting-status-for-harry-and-sally"><i class="fa fa-check"></i><b>16.2.3</b> Predicting status for Harry and Sally</a></li>
<li class="chapter" data-level="16.2.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-probit-regression-model"><i class="fa fa-check"></i><b>16.2.4</b> A probit regression model</a></li>
<li class="chapter" data-level="16.2.5" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#interpreting-the-probit-models-coefficients"><i class="fa fa-check"></i><b>16.2.5</b> Interpreting the Probit Model’s Coefficients</a></li>
<li class="chapter" data-level="16.2.6" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#what-about-harry-and-sally"><i class="fa fa-check"></i><b>16.2.6</b> What about Harry and Sally?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html"><i class="fa fa-check"></i><b>17</b> Cleaning the BRFSS SMART Data</a><ul>
<li class="chapter" data-level="17.1" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#key-resources-1"><i class="fa fa-check"></i><b>17.1</b> Key resources</a></li>
<li class="chapter" data-level="17.2" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#ingesting-the-raw-data"><i class="fa fa-check"></i><b>17.2</b> Ingesting The Raw Data</a></li>
<li class="chapter" data-level="17.3" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#the-national-data"><i class="fa fa-check"></i><b>17.3</b> The National Data</a></li>
<li class="chapter" data-level="17.4" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#cleaning-the-brfss-data"><i class="fa fa-check"></i><b>17.4</b> Cleaning the BRFSS Data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#health-status-1-item"><i class="fa fa-check"></i><b>17.4.1</b> Health Status (1 item)</a></li>
<li class="chapter" data-level="17.4.2" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#healthy-days---health-related-quality-of-life-3-items"><i class="fa fa-check"></i><b>17.4.2</b> Healthy Days - Health-Related Quality of Life (3 items)</a></li>
<li class="chapter" data-level="17.4.3" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#health-care-access-4-items"><i class="fa fa-check"></i><b>17.4.3</b> Health Care Access (4 items)</a></li>
<li class="chapter" data-level="17.4.4" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#exercise-1-item"><i class="fa fa-check"></i><b>17.4.4</b> Exercise (1 item)</a></li>
<li class="chapter" data-level="17.4.5" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#inadequate-sleep-1-item"><i class="fa fa-check"></i><b>17.4.5</b> Inadequate Sleep (1 item)</a></li>
<li class="chapter" data-level="17.4.6" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#chronic-health-conditions-13-items"><i class="fa fa-check"></i><b>17.4.6</b> Chronic Health Conditions (13 items)</a></li>
<li class="chapter" data-level="17.4.7" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#oral-health-2-items"><i class="fa fa-check"></i><b>17.4.7</b> Oral Health (2 items)</a></li>
<li class="chapter" data-level="17.4.8" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#demographics-23-items"><i class="fa fa-check"></i><b>17.4.8</b> Demographics (23 items)</a></li>
<li class="chapter" data-level="17.4.9" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#tobacco-use-5-items"><i class="fa fa-check"></i><b>17.4.9</b> Tobacco Use (5 items)</a></li>
<li class="chapter" data-level="17.4.10" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#e-cigarettes-2-items"><i class="fa fa-check"></i><b>17.4.10</b> E-Cigarettes (2 items)</a></li>
<li class="chapter" data-level="17.4.11" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#alcohol-consumption-4-items"><i class="fa fa-check"></i><b>17.4.11</b> Alcohol Consumption (4 items)</a></li>
<li class="chapter" data-level="17.4.12" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#immunization-4-items"><i class="fa fa-check"></i><b>17.4.12</b> Immunization (4 items)</a></li>
<li class="chapter" data-level="17.4.13" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#falls-2-items"><i class="fa fa-check"></i><b>17.4.13</b> Falls (2 items)</a></li>
<li class="chapter" data-level="17.4.14" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#seatbelt-use-1-item"><i class="fa fa-check"></i><b>17.4.14</b> Seatbelt Use (1 item)</a></li>
<li class="chapter" data-level="17.4.15" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#drinking-and-driving-1-item"><i class="fa fa-check"></i><b>17.4.15</b> Drinking and Driving (1 item)</a></li>
<li class="chapter" data-level="17.4.16" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#breast-and-cervical-cancer-screening-7-items"><i class="fa fa-check"></i><b>17.4.16</b> Breast and Cervical Cancer Screening (7 items)</a></li>
<li class="chapter" data-level="17.4.17" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#prostate-cancer-screening-6-items"><i class="fa fa-check"></i><b>17.4.17</b> Prostate Cancer Screening (6 items)</a></li>
<li class="chapter" data-level="17.4.18" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#colorectal-cancer-screening-5-items"><i class="fa fa-check"></i><b>17.4.18</b> Colorectal Cancer Screening (5 items)</a></li>
<li class="chapter" data-level="17.4.19" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#hivaids-3-items"><i class="fa fa-check"></i><b>17.4.19</b> HIV/AIDS (3 items)</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#creating-some-quantitative-variables-from-thin-air"><i class="fa fa-check"></i><b>17.5</b> Creating Some Quantitative Variables from Thin Air</a><ul>
<li class="chapter" data-level="17.5.1" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#age_imp-creating-age-data-out-of-thin-air"><i class="fa fa-check"></i><b>17.5.1</b> <code>age_imp</code>: Creating Age Data out of Thin Air</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#clean-data-in-the-state-of-ohio"><i class="fa fa-check"></i><b>17.6</b> Clean Data in the State of Ohio</a></li>
<li class="chapter" data-level="17.7" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#clean-cleveland-elyria-data"><i class="fa fa-check"></i><b>17.7</b> Clean Cleveland-Elyria Data</a><ul>
<li class="chapter" data-level="17.7.1" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#cleveland---elyria-raw-data"><i class="fa fa-check"></i><b>17.7.1</b> Cleveland - Elyria Raw Data</a></li>
<li class="chapter" data-level="17.7.2" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#clean-data---larger"><i class="fa fa-check"></i><b>17.7.2</b> Clean Data - Larger</a></li>
<li class="chapter" data-level="17.7.3" data-path="cleaning-the-brfss-smart-data.html"><a href="cleaning-the-brfss-smart-data.html#creation-of-the-smartcle1.csv-data"><i class="fa fa-check"></i><b>17.7.3</b> Creation of the <code>smartcle1.csv</code> data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>18</b> Modeling a Count Outcome in Ohio SMART</a><ul>
<li class="chapter" data-level="18.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#preliminaries"><i class="fa fa-check"></i><b>18.1</b> Preliminaries</a></li>
<li class="chapter" data-level="18.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data"><i class="fa fa-check"></i><b>18.2</b> A subset of the Ohio SMART data</a><ul>
<li class="chapter" data-level="18.2.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#is-age-group-associated-with-physhealth"><i class="fa fa-check"></i><b>18.2.1</b> Is age group associated with <code>physhealth</code>?</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#exploratory-data-analysis-in-the-18-49-group"><i class="fa fa-check"></i><b>18.3</b> Exploratory Data Analysis (in the 18-49 group)</a><ul>
<li class="chapter" data-level="18.3.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#build-a-subset-of-those-ages-18-49"><i class="fa fa-check"></i><b>18.3.1</b> Build a subset of those ages 18-49</a></li>
<li class="chapter" data-level="18.3.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#distribution-of-the-outcome"><i class="fa fa-check"></i><b>18.3.2</b> Distribution of the Outcome</a></li>
<li class="chapter" data-level="18.3.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#initial-scatterplot-matrix"><i class="fa fa-check"></i><b>18.3.3</b> Initial Scatterplot Matrix</a></li>
<li class="chapter" data-level="18.3.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#dropping-the-subject-with-an-unreasonably-large-bmi"><i class="fa fa-check"></i><b>18.3.4</b> Dropping the subject with an unreasonably large <code>bmi</code></a></li>
<li class="chapter" data-level="18.3.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#revised-final-scatterplot-matrix"><i class="fa fa-check"></i><b>18.3.5</b> Revised (Final) Scatterplot Matrix</a></li>
<li class="chapter" data-level="18.3.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-the-final-subset-of-data"><i class="fa fa-check"></i><b>18.3.6</b> Summary of the final subset of data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeling-strategies-explored-here"><i class="fa fa-check"></i><b>18.4</b> Modeling Strategies Explored Here</a><ul>
<li class="chapter" data-level="18.4.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#what-will-we-demonstrate"><i class="fa fa-check"></i><b>18.4.1</b> What Will We Demonstrate?</a></li>
<li class="chapter" data-level="18.4.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#extra-data-file-for-harry-and-sally"><i class="fa fa-check"></i><b>18.4.2</b> Extra Data File for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-ols-approach"><i class="fa fa-check"></i><b>18.5</b> The OLS Approach</a><ul>
<li class="chapter" data-level="18.5.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation"><i class="fa fa-check"></i><b>18.5.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.5.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>18.5.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.5.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors"><i class="fa fa-check"></i><b>18.5.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.5.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals"><i class="fa fa-check"></i><b>18.5.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.5.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values"><i class="fa fa-check"></i><b>18.5.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="18.5.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions"><i class="fa fa-check"></i><b>18.5.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.5.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally"><i class="fa fa-check"></i><b>18.5.7</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="18.5.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#notes"><i class="fa fa-check"></i><b>18.5.8</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ols-model-on-logphyshealth-1-days"><i class="fa fa-check"></i><b>18.6</b> OLS model on log(<code>physhealth</code> + 1) days</a><ul>
<li class="chapter" data-level="18.6.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-1"><i class="fa fa-check"></i><b>18.6.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.6.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-1"><i class="fa fa-check"></i><b>18.6.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.6.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-1"><i class="fa fa-check"></i><b>18.6.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.6.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>18.6.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.6.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-1"><i class="fa fa-check"></i><b>18.6.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="18.6.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#getting-r2-on-the-scale-of-physhealth"><i class="fa fa-check"></i><b>18.6.6</b> Getting R<sup>2</sup> on the scale of <code>physhealth</code></a></li>
<li class="chapter" data-level="18.6.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-1"><i class="fa fa-check"></i><b>18.6.7</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.6.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-1"><i class="fa fa-check"></i><b>18.6.8</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-poisson-regression-model"><i class="fa fa-check"></i><b>18.7</b> A Poisson Regression Model</a><ul>
<li class="chapter" data-level="18.7.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-2"><i class="fa fa-check"></i><b>18.7.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.7.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-2"><i class="fa fa-check"></i><b>18.7.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.7.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-2"><i class="fa fa-check"></i><b>18.7.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.7.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#correcting-for-overdispersion-with-coeftestcoefci"><i class="fa fa-check"></i><b>18.7.4</b> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></a></li>
<li class="chapter" data-level="18.7.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-2"><i class="fa fa-check"></i><b>18.7.5</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.7.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-see-the-fit-of-a-count-regression-model"><i class="fa fa-check"></i><b>18.7.6</b> Rootogram: see the fit of a count regression model</a></li>
<li class="chapter" data-level="18.7.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-2"><i class="fa fa-check"></i><b>18.7.7</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="18.7.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-2"><i class="fa fa-check"></i><b>18.7.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.7.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#using-glm.diag.plots-from-the-boot-package"><i class="fa fa-check"></i><b>18.7.9</b> Using <code>glm.diag.plots</code> from the <code>boot</code> package</a></li>
<li class="chapter" data-level="18.7.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-2"><i class="fa fa-check"></i><b>18.7.10</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>18.8</b> Overdispersion in a Poisson Model</a><ul>
<li class="chapter" data-level="18.8.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-for-overdispersion"><i class="fa fa-check"></i><b>18.8.1</b> Testing for Overdispersion?</a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#fitting-the-quasi-poisson-model"><i class="fa fa-check"></i><b>18.9</b> Fitting the Quasi-Poisson Model</a><ul>
<li class="chapter" data-level="18.9.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-3"><i class="fa fa-check"></i><b>18.9.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.9.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-3"><i class="fa fa-check"></i><b>18.9.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.9.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-3"><i class="fa fa-check"></i><b>18.9.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.9.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-3"><i class="fa fa-check"></i><b>18.9.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.9.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-3"><i class="fa fa-check"></i><b>18.9.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="18.9.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-3"><i class="fa fa-check"></i><b>18.9.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.9.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-3"><i class="fa fa-check"></i><b>18.9.7</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#poisson-and-quasi-poisson-models-using-glm-from-the-rms-package"><i class="fa fa-check"></i><b>18.10</b> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</a><ul>
<li class="chapter" data-level="18.10.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-original-poisson-regression-with-glm"><i class="fa fa-check"></i><b>18.10.1</b> Refitting the original Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="18.10.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-overdispersed-poisson-regression-with-glm"><i class="fa fa-check"></i><b>18.10.2</b> Refitting the overdispersed Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="18.10.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#anova-on-a-glm-fit"><i class="fa fa-check"></i><b>18.10.3</b> ANOVA on a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="18.10.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ggplots-from-glm-fit"><i class="fa fa-check"></i><b>18.10.4</b> ggplots from <code>Glm</code> fit</a></li>
<li class="chapter" data-level="18.10.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-a-glm-fit"><i class="fa fa-check"></i><b>18.10.5</b> Summary of a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="18.10.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#plot-of-the-summary"><i class="fa fa-check"></i><b>18.10.6</b> Plot of the Summary</a></li>
<li class="chapter" data-level="18.10.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#nomogram-of-a-glm-fit"><i class="fa fa-check"></i><b>18.10.7</b> Nomogram of a <code>Glm</code> fit</a></li>
</ul></li>
<li class="chapter" data-level="18.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#negative-binomial-model"><i class="fa fa-check"></i><b>18.11</b> Negative Binomial Model</a><ul>
<li class="chapter" data-level="18.11.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-4"><i class="fa fa-check"></i><b>18.11.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.11.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-with-the-raw-poisson-model"><i class="fa fa-check"></i><b>18.11.2</b> Comparison with the (raw) Poisson model</a></li>
<li class="chapter" data-level="18.11.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-4"><i class="fa fa-check"></i><b>18.11.3</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.11.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpretation-of-coefficients-in-terms-of-irrs"><i class="fa fa-check"></i><b>18.11.4</b> Interpretation of Coefficients in terms of IRRs</a></li>
<li class="chapter" data-level="18.11.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-4"><i class="fa fa-check"></i><b>18.11.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.11.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-4"><i class="fa fa-check"></i><b>18.11.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.11.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-negative-binomial-model"><i class="fa fa-check"></i><b>18.11.7</b> Rootogram for Negative Binomial model</a></li>
<li class="chapter" data-level="18.11.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#simulating-what-the-negative-binomial-model-predicts"><i class="fa fa-check"></i><b>18.11.8</b> Simulating what the Negative Binomial model predicts</a></li>
<li class="chapter" data-level="18.11.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-4"><i class="fa fa-check"></i><b>18.11.9</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="18.11.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-4"><i class="fa fa-check"></i><b>18.11.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.11.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-4"><i class="fa fa-check"></i><b>18.11.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-problem-too-few-zeros"><i class="fa fa-check"></i><b>18.12</b> The Problem: Too Few Zeros</a></li>
<li class="chapter" data-level="18.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-poisson-regression-model"><i class="fa fa-check"></i><b>18.13</b> The Zero-Inflated Poisson Regression Model</a><ul>
<li class="chapter" data-level="18.13.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model"><i class="fa fa-check"></i><b>18.13.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="18.13.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-with-the-vuong-test"><i class="fa fa-check"></i><b>18.13.2</b> Comparison to a Poisson Model with the Vuong test</a></li>
<li class="chapter" data-level="18.13.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-5"><i class="fa fa-check"></i><b>18.13.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.13.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-5"><i class="fa fa-check"></i><b>18.13.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.13.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-5"><i class="fa fa-check"></i><b>18.13.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.13.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-5"><i class="fa fa-check"></i><b>18.13.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.13.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts"><i class="fa fa-check"></i><b>18.13.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="18.13.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zip-model"><i class="fa fa-check"></i><b>18.13.8</b> Rootogram for ZIP model</a></li>
<li class="chapter" data-level="18.13.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values"><i class="fa fa-check"></i><b>18.13.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="18.13.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-5"><i class="fa fa-check"></i><b>18.13.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.13.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-5"><i class="fa fa-check"></i><b>18.13.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-negative-binomial-regression-model"><i class="fa fa-check"></i><b>18.14</b> The Zero-Inflated Negative Binomial Regression Model</a><ul>
<li class="chapter" data-level="18.14.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-1"><i class="fa fa-check"></i><b>18.14.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="18.14.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test"><i class="fa fa-check"></i><b>18.14.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="18.14.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-6"><i class="fa fa-check"></i><b>18.14.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.14.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-6"><i class="fa fa-check"></i><b>18.14.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.14.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-6"><i class="fa fa-check"></i><b>18.14.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.14.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-6"><i class="fa fa-check"></i><b>18.14.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.14.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-1"><i class="fa fa-check"></i><b>18.14.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="18.14.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>18.14.8</b> Rootogram for Zero-Inflated Negative Binomial model</a></li>
<li class="chapter" data-level="18.14.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-1"><i class="fa fa-check"></i><b>18.14.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="18.14.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-6"><i class="fa fa-check"></i><b>18.14.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.14.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-6"><i class="fa fa-check"></i><b>18.14.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.15" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-poisson"><i class="fa fa-check"></i><b>18.15</b> A “hurdle” model (with Poisson)</a><ul>
<li class="chapter" data-level="18.15.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-2"><i class="fa fa-check"></i><b>18.15.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="18.15.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-vuong-test"><i class="fa fa-check"></i><b>18.15.2</b> Comparison to a Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="18.15.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-poisson-model-vuong-test"><i class="fa fa-check"></i><b>18.15.3</b> Comparison to a Zero-Inflated Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="18.15.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-7"><i class="fa fa-check"></i><b>18.15.4</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.15.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-7"><i class="fa fa-check"></i><b>18.15.5</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.15.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-7"><i class="fa fa-check"></i><b>18.15.6</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.15.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-7"><i class="fa fa-check"></i><b>18.15.7</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.15.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-2"><i class="fa fa-check"></i><b>18.15.8</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="18.15.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-hurdle-model"><i class="fa fa-check"></i><b>18.15.9</b> Rootogram for Hurdle Model</a></li>
<li class="chapter" data-level="18.15.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#understanding-the-modeled-counts-in-detail"><i class="fa fa-check"></i><b>18.15.10</b> Understanding the Modeled Counts in Detail</a></li>
<li class="chapter" data-level="18.15.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-2"><i class="fa fa-check"></i><b>18.15.11</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="18.15.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-7"><i class="fa fa-check"></i><b>18.15.12</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.15.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-7"><i class="fa fa-check"></i><b>18.15.13</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="18.16" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-negative-binomial-for-overdispersion"><i class="fa fa-check"></i><b>18.16</b> A “hurdle” model (with negative binomial for overdispersion)</a><ul>
<li class="chapter" data-level="18.16.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-3"><i class="fa fa-check"></i><b>18.16.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="18.16.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test-1"><i class="fa fa-check"></i><b>18.16.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="18.16.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-nb-model-vuong-test"><i class="fa fa-check"></i><b>18.16.3</b> Comparison to a Zero-Inflated NB Model: Vuong test</a></li>
<li class="chapter" data-level="18.16.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparing-the-hurdle-models-with-aic-and-bic"><i class="fa fa-check"></i><b>18.16.4</b> Comparing the Hurdle Models with AIC and BIC</a></li>
<li class="chapter" data-level="18.16.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-8"><i class="fa fa-check"></i><b>18.16.5</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.16.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-8"><i class="fa fa-check"></i><b>18.16.6</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.16.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-8"><i class="fa fa-check"></i><b>18.16.7</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.16.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-8"><i class="fa fa-check"></i><b>18.16.8</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.16.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-nb-hurdle-model"><i class="fa fa-check"></i><b>18.16.9</b> Rootogram for NB Hurdle Model</a></li>
<li class="chapter" data-level="18.16.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-3"><i class="fa fa-check"></i><b>18.16.10</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="18.16.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-8"><i class="fa fa-check"></i><b>18.16.11</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.16.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-8"><i class="fa fa-check"></i><b>18.16.12</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="18.16.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#note-fitting-a-different-hurdle-model-for-counts-and-przero"><i class="fa fa-check"></i><b>18.16.13</b> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</a></li>
<li class="chapter" data-level="18.16.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#hanging-rootogram-for-this-new-hurdle-model"><i class="fa fa-check"></i><b>18.16.14</b> Hanging Rootogram for this new Hurdle Model</a></li>
</ul></li>
<li class="chapter" data-level="18.17" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-tobit-censored-regression-model"><i class="fa fa-check"></i><b>18.17</b> A Tobit (Censored) Regression Model</a><ul>
<li class="chapter" data-level="18.17.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-9"><i class="fa fa-check"></i><b>18.17.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="18.17.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-9"><i class="fa fa-check"></i><b>18.17.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="18.17.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-9"><i class="fa fa-check"></i><b>18.17.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="18.17.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-9"><i class="fa fa-check"></i><b>18.17.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="18.17.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#building-something-like-a-rootogram"><i class="fa fa-check"></i><b>18.17.5</b> Building Something Like a Rootogram</a></li>
<li class="chapter" data-level="18.17.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#tables-of-the-observed-and-fitted-physhealth-from-tobit"><i class="fa fa-check"></i><b>18.17.6</b> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</a></li>
<li class="chapter" data-level="18.17.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-4"><i class="fa fa-check"></i><b>18.17.7</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="18.17.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-9"><i class="fa fa-check"></i><b>18.17.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="18.17.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-9"><i class="fa fa-check"></i><b>18.17.9</b> Predictions for Harry and Sally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>19</b> Modeling an Ordinal Categorical Outcome in Ohio SMART</a><ul>
<li class="chapter" data-level="19.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#preliminaries-1"><i class="fa fa-check"></i><b>19.1</b> Preliminaries</a></li>
<li class="chapter" data-level="19.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data-1"><i class="fa fa-check"></i><b>19.2</b> A subset of the Ohio SMART data</a><ul>
<li class="chapter" data-level="19.2.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#several-ways-of-storing-multi-categorical-data"><i class="fa fa-check"></i><b>19.2.1</b> Several Ways of Storing Multi-Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-cross-tabulations"><i class="fa fa-check"></i><b>19.3</b> Building Cross-Tabulations</a><ul>
<li class="chapter" data-level="19.3.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-base-table-functions"><i class="fa fa-check"></i><b>19.3.1</b> Using base <code>table</code> functions</a></li>
<li class="chapter" data-level="19.3.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-xtabs"><i class="fa fa-check"></i><b>19.3.2</b> Using <code>xtabs</code></a></li>
<li class="chapter" data-level="19.3.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#storing-a-table-in-a-tibble"><i class="fa fa-check"></i><b>19.3.3</b> Storing a table in a tibble</a></li>
<li class="chapter" data-level="19.3.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-crosstable-from-the-gmodels-package"><i class="fa fa-check"></i><b>19.3.4</b> Using <code>CrossTable</code> from the <code>gmodels</code> package</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#graphing-categorical-data"><i class="fa fa-check"></i><b>19.4</b> Graphing Categorical Data</a><ul>
<li class="chapter" data-level="19.4.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-bar-chart-for-a-single-variable"><i class="fa fa-check"></i><b>19.4.1</b> A Bar Chart for a Single Variable</a></li>
<li class="chapter" data-level="19.4.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-counts-chart-for-a-2-way-cross-tabulation"><i class="fa fa-check"></i><b>19.4.2</b> A Counts Chart for a 2-Way Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-model-for-genh-using-sleephrs"><i class="fa fa-check"></i><b>19.5</b> Building a Model for <code>genh</code> using <code>sleephrs</code></a><ul>
<li class="chapter" data-level="19.5.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-little-eda"><i class="fa fa-check"></i><b>19.5.1</b> A little EDA</a></li>
<li class="chapter" data-level="19.5.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#describing-the-proportional-odds-cumulative-logit-model"><i class="fa fa-check"></i><b>19.5.2</b> Describing the Proportional-Odds Cumulative Logit Model</a></li>
<li class="chapter" data-level="19.5.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#fitting-a-proportional-odds-logistic-regression-with-polr"><i class="fa fa-check"></i><b>19.5.3</b> Fitting a Proportional Odds Logistic Regression with <code>polr</code></a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-model-m1"><i class="fa fa-check"></i><b>19.6</b> Interpreting Model <code>m1</code></a><ul>
<li class="chapter" data-level="19.6.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#looking-at-predictions"><i class="fa fa-check"></i><b>19.6.1</b> Looking at Predictions</a></li>
<li class="chapter" data-level="19.6.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#making-predictions-for-harry-and-sally-with-predict"><i class="fa fa-check"></i><b>19.6.2</b> Making Predictions for Harry (and Sally) with <code>predict</code></a></li>
<li class="chapter" data-level="19.6.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#predicting-the-actual-classification-of-genh"><i class="fa fa-check"></i><b>19.6.3</b> Predicting the actual classification of <code>genh</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabuation-of-predictions"><i class="fa fa-check"></i><b>19.6.4</b> A Cross-Tabuation of Predictions?</a></li>
<li class="chapter" data-level="19.6.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-fitted-model-equations"><i class="fa fa-check"></i><b>19.6.5</b> The Fitted Model Equations</a></li>
<li class="chapter" data-level="19.6.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-sleephrs-coefficient"><i class="fa fa-check"></i><b>19.6.6</b> Interpreting the <code>sleephrs</code> coefficient</a></li>
<li class="chapter" data-level="19.6.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#exponentiating-the-slope-coefficient-to-facilitate-interpretation"><i class="fa fa-check"></i><b>19.6.7</b> Exponentiating the Slope Coefficient to facilitate Interpretation</a></li>
<li class="chapter" data-level="19.6.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#comparison-to-a-null-model-4"><i class="fa fa-check"></i><b>19.6.8</b> Comparison to a Null Model</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-assumption-of-proportional-odds"><i class="fa fa-check"></i><b>19.7</b> The Assumption of Proportional Odds</a><ul>
<li class="chapter" data-level="19.7.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption"><i class="fa fa-check"></i><b>19.7.1</b> Testing the Proportional Odds Assumption</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#can-model-m1-be-fit-using-rms-tools"><i class="fa fa-check"></i><b>19.8</b> Can model <code>m1</code> be fit using <code>rms</code> tools?</a></li>
<li class="chapter" data-level="19.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-three-predictor-model"><i class="fa fa-check"></i><b>19.9</b> Building a Three-Predictor Model</a><ul>
<li class="chapter" data-level="19.9.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#scatterplot-matrix"><i class="fa fa-check"></i><b>19.9.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="19.9.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#our-three-predictor-model-m2"><i class="fa fa-check"></i><b>19.9.2</b> Our Three-Predictor Model, <code>m2</code></a></li>
<li class="chapter" data-level="19.9.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#does-the-three-predictor-model-outperform-m1"><i class="fa fa-check"></i><b>19.9.3</b> Does the three-predictor model outperform <code>m1</code>?</a></li>
<li class="chapter" data-level="19.9.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#wald-tests-for-individual-predictors"><i class="fa fa-check"></i><b>19.9.4</b> Wald tests for individual predictors</a></li>
<li class="chapter" data-level="19.9.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabuation-of-predictions-1"><i class="fa fa-check"></i><b>19.9.5</b> A Cross-Tabuation of Predictions?</a></li>
<li class="chapter" data-level="19.9.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-effect-sizes"><i class="fa fa-check"></i><b>19.9.6</b> Interpreting the Effect Sizes</a></li>
<li class="chapter" data-level="19.9.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#quality-of-the-model-fit"><i class="fa fa-check"></i><b>19.9.7</b> Quality of the Model Fit</a></li>
<li class="chapter" data-level="19.9.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m2_lrm"><i class="fa fa-check"></i><b>19.9.8</b> Validating the Summary Statistics in <code>m2_lrm</code></a></li>
<li class="chapter" data-level="19.9.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption-1"><i class="fa fa-check"></i><b>19.9.9</b> Testing the Proportional Odds Assumption</a></li>
<li class="chapter" data-level="19.9.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>19.9.10</b> Plotting the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-larger-model-including-income-group"><i class="fa fa-check"></i><b>19.10</b> A Larger Model, including income group</a><ul>
<li class="chapter" data-level="19.10.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cross-tabulation-of-predictedobserved-classifications"><i class="fa fa-check"></i><b>19.10.1</b> Cross-Tabulation of Predicted/Observed Classifications</a></li>
<li class="chapter" data-level="19.10.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#nomogram-1"><i class="fa fa-check"></i><b>19.10.2</b> Nomogram</a></li>
<li class="chapter" data-level="19.10.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-predict-and-showing-mean-prediction-on-1-5-scale-1"><i class="fa fa-check"></i><b>19.10.3</b> Using Predict and showing mean prediction on 1-5 scale</a></li>
<li class="chapter" data-level="19.10.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m3_lrm"><i class="fa fa-check"></i><b>19.10.4</b> Validating the Summary Statistics in <code>m3_lrm</code></a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#references-for-this-chapter"><i class="fa fa-check"></i><b>19.11</b> References for this Chapter</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>20</b> Analyzing Literary Styles with Multinomial Logistic Regression</a><ul>
<li class="chapter" data-level="20.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#the-authorship-example"><i class="fa fa-check"></i><b>20.1</b> The Authorship Example</a></li>
<li class="chapter" data-level="20.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#focus-on-11-key-words"><i class="fa fa-check"></i><b>20.2</b> Focus on 11 key words</a><ul>
<li class="chapter" data-level="20.2.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>20.2.1</b> Side by Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-multinomial-logistic-regression-model"><i class="fa fa-check"></i><b>20.3</b> A Multinomial Logistic Regression Model</a><ul>
<li class="chapter" data-level="20.3.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-1"><i class="fa fa-check"></i><b>20.3.1</b> Testing Model 1</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#model-2"><i class="fa fa-check"></i><b>20.4</b> Model 2</a><ul>
<li class="chapter" data-level="20.4.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#comparing-model-2-to-model-1"><i class="fa fa-check"></i><b>20.4.1</b> Comparing Model 2 to Model 1</a></li>
<li class="chapter" data-level="20.4.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-2"><i class="fa fa-check"></i><b>20.4.2</b> Testing Model 2</a></li>
<li class="chapter" data-level="20.4.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-little-history"><i class="fa fa-check"></i><b>20.4.3</b> A little history</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#classification-table"><i class="fa fa-check"></i><b>20.5</b> Classification Table</a></li>
<li class="chapter" data-level="20.6" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#probability-curves-based-on-a-single-predictor"><i class="fa fa-check"></i><b>20.6</b> Probability Curves based on a Single Predictor</a><ul>
<li class="chapter" data-level="20.6.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#produce-the-plot-of-estimated-probabilities-based-on-been-counts"><i class="fa fa-check"></i><b>20.6.1</b> Produce the Plot of Estimated Probabilities based on “been” counts</a></li>
<li class="chapter" data-level="20.6.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#boxplot-of-been-counts"><i class="fa fa-check"></i><b>20.6.2</b> Boxplot of “been” counts</a></li>
<li class="chapter" data-level="20.6.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#quote-sources"><i class="fa fa-check"></i><b>20.6.3</b> Quote Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html"><i class="fa fa-check"></i><b>21</b> Exploring Time To Event / Survival Data</a><ul>
<li class="chapter" data-level="21.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#an-outline-of-key-topics-discussed-in-these-notes"><i class="fa fa-check"></i><b>21.1</b> An Outline of Key Topics Discussed in these Notes</a></li>
<li class="chapter" data-level="21.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#foundations-of-survival-analysis"><i class="fa fa-check"></i><b>21.2</b> Foundations of Survival Analysis</a><ul>
<li class="chapter" data-level="21.2.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-survival-function-st"><i class="fa fa-check"></i><b>21.2.1</b> The Survival Function, <span class="math inline">\(S(t)\)</span></a></li>
<li class="chapter" data-level="21.2.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-estimator-of-the-survival-function"><i class="fa fa-check"></i><b>21.2.2</b> Kaplan-Meier Estimator of the Survival Function</a></li>
<li class="chapter" data-level="21.2.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#creating-a-survival-object-in-r"><i class="fa fa-check"></i><b>21.2.3</b> Creating a Survival Object in R</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-first-example-recurrent-lobar-intracerebral-hemorrhage"><i class="fa fa-check"></i><b>21.3</b> A First Example: Recurrent Lobar Intracerebral Hemorrhage</a><ul>
<li class="chapter" data-level="21.3.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#building-a-survival-object"><i class="fa fa-check"></i><b>21.3.1</b> Building a Survival Object</a></li>
<li class="chapter" data-level="21.3.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-estimate-of-the-survival-function"><i class="fa fa-check"></i><b>21.3.2</b> Kaplan-Meier Estimate of the Survival Function</a></li>
<li class="chapter" data-level="21.3.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-kaplan-meier-plot-using-base-r"><i class="fa fa-check"></i><b>21.3.3</b> The Kaplan-Meier Plot, using Base R</a></li>
<li class="chapter" data-level="21.3.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#using-survminer-to-draw-survival-curves"><i class="fa fa-check"></i><b>21.3.4</b> Using <code>survminer</code> to draw survival curves</a></li>
<li class="chapter" data-level="21.3.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-fancy-k-m-plot-with-a-number-at-risk-table"><i class="fa fa-check"></i><b>21.3.5</b> A “Fancy” K-M Plot with a number at risk table</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#comparing-survival-across-the-two-genotypes"><i class="fa fa-check"></i><b>21.4</b> Comparing Survival Across the Two Genotypes</a><ul>
<li class="chapter" data-level="21.4.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-survival-function-estimates-by-genotype"><i class="fa fa-check"></i><b>21.4.1</b> Kaplan-Meier Survival Function Estimates, by Genotype</a></li>
<li class="chapter" data-level="21.4.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#plotting-the-k-m-comparison-with-ggsurvplot"><i class="fa fa-check"></i><b>21.4.2</b> Plotting the K-M comparison with <code>ggsurvplot</code></a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#testing-the-difference-between-two-survival-curves"><i class="fa fa-check"></i><b>21.5</b> Testing the difference between two survival curves</a><ul>
<li class="chapter" data-level="21.5.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#alternative-log-rank-tests"><i class="fa fa-check"></i><b>21.5.1</b> Alternative log rank tests</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-fancy-k-m-plot-with-a-number-at-risk-table-1"><i class="fa fa-check"></i><b>21.6</b> A “Fancy” K-M Plot with a number at risk table</a><ul>
<li class="chapter" data-level="21.6.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#customizing-the-kaplan-meier-plot-presentation-further"><i class="fa fa-check"></i><b>21.6.1</b> Customizing the Kaplan-Meier Plot Presentation Further</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-hazard-function"><i class="fa fa-check"></i><b>21.7</b> The Hazard Function</a><ul>
<li class="chapter" data-level="21.7.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-inverse-kaplan-meier-estimator-of-ht"><i class="fa fa-check"></i><b>21.7.1</b> The Inverse Kaplan-Meier Estimator of <span class="math inline">\(H(t)\)</span></a></li>
<li class="chapter" data-level="21.7.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#cumulative-hazard-function-from-inverse-k-m"><i class="fa fa-check"></i><b>21.7.2</b> Cumulative Hazard Function from Inverse K-M</a></li>
<li class="chapter" data-level="21.7.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-nelson-aalen-estimator-of-ht"><i class="fa fa-check"></i><b>21.7.3</b> The Nelson-Aalen Estimator of <span class="math inline">\(H(t)\)</span></a></li>
<li class="chapter" data-level="21.7.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#convert-wide-data-to-long"><i class="fa fa-check"></i><b>21.7.4</b> Convert Wide Data to Long</a></li>
<li class="chapter" data-level="21.7.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#plot-comparison-of-hazard-estimates"><i class="fa fa-check"></i><b>21.7.5</b> Plot Comparison of Hazard Estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html"><i class="fa fa-check"></i><b>22</b> Cox Regression Models for Survival Data: Example 1</a><ul>
<li class="chapter" data-level="22.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#sources-used-in-building-this-material"><i class="fa fa-check"></i><b>22.1</b> Sources used in building this material</a></li>
<li class="chapter" data-level="22.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#fitting-a-cox-model-in-r-with-coxph"><i class="fa fa-check"></i><b>22.2</b> Fitting a Cox Model in R with <code>coxph</code></a><ul>
<li class="chapter" data-level="22.2.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#summarizing-the-fit"><i class="fa fa-check"></i><b>22.2.1</b> Summarizing the Fit</a></li>
<li class="chapter" data-level="22.2.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#glancing-at-the-model"><i class="fa fa-check"></i><b>22.2.2</b> Glancing at the model?</a></li>
<li class="chapter" data-level="22.2.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-the-baseline-survival-function"><i class="fa fa-check"></i><b>22.2.3</b> Plot the baseline survival function</a></li>
<li class="chapter" data-level="22.2.4" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-the-genotype-effect"><i class="fa fa-check"></i><b>22.2.4</b> Plot the genotype effect</a></li>
<li class="chapter" data-level="22.2.5" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#testing-the-key-assumption-proportional-hazards"><i class="fa fa-check"></i><b>22.2.5</b> Testing the Key Assumption: Proportional Hazards</a></li>
<li class="chapter" data-level="22.2.6" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plotting-the-cox.zph-results-for-the-cfit-model"><i class="fa fa-check"></i><b>22.2.6</b> Plotting the <code>cox.zph</code> results for the <code>cfit</code> model</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#fitting-a-cox-model-using-cph-from-the-rms-package"><i class="fa fa-check"></i><b>22.3</b> Fitting a Cox Model using <code>cph</code> from the <code>rms</code> package</a><ul>
<li class="chapter" data-level="22.3.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#the-main-cph-results"><i class="fa fa-check"></i><b>22.3.1</b> The Main <code>cph</code> results</a></li>
<li class="chapter" data-level="22.3.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#using-anova-with-cph"><i class="fa fa-check"></i><b>22.3.2</b> Using <code>anova</code> with <code>cph</code></a></li>
<li class="chapter" data-level="22.3.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#effect-sizes-after-cph-fit"><i class="fa fa-check"></i><b>22.3.3</b> Effect Sizes after <code>cph</code> fit</a></li>
<li class="chapter" data-level="22.3.4" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#validating-cph-summaries"><i class="fa fa-check"></i><b>22.3.4</b> Validating <code>cph</code> summaries</a></li>
<li class="chapter" data-level="22.3.5" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plotting-survival-functions-for-each-genotype"><i class="fa fa-check"></i><b>22.3.5</b> Plotting Survival Functions for each Genotype</a></li>
<li class="chapter" data-level="22.3.6" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#genotypes-effect-on-log-relative-hazard"><i class="fa fa-check"></i><b>22.3.6</b> Genotype’s effect on log relative hazard</a></li>
<li class="chapter" data-level="22.3.7" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#nomogram-of-our-simple-hem-model"><i class="fa fa-check"></i><b>22.3.7</b> Nomogram of our simple <code>hem</code> model</a></li>
<li class="chapter" data-level="22.3.8" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#assessing-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>22.3.8</b> Assessing the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="22.3.9" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-to-check-ph-assumption"><i class="fa fa-check"></i><b>22.3.9</b> Plot to Check PH Assumption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html"><i class="fa fa-check"></i><b>23</b> Cox Regression Models for Survival Data: Example 2</a><ul>
<li class="chapter" data-level="23.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#a-second-example-the-leukem-data"><i class="fa fa-check"></i><b>23.1</b> A Second Example: The <code>leukem</code> data</a><ul>
<li class="chapter" data-level="23.1.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#creating-our-response-a-survival-time-object"><i class="fa fa-check"></i><b>23.1.1</b> Creating our response: A survival time object</a></li>
<li class="chapter" data-level="23.1.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#models-well-fit"><i class="fa fa-check"></i><b>23.1.2</b> Models We’ll Fit</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-a-coxph-model-for-survival-time-using-age-at-diagnosis"><i class="fa fa-check"></i><b>23.2</b> Model A: <code>coxph</code> Model for Survival Time using <code>age</code> at diagnosis</a><ul>
<li class="chapter" data-level="23.2.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-survival-curve-implied-by-model-a"><i class="fa fa-check"></i><b>23.2.1</b> Plotting the Survival Curve implied by Model A</a></li>
<li class="chapter" data-level="23.2.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#testing-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>23.2.2</b> Testing the Proportional Hazards Assumption</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#building-model-a-with-cph-for-the-leukem-data"><i class="fa fa-check"></i><b>23.3</b> Building Model A with <code>cph</code> for the <code>leukem</code> data</a><ul>
<li class="chapter" data-level="23.3.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-age-effect-implied-by-our-model."><i class="fa fa-check"></i><b>23.3.1</b> Plotting the <code>age</code> effect implied by our model.</a></li>
<li class="chapter" data-level="23.3.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#survival-plots-kaplan-meier-of-the-age-effect"><i class="fa fa-check"></i><b>23.3.2</b> Survival Plots (Kaplan-Meier) of the <code>age</code> effect</a></li>
<li class="chapter" data-level="23.3.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#anova-test-for-the-cph-built-model-for-leukem"><i class="fa fa-check"></i><b>23.3.3</b> ANOVA test for the <code>cph</code>-built model for <code>leukem</code></a></li>
<li class="chapter" data-level="23.3.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#summarizing-the-effect-sizes-from-moda_cph"><i class="fa fa-check"></i><b>23.3.4</b> Summarizing the Effect Sizes from <code>modA_cph</code></a></li>
<li class="chapter" data-level="23.3.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#validating-the-cox-model-summary-statistics"><i class="fa fa-check"></i><b>23.3.5</b> Validating the Cox Model Summary Statistics</a></li>
<li class="chapter" data-level="23.3.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#looking-for-influential-points"><i class="fa fa-check"></i><b>23.3.6</b> Looking for Influential Points</a></li>
<li class="chapter" data-level="23.3.7" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>23.3.7</b> Checking the Proportional Hazards Assumption</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-b-fitting-a-5-predictor-model-with-coxph"><i class="fa fa-check"></i><b>23.4</b> Model B: Fitting a 5-Predictor Model with <code>coxph</code></a><ul>
<li class="chapter" data-level="23.4.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#interpreting-the-results-from-model-b"><i class="fa fa-check"></i><b>23.4.1</b> Interpreting the Results from Model B</a></li>
<li class="chapter" data-level="23.4.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-survival-curve-implied-by-model-b"><i class="fa fa-check"></i><b>23.4.2</b> Plotting the Survival Curve implied by Model B</a></li>
<li class="chapter" data-level="23.4.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-cumulative-hazard-implied-by-model-b"><i class="fa fa-check"></i><b>23.4.3</b> Plotting the Cumulative Hazard implied by Model B</a></li>
<li class="chapter" data-level="23.4.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#testing-the-proportional-hazards-assumption-1"><i class="fa fa-check"></i><b>23.4.4</b> Testing the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="23.4.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#assessing-collinearity"><i class="fa fa-check"></i><b>23.4.5</b> Assessing Collinearity</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-b2-a-stepwise-reduction-of-model-b"><i class="fa fa-check"></i><b>23.5</b> Model B2: A Stepwise Reduction of Model B</a><ul>
<li class="chapter" data-level="23.5.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#the-survival-curve-implied-by-model-b2"><i class="fa fa-check"></i><b>23.5.1</b> The Survival Curve implied by Model B2</a></li>
<li class="chapter" data-level="23.5.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-proportional-hazards-for-model-b2"><i class="fa fa-check"></i><b>23.5.2</b> Checking Proportional Hazards for Model B2</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-c-using-a-spearman-plot-to-pick-a-model"><i class="fa fa-check"></i><b>23.6</b> Model C: Using a Spearman Plot to pick a model</a><ul>
<li class="chapter" data-level="23.6.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#fitting-model-c"><i class="fa fa-check"></i><b>23.6.1</b> Fitting Model C</a></li>
<li class="chapter" data-level="23.6.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#anova-for-model-c"><i class="fa fa-check"></i><b>23.6.2</b> ANOVA for Model C</a></li>
<li class="chapter" data-level="23.6.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#summarizing-model-c-effect-sizes"><i class="fa fa-check"></i><b>23.6.3</b> Summarizing Model C Effect Sizes</a></li>
<li class="chapter" data-level="23.6.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-diagnosis-age-effect-in-model-c"><i class="fa fa-check"></i><b>23.6.4</b> Plotting the diagnosis <code>age</code> effect in Model C</a></li>
<li class="chapter" data-level="23.6.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#survival-plot-associated-with-model-c"><i class="fa fa-check"></i><b>23.6.5</b> Survival Plot associated with Model C</a></li>
<li class="chapter" data-level="23.6.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-the-proportional-hazards-assumption-1"><i class="fa fa-check"></i><b>23.6.6</b> Checking the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="23.6.7" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-c-nomogram"><i class="fa fa-check"></i><b>23.6.7</b> Model C Nomogram</a></li>
<li class="chapter" data-level="23.6.8" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#validating-model-cs-summary-statistics"><i class="fa fa-check"></i><b>23.6.8</b> Validating Model C’s Summary Statistics</a></li>
<li class="chapter" data-level="23.6.9" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#calibration-of-model-c-12-month-survival-estimates"><i class="fa fa-check"></i><b>23.6.9</b> Calibration of Model C (12-month survival estimates)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression-and-the-smartcle1-data" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Logistic Regression and the <code>smartcle1</code> data</h1>
<div id="the-smartcle1-data" class="section level2">
<h2><span class="header-section-number">14.1</span> The <code>smartcle1</code> data</h2>
<p>Recall that the <code>smartcle1.csv</code> data file available on the Data and Code page of <a href="https://github.com/THOMASELOVE/432-2018">our website</a> describes information on 11 variables for 1036 respondents to the BRFSS 2016, who live in the Cleveland-Elyria, OH, Metropolitan Statistical Area. As we’ve discussed in previous work, the variables in the <code>smartcle1.csv</code> file are listed below, along with (in some cases) the BRFSS items that generate these responses.</p>
<table style="width:94%;">
<colgroup>
<col width="15%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>SEQNO</code></td>
<td>respondent identification number (all begin with 2016)</td>
</tr>
<tr class="even">
<td align="right"><code>physhealth</code></td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?</td>
</tr>
<tr class="odd">
<td align="right"><code>menthealth</code></td>
<td>Now thinking about your mental health, which includes stress, depression, and problems with emotions, for how many days during the past 30 days was your mental health not good?</td>
</tr>
<tr class="even">
<td align="right"><code>poorhealth</code></td>
<td>During the past 30 days, for about how many days did poor physical or mental health keep you from doing your usual activities, such as self-care, work, or recreation?</td>
</tr>
<tr class="odd">
<td align="right"><code>genhealth</code></td>
<td>Would you say that in general, your health is … (five categories: Excellent, Very Good, Good, Fair or Poor)</td>
</tr>
<tr class="even">
<td align="right"><code>bmi</code></td>
<td>Body mass index, in kg/m<sup>2</sup></td>
</tr>
<tr class="odd">
<td align="right"><code>female</code></td>
<td>Sex, 1 = female, 0 = male</td>
</tr>
<tr class="even">
<td align="right"><code>internet30</code></td>
<td>Have you used the internet in the past 30 days? (1 = yes, 0 = no)</td>
</tr>
<tr class="odd">
<td align="right"><code>exerany</code></td>
<td>During the past month, other than your regular job, did you participate in any physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise? (1 = yes, 0 = no)</td>
</tr>
<tr class="even">
<td align="right"><code>sleephrs</code></td>
<td>On average, how many hours of sleep do you get in a 24-hour period?</td>
</tr>
<tr class="odd">
<td align="right"><code>alcdays</code></td>
<td>How many days during the past 30 days did you have at least one drink of any alcoholic beverage such as beer, wine, a malt beverage or liquor?</td>
</tr>
</tbody>
</table>
<p>In this section, we’ll use some of the variables described above to predict the binary outcome: <code>exerany</code>.</p>
</div>
<div id="thinking-about-non-linear-terms" class="section level2">
<h2><span class="header-section-number">14.2</span> Thinking About Non-Linear Terms</h2>
<p>We have enough observations here to consider some non-linearity for our model.</p>
<p>In addition, since the <code>genhealth</code> variable is an ordinal variable and multi-categorical, we should consider how to model it. We have three options:</p>
<ol style="list-style-type: decimal">
<li>include it as a factor in the model (the default approach)</li>
<li>build a numeric version of that variable, and then restrict our model to treat that numeric variable as ordinal (forcing the categories to affect the <code>exerany</code> probabilities in an ordinal way), rather than as a simple nominal factor (so that if the effect of fair vs. good was to decrease the probability of ‘exerany’, then the effect of poor vs. good would have to decrease the probability at least as much as fair vs. good did.) Treating the <code>genhealth</code> variable as ordinal could be accomplished with the <code>scored</code> function in the <code>rms</code> package.</li>
<li>build a numeric version of <code>genhealth</code> and then use the <code>catg</code> function to specify the predictor as nominal and categorical, but this will lead to essentially the same model as choice 1.</li>
</ol>
<p>Suppose we’ve decided to treat the <code>genhealth</code> data as categorical, without restricting the effect of its various levels to be ordinal. Suppose also that we’ve decided to include the following seven variables in our model for <code>exerany</code>:</p>
<ul>
<li><code>physhealth</code></li>
<li><code>menthealth</code></li>
<li><code>genhealth</code></li>
<li><code>bmi</code></li>
<li><code>female</code></li>
<li><code>internet30</code></li>
<li><code>sleephrs</code></li>
</ul>
<p>Suppose we have a subject matter understanding that:</p>
<ul>
<li>the impact of <code>bmi</code> on <code>exerany</code> is affected by <code>female</code>, so we plan a <code>female</code> x <code>bmi</code> interaction term</li>
<li>we’re using <code>internet30</code> as a proxy for poverty, and we think that an interaction with self-reported <code>genhealth</code> will be helpful in our model as well.</li>
</ul>
<p>Note that we do have some missing values in some of these predictors, so we’ll have to deal with that soon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smartcle1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(exerany, physhealth, menthealth, 
                     genhealth, bmi, female, internet30, 
                     sleephrs) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">skim</span>()</code></pre></div>
<pre><code>Skim summary statistics
 n obs: 1036 
 n variables: 8 

Variable type: factor 
  variable missing complete    n n_unique
 genhealth       3     1033 1036        5
                             top_counts ordered
 2_V: 350, 3_G: 344, 1_E: 173, 4_F: 122   FALSE

Variable type: integer 
   variable missing complete    n mean   sd p0 p25 median p75 p100
    exerany       3     1033 1036 0.76 0.43  0   1      1   1    1
     female       0     1036 1036 0.6  0.49  0   0      1   1    1
 internet30       6     1030 1036 0.81 0.39  0   1      1   1    1
 menthealth      11     1025 1036 2.72 6.82  0   0      0   2   30
 physhealth      17     1019 1036 3.97 8.67  0   0      0   2   30
   sleephrs       8     1028 1036 7.02 1.53  1   6      7   8   20

Variable type: numeric 
 variable missing complete    n  mean   sd    p0  p25 median   p75  p100
      bmi      84      952 1036 27.89 6.47 12.71 23.7  26.68 30.53 66.06</code></pre>
</div>
<div id="a-first-model-for-exerany-complete-case-analysis" class="section level2">
<h2><span class="header-section-number">14.3</span> A First Model for <code>exerany</code> (Complete Case Analysis)</h2>
<p>Suppose we develop a main-effects kitchen sink model (model <code>m1</code> below) fitted to these predictors without the benefit of any non-linear terms except the two pre-planned interactions. We’ll run the model quickly here to ensure that the code runs, in a complete case analysis, without drawing any conclusions, really.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lrm</span>(exerany <span class="op">~</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span>genhealth <span class="op">+</span><span class="st"> </span>bmi <span class="op">*</span><span class="st"> </span>female <span class="op">+</span>
<span class="st">              </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs, 
          <span class="dt">data =</span> smartcle1)
m1</code></pre></div>
<pre><code>Frequencies of Missing Values Due to Each Variable
   exerany internet30  genhealth        bmi     female physhealth 
         3          6          3         84          0         17 
menthealth   sleephrs 
        11          8 

Logistic Regression Model
 
 lrm(formula = exerany ~ internet30 * genhealth + bmi * female + 
     physhealth + menthealth + sleephrs, data = smartcle1)
 
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs           924    LR chi2     134.17    R2       0.203    C       0.739    
  0            219    d.f.            15    g        1.021    Dxy     0.479    
  1            705    Pr(&gt; chi2) &lt;0.0001    gr       2.776    gamma   0.479    
 max |deriv| 6e-13                          gp       0.174    tau-a   0.173    
                                            Brier    0.153                     
 
                                   Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept                          2.9284 0.9951  2.94  0.0033  
 internet30                         0.7234 0.7095  1.02  0.3079  
 genhealth=2_VeryGood              -0.2267 0.7653 -0.30  0.7671  
 genhealth=3_Good                  -0.7950 0.7100 -1.12  0.2629  
 genhealth=4_Fair                  -1.2818 0.7482 -1.71  0.0867  
 genhealth=5_Poor                  -0.5215 0.8590 -0.61  0.5438  
 bmi                               -0.0323 0.0220 -1.47  0.1427  
 female                            -0.5789 0.7883 -0.73  0.4627  
 physhealth                        -0.0208 0.0109 -1.92  0.0552  
 menthealth                        -0.0142 0.0122 -1.16  0.2449  
 sleephrs                          -0.0338 0.0547 -0.62  0.5357  
 internet30 * genhealth=2_VeryGood  0.1524 0.8295  0.18  0.8542  
 internet30 * genhealth=3_Good     -0.0064 0.7702 -0.01  0.9934  
 internet30 * genhealth=4_Fair     -0.3235 0.8272 -0.39  0.6957  
 internet30 * genhealth=5_Poor     -1.7847 0.9994 -1.79  0.0741  
 bmi * female                      -0.0022 0.0266 -0.08  0.9350  
 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m1))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
</div>
<div id="building-a-larger-model-spearman-rho2-plot" class="section level2">
<h2><span class="header-section-number">14.4</span> Building a Larger Model: Spearman <span class="math inline">\(\rho^2\)</span> Plot</h2>
<p>Before we impute, we might also consider the use of a Spearman <span class="math inline">\(\rho^2\)</span> plot to decide how best to spend degrees of freedom on non-linear terms in our model for <code>exerany</code> using these predictors. Since we’re already planning some interaction terms, I’ll keep them in mind as I look at this plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp_smart &lt;-<span class="st"> </span><span class="kw">spearman2</span>(exerany <span class="op">~</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>genhealth <span class="op">+</span><span class="st"> </span>internet30 <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>bmi <span class="op">+</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>sleephrs, 
                      <span class="dt">data =</span> smartcle1)
<span class="kw">plot</span>(sp_smart)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>We see that the best candidate for a non-linear term is the <code>genhealth</code> variable, according to this plot, followed by the <code>physhealth</code> and <code>internet30</code> predictors, then <code>bmi</code>. I will wind up fitting a model including the following non-linear terms…</p>
<ul>
<li>our pre-planned <code>female</code> x <code>bmi</code> and <code>internet30</code> x <code>genhealth</code> interaction terms,</li>
<li>a new <code>genhealth</code> x <code>physhealth</code> interaction term,</li>
<li>a restricted cubic spline with 5 knots for <code>physhealth</code></li>
<li>a restricted cubic spline with 4 knots for <code>bmi</code> (so the interaction term with <code>female</code> will need to account for this and restrict our interaction to the linear piece of <code>bmi</code>)</li>
</ul>
</div>
<div id="a-second-model-for-exerany-complete-cases" class="section level2">
<h2><span class="header-section-number">14.5</span> A Second Model for <code>exerany</code> (Complete Cases)</h2>
<p>Here’s the resulting model fit without worrying about imputation yet. This is just to make sure our code works. Note that I’m inserting the main effects of our interaction terms explicitly before including the interaction terms themselves, and that I need to use <code>%ia%</code> to include the interaction terms where one of the terms is included in the model with a spline. Again, I won’t draw any serious conclusions yet.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">lrm</span>(exerany <span class="op">~</span><span class="st"> </span><span class="kw">rcs</span>(bmi, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rcs</span>(physhealth, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>female <span class="op">+</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span>genhealth <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>genhealth <span class="op">%ia%</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>female <span class="op">%ia%</span><span class="st"> </span>bmi <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs, 
          <span class="dt">data =</span> smartcle1)
m2</code></pre></div>
<pre><code>Frequencies of Missing Values Due to Each Variable
   exerany        bmi physhealth     female internet30  genhealth 
         3         84         17          0          6          3 
menthealth   sleephrs 
        11          8 

Logistic Regression Model
 
 lrm(formula = exerany ~ rcs(bmi, 4) + rcs(physhealth, 5) + female + 
     internet30 * genhealth + genhealth %ia% physhealth + female %ia% 
     bmi + menthealth + sleephrs, data = smartcle1)
 
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs           924    LR chi2     142.51    R2       0.215    C       0.743    
  0            219    d.f.            22    g        1.053    Dxy     0.485    
  1            705    Pr(&gt; chi2) &lt;0.0001    gr       2.867    gamma   0.485    
 max |deriv| 6e-13                          gp       0.178    tau-a   0.176    
                                            Brier    0.151                     
 
                                   Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept                          2.2998 1.9789  1.16  0.2452  
 bmi                                0.0052 0.0801  0.06  0.9482  
 bmi&#39;                              -0.2988 0.3555 -0.84  0.4006  
 bmi&#39;&#39;                              0.8809 0.9615  0.92  0.3596  
 physhealth                         0.0410 0.0868  0.47  0.6362  
 physhealth&#39;                       -0.2944 0.3888 -0.76  0.4489  
 female                            -0.6307 0.8228 -0.77  0.4434  
 internet30                         0.6722 0.7134  0.94  0.3460  
 genhealth=2_VeryGood              -0.3092 0.7700 -0.40  0.6880  
 genhealth=3_Good                  -0.7559 0.7194 -1.05  0.2934  
 genhealth=4_Fair                  -1.1611 0.7646 -1.52  0.1289  
 genhealth=5_Poor                  -2.3680 1.2846 -1.84  0.0653  
 genhealth=2_VeryGood * physhealth  0.0099 0.0824  0.12  0.9043  
 genhealth=3_Good * physhealth     -0.0406 0.0772 -0.53  0.5992  
 genhealth=4_Fair * physhealth     -0.0407 0.0773 -0.53  0.5988  
 genhealth=5_Poor * physhealth      0.0534 0.0868  0.62  0.5382  
 female * bmi                      -0.0023 0.0275 -0.08  0.9324  
 menthealth                        -0.0143 0.0125 -1.15  0.2522  
 sleephrs                          -0.0457 0.0561 -0.81  0.4153  
 internet30 * genhealth=2_VeryGood  0.2174 0.8330  0.26  0.7941  
 internet30 * genhealth=3_Good      0.0375 0.7767  0.05  0.9615  
 internet30 * genhealth=4_Fair     -0.3080 0.8371 -0.37  0.7129  
 internet30 * genhealth=5_Poor     -1.9411 1.0150 -1.91  0.0558  
 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m2))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
</div>
<div id="dealing-with-missing-data-via-simple-imputation" class="section level2">
<h2><span class="header-section-number">14.6</span> Dealing with Missing Data via Simple Imputation</h2>
<p>One approach we might take in this problem is to use simple imputation to deal with our missing values. I will proceed as follows:</p>
<ol style="list-style-type: decimal">
<li>Omit all cases where the outcome <code>exerany</code> is missing.</li>
<li>Determine (and plot) the remaining missingness.</li>
<li>Use simple imputation for all predictors, and build a new data set with “complete” data.</li>
<li>Re-fit the proposed models using this new data set.</li>
</ol>
<div id="omit-cases-where-the-outcome-is-missing" class="section level3">
<h3><span class="header-section-number">14.6.1</span> Omit cases where the outcome is missing</h3>
<p>We need to drop the cases where <code>exerany</code> is missing in <code>smartcle1</code>. We’ll begin creating an imputed data set, called <code>smartcle_imp0</code>, by filtering on complete data for <code>exerany</code>, as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Hmisc<span class="op">::</span><span class="kw">describe</span>(smartcle1<span class="op">$</span>exerany)</code></pre></div>
<pre><code>smartcle1$exerany 
       n  missing distinct     Info      Sum     Mean      Gmd 
    1033        3        2    0.546      786   0.7609   0.3642 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smartcle_imp0 &lt;-<span class="st"> </span>smartcle1 <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(exerany)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(SEQNO, exerany, physhealth, menthealth, 
           genhealth, bmi, female, internet30, sleephrs)

Hmisc<span class="op">::</span><span class="kw">describe</span>(smartcle_imp0<span class="op">$</span>exerany)</code></pre></div>
<pre><code>smartcle_imp0$exerany 
       n  missing distinct     Info      Sum     Mean      Gmd 
    1033        0        2    0.546      786   0.7609   0.3642 </code></pre>
</div>
<div id="plot-the-remaining-missingness" class="section level3">
<h3><span class="header-section-number">14.6.2</span> Plot the remaining missingness</h3>
<p>We’ll look at the missing values (excluding the subject ID: SEQNO) in our new data set. Of course, we can get a count of missing values within each variable with <code>skim</code> or with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(<span class="kw">is.na</span>(smartcle_imp0))</code></pre></div>
<pre><code>     SEQNO    exerany physhealth menthealth  genhealth        bmi 
         0          0         16         11          3         83 
    female internet30   sleephrs 
         0          6          7 </code></pre>
<p>The <code>Hmisc</code> package has a plotting approach which can help identify missingness, too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">naplot</span>(<span class="kw">naclus</span>(<span class="kw">select</span>(smartcle_imp0, <span class="op">-</span>SEQNO)))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-228-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-228-2.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-228-3.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-228-4.png" width="672" /></p>
<p>We can also get a useful accounting of missing data patterns, with the <code>md.pattern</code> function in the <code>mice</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mice<span class="op">::</span><span class="kw">md.pattern</span>(smartcle_imp0)</code></pre></div>
<pre><code>    SEQNO exerany female genhealth internet30 sleephrs menthealth
924     1       1      1         1          1        1          1
  8     1       1      1         1          1        1          1
  6     1       1      1         1          1        1          0
 76     1       1      1         1          1        1          1
  1     1       1      1         1          0        1          1
  4     1       1      1         1          1        0          1
  3     1       1      1         1          1        1          0
  1     1       1      1         0          1        1          0
  1     1       1      1         1          1        1          1
  4     1       1      1         1          0        1          1
  1     1       1      1         1          1        0          1
  1     1       1      1         1          1        0          1
  1     1       1      1         0          1        1          0
  1     1       1      1         1          0        1          1
  1     1       1      1         0          1        0          1
        0       0      0         3          6        7         11
    physhealth bmi    
924          1   1   0
  8          0   1   1
  6          1   1   1
 76          1   0   1
  1          1   1   1
  4          1   1   1
  3          0   1   2
  1          1   1   2
  1          0   0   2
  4          1   0   2
  1          0   1   2
  1          1   0   2
  1          0   1   3
  1          0   0   3
  1          0   1   3
            16  83 126</code></pre>
<p>We can also do this with <code>na.pattern</code> in the <code>Hmisc</code> package, but then we have to get the names of the columns, too, so that we can read off the values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">na.pattern</span>(smartcle_imp0)</code></pre></div>
<pre><code>pattern
000000000 000000001 000000010 000001000 000001001 000001010 000100000 
      924         4         1        76         1         4         6 
000110000 001000000 001000001 001001000 001001010 001010001 001100000 
        1         8         1         1         1         1         3 
001110000 
        1 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(smartcle_imp0)</code></pre></div>
<pre><code>[1] &quot;SEQNO&quot;      &quot;exerany&quot;    &quot;physhealth&quot; &quot;menthealth&quot; &quot;genhealth&quot; 
[6] &quot;bmi&quot;        &quot;female&quot;     &quot;internet30&quot; &quot;sleephrs&quot;  </code></pre>
</div>
<div id="use-simple-imputation-build-a-new-data-set" class="section level3">
<h3><span class="header-section-number">14.6.3</span> Use simple imputation, build a new data set</h3>
<p>The only variables that require no imputation are <code>exerany</code> and <code>female</code>. In this case, we need to impute:</p>
<ul>
<li>83 <code>bmi</code> values (which are quantitative)</li>
<li>16 <code>physhealth</code> values (quantitative, must fall between 0 and 30)</li>
<li>11 <code>menthealth</code> values (quantitative, must fall between 0 and 30)</li>
<li>7 <code>sleephrs</code> values (quantitative, must fall between 0 and 24)</li>
<li>6 <code>internet30</code> values (which are 1/0)</li>
<li>and 3 <code>genhealth</code> values (which are multi-categorical, so we need to convert them to numbers in order to get the imputation process to work properly)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smartcle_imp0 &lt;-<span class="st"> </span>smartcle_imp0 <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">genh_n =</span> <span class="kw">as.numeric</span>(genhealth))

smartcle_imp0 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(genhealth, genh_n)</code></pre></div>
<pre><code># A tibble: 6 x 3
  genhealth   genh_n     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;int&gt;
1 1_Excellent     1.   172
2 2_VeryGood      2.   350
3 3_Good          3.   344
4 4_Fair          4.   121
5 5_Poor          5.    43
6 &lt;NA&gt;           NA      3</code></pre>
<p>I’ll work from the bottom up, using various <code>simputation</code> functions to accomplish the imputations I want. In this case, I’ll use predictive mean matching for the categorical data, and linear models or elastic net approaches for the quantitative data. Be sure to set a seed beforehand so you can replicate your work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">432234</span>)

smartcle_imp1 &lt;-<span class="st"> </span>smartcle_imp0 <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_pmm</span>(genh_n <span class="op">~</span><span class="st"> </span>female) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_pmm</span>(internet30 <span class="op">~</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>genh_n) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_lm</span>(sleephrs <span class="op">~</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>genh_n) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_lm</span>(menthealth <span class="op">~</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>sleephrs) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_en</span>(physhealth <span class="op">~</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>genh_n <span class="op">+</span><span class="st"> </span>sleephrs) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">impute_en</span>(bmi <span class="op">~</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>genh_n)</code></pre></div>
<p>After the imputations are complete, I’ll back out of the numeric version of <code>genhealth</code>, called <code>genh_n</code> back to my original variable, then check to be sure I now have no missing values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smartcle_imp1 &lt;-<span class="st"> </span>smartcle_imp1 <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">genhealth =</span> <span class="kw">fct_recode</span>(<span class="kw">factor</span>(genh_n), 
                                  <span class="st">&quot;1_Excellent&quot;</span> =<span class="st"> &quot;1&quot;</span>,
                                  <span class="st">&quot;2_VeryGood&quot;</span> =<span class="st"> &quot;2&quot;</span>,
                                  <span class="st">&quot;3_Good&quot;</span> =<span class="st"> &quot;3&quot;</span>,
                                  <span class="st">&quot;4_Fair&quot;</span> =<span class="st"> &quot;4&quot;</span>,
                                  <span class="st">&quot;5_Poor&quot;</span> =<span class="st"> &quot;5&quot;</span>))

smartcle_imp1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(genhealth, genh_n)</code></pre></div>
<pre><code># A tibble: 5 x 3
  genhealth   genh_n     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;int&gt;
1 1_Excellent     1.   172
2 2_VeryGood      2.   351
3 3_Good          3.   346
4 4_Fair          4.   121
5 5_Poor          5.    43</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(<span class="kw">is.na</span>(smartcle_imp1))</code></pre></div>
<pre><code>     SEQNO    exerany physhealth menthealth  genhealth        bmi 
         0          0          0          0          0          0 
    female internet30   sleephrs     genh_n 
         0          0          0          0 </code></pre>
<p>OK. Looks good. I now have a data frame called <code>smartcle_imp1</code> with no missingness, which I can use to fit my logistic regression models. Let’s do that next, and then return to the problem of accounting for missingness through multiple imputation.</p>
</div>
</div>
<div id="refitting-model-1-with-simply-imputed-data" class="section level2">
<h2><span class="header-section-number">14.7</span> Refitting Model 1 with simply imputed data</h2>
<p>Using the numeric version of the <code>genhealth</code> data, called <code>genh_n</code>, will ease the reviewing of later output, so we’ll do that here, making sure R knows that <code>genh_n</code> describes a categorical factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">datadist</span>(smartcle_imp1)
<span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;d&quot;</span>)

m1_a &lt;-<span class="st"> </span><span class="kw">lrm</span>(exerany <span class="op">~</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">catg</span>(genh_n) <span class="op">+</span><span class="st"> </span>bmi <span class="op">*</span><span class="st"> </span>female <span class="op">+</span>
<span class="st">              </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs, 
          <span class="dt">data =</span> smartcle_imp1, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)
m1_a</code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = exerany ~ internet30 * catg(genh_n) + bmi * female + 
     physhealth + menthealth + sleephrs, data = smartcle_imp1, 
     x = TRUE, y = TRUE)
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs          1033    LR chi2     151.09    R2       0.204    C       0.741    
  0            247    d.f.            15    g        1.023    Dxy     0.482    
  1            786    Pr(&gt; chi2) &lt;0.0001    gr       2.780    gamma   0.483    
 max |deriv| 5e-14                          gp       0.175    tau-a   0.176    
                                            Brier    0.154                     
 
                       Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept              3.3390 0.9731  3.43  0.0006  
 internet30             0.6487 0.7010  0.93  0.3548  
 genh_n=2              -0.4938 0.7459 -0.66  0.5080  
 genh_n=3              -0.9270 0.6972 -1.33  0.1836  
 genh_n=4              -1.3060 0.7378 -1.77  0.0767  
 genh_n=5              -0.8093 0.8329 -0.97  0.3312  
 bmi                   -0.0412 0.0217 -1.90  0.0570  
 female                -0.9473 0.7722 -1.23  0.2199  
 physhealth            -0.0229 0.0102 -2.25  0.0246  
 menthealth            -0.0200 0.0114 -1.76  0.0784  
 sleephrs              -0.0415 0.0492 -0.84  0.3994  
 internet30 * genh_n=2  0.3701 0.8065  0.46  0.6463  
 internet30 * genh_n=3  0.1295 0.7543  0.17  0.8637  
 internet30 * genh_n=4 -0.2194 0.8108 -0.27  0.7867  
 internet30 * genh_n=5 -1.4080 0.9636 -1.46  0.1440  
 bmi * female           0.0118 0.0261  0.45  0.6497  
 </code></pre>
<p>All right. We’ve used 1033 observations, which is correct (after deleting the three with missing <code>exerany</code>.) The model shows a Nagelkerke R<sup>2</sup> value of 0.204, and a C statistic of 0.741 after imputation. The likelihood ratio (drop in deviance) test is highly significant.</p>
<div id="validating-summary-statistics" class="section level3">
<h3><span class="header-section-number">14.7.1</span> Validating Summary Statistics</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">432099</span>)
<span class="kw">validate</span>(m1_a)</code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.4823   0.5012 0.4632   0.0380          0.4444 40
R2            0.2039   0.2218 0.1878   0.0340          0.1699 40
Intercept     0.0000   0.0000 0.0936  -0.0936          0.0936 40
Slope         1.0000   1.0000 0.9001   0.0999          0.9001 40
Emax          0.0000   0.0000 0.0401   0.0401          0.0401 40
D             0.1453   0.1592 0.1329   0.0264          0.1189 40
U            -0.0019  -0.0019 0.0013  -0.0032          0.0013 40
Q             0.1472   0.1612 0.1316   0.0295          0.1177 40
B             0.1539   0.1507 0.1566  -0.0058          0.1597 40
g             1.0226   1.0868 0.9722   0.1146          0.9080 40
gp            0.1751   0.1818 0.1673   0.0145          0.1606 40</code></pre>
<p>It appears that the model’s description of summary statistics is a little optimistic for both the C statistic (remember that C = 0.5 + Dxy/2) and the Nagelkerke R<sup>2</sup>. This output suggests that in a new sample of data, our model might be better expected to show a C statistic near …</p>
<p><span class="math display">\[ 
C = 0.5 + \frac{Dxy}{2} = 0.5 + \frac{0.4444}{2} = 0.7222
\]</span></p>
<p>rather than the 0.741 we saw initially, and that the Nagelkerke R<sup>2</sup> in new data will be closer to 0.17, than to the nominal 0.204 we saw above. So, as we walk through some other output for this model, remember that the C statistic wasn’t great here (0.72 after validation), so our ability to discriminate exercisers from non-exercisers is still a problem.</p>
</div>
<div id="anova-for-the-model" class="section level3">
<h3><span class="header-section-number">14.7.2</span> ANOVA for the model</h3>
<p>Next, let’s look at the ANOVA comparisons for this model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m1_a)</code></pre></div>
<pre><code>                Wald Statistics          Response: exerany 

 Factor                                             Chi-Square d.f. P     
 internet30  (Factor+Higher Order Factors)           17.28      5   0.0040
  All Interactions                                    5.84      4   0.2116
 genh_n  (Factor+Higher Order Factors)               35.81      8   &lt;.0001
  All Interactions                                    5.84      4   0.2116
 bmi  (Factor+Higher Order Factors)                   7.36      2   0.0252
  All Interactions                                    0.21      1   0.6497
 female  (Factor+Higher Order Factors)               12.72      2   0.0017
  All Interactions                                    0.21      1   0.6497
 physhealth                                           5.05      1   0.0246
 menthealth                                           3.10      1   0.0784
 sleephrs                                             0.71      1   0.3994
 internet30 * genh_n  (Factor+Higher Order Factors)   5.84      4   0.2116
 bmi * female  (Factor+Higher Order Factors)          0.21      1   0.6497
 TOTAL INTERACTION                                    6.15      5   0.2917
 TOTAL                                              126.95     15   &lt;.0001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m1_a))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<p>It looks like several of the variables (<code>genhealth</code>, <code>internet30</code>, <code>female</code>, <code>bmi</code> and <code>physhealth</code>) are carrying statistically significant predictive value here.</p>
<p>We can also build a plot of the AIC values attributable to each piece of the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m1_a), <span class="dt">what=</span><span class="st">&quot;aic&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
<div id="summarizing-effect-size" class="section level3">
<h3><span class="header-section-number">14.7.3</span> Summarizing Effect Size</h3>
<p>How big are the effects we see?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">summary</span>(m1_a))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-238-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m1_a)</code></pre></div>
<pre><code>             Effects              Response : exerany 

 Factor       Low  High  Diff. Effect    S.E.     Lower 0.95 Upper 0.95
 internet30    0.0  1.00 1.00   1.018800 0.400350  0.234160   1.8035000
  Odds Ratio   0.0  1.00 1.00   2.770000       NA  1.263800   6.0710000
 bmi          23.9 30.31 6.41  -0.264180 0.138810 -0.536240   0.0078783
  Odds Ratio  23.9 30.31 6.41   0.767840       NA  0.584950   1.0079000
 female        0.0  1.00 1.00  -0.627270 0.177840 -0.975830  -0.2787200
  Odds Ratio   0.0  1.00 1.00   0.534050       NA  0.376880   0.7567500
 physhealth    0.0  2.00 2.00  -0.045843 0.020393 -0.085813  -0.0058727
  Odds Ratio   0.0  2.00 2.00   0.955190       NA  0.917770   0.9941400
 menthealth    0.0  2.00 2.00  -0.040089 0.022778 -0.084733   0.0045549
  Odds Ratio   0.0  2.00 2.00   0.960700       NA  0.918760   1.0046000
 sleephrs      6.0  8.00 2.00  -0.082947 0.098439 -0.275880   0.1099900
  Odds Ratio   6.0  8.00 2.00   0.920400       NA  0.758900   1.1163000
 genh_n - 1:2  2.0  1.00   NA   0.493760 0.745930 -0.968240   1.9558000
  Odds Ratio   2.0  1.00   NA   1.638500       NA  0.379750   7.0693000
 genh_n - 3:2  2.0  3.00   NA  -0.433290 0.431840 -1.279700   0.4131100
  Odds Ratio   2.0  3.00   NA   0.648370       NA  0.278120   1.5115000
 genh_n - 4:2  2.0  4.00   NA  -0.812200 0.490270 -1.773100   0.1487200
  Odds Ratio   2.0  4.00   NA   0.443880       NA  0.169800   1.1603000
 genh_n - 5:2  2.0  5.00   NA  -0.315510 0.620110 -1.530900   0.8998700
  Odds Ratio   2.0  5.00   NA   0.729420       NA  0.216340   2.4593000

Adjusted to: internet30=0 genh_n=2 bmi=27.03416 female=0  </code></pre>
<p>This output is easier to read as a result of using small <em>numeric</em> labels in <code>genh_n</code>, rather than the lengthy labels in <code>genhealth</code>. The sensible things to interpret are the odds ratios.</p>
<ul>
<li>holding all other predictors constant, the effect of moving from <code>internet30</code> = 0 to <code>internet30</code> = 1 is that the odds of <code>exerany</code> increase by a factor of 2.77.
<ul>
<li>Suppose Harry and Steve have the same values of all predictors in this model except that Harry used the internet and Steve did not.</li>
<li>So the odds of exercising for Harry (who used the internet) are 2.77 times higher than the odds of exercising for Steve (who didn’t use the internet), assuming that all other predictors are the same.</li>
<li>We also have a 95% confidence interval for this odds ratio, which is (1.26, 6.07). Since 1 is not in that interval, the data don’t seem to be consistent with <code>internet30</code> having no effect on <code>exerany</code>.</li>
</ul></li>
<li>the odds ratio comparing two subjects with the same predictors except that Harry has a BMI of 30.31 (the 75th percentile of observed BMIs in our sample) and Marty has a BMI of 23.9 (the 25th percentile) is that Harry has 0.767 times the odds of exercising that Marty does. So Harry’s probability of exercise will also be lower than Marty’s.
<ul>
<li>The 95% confidence interval in this case is (0.58, 1.01), and because 1 is in that interval, we cannot conclude that the effect of <code>bmi</code> meets the standard for statistical significance at the 5% level.</li>
</ul></li>
<li>A similar approach can be used to describe the odds ratios associated with each predictor.</li>
<li>Note that each of the categories in <code>genh_n</code> is compared to a single baseline category. Here, that’s category 2. R will pick the modal category: the one that appears most often in the data. The comparisons of each category against category 2 are not significant in each case, at the 5% level.</li>
</ul>
</div>
<div id="plotting-the-model-with-ggplot-and-predict" class="section level3">
<h3><span class="header-section-number">14.7.4</span> Plotting the Model with <code>ggplot</code> and <code>Predict</code></h3>
<p>Let’s look at a series of plots describing the model on the probability scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">Predict</span>(m1_a, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
<p>This helps us describe what is happening in terms of direction at least. For example,</p>
<ul>
<li>As <code>bmi</code> increases, predicted Pr(<code>exerany</code>) decreases.</li>
<li>People who accessed the internet in the past 30 days have higher model probabilities of exercising.</li>
</ul>
<p>Do any of these plots fail to make sense to you? Is anything moving in a surprising direction?</p>
</div>
<div id="plotting-the-model-with-a-nomogram" class="section level3">
<h3><span class="header-section-number">14.7.5</span> Plotting the model with a nomogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">nomogram</span>(m1_a, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-240-1.png" width="672" /></p>
<p>Note the impact of our interaction terms, and how we have two lines for <code>bmi</code> and five lines for <code>internet30</code> that come out of our product terms. As with any nomogram, to make a prediction we:</p>
<ol style="list-style-type: decimal">
<li>find the values of each of our predictors in the scales, and travel vertically up to the Points line to read off the Points for that predictor.</li>
<li>sum up the Points across all predictors, and find that location in the Total Points line.</li>
<li>move vertically down from the total points line to find the estimated “linear predictor” (log odds ratio) and finally the “predicted value” (probability of our outcome <code>exerany</code> = 1.)</li>
</ol>
</div>
<div id="checking-the-goodness-of-fit-of-our-model" class="section level3">
<h3><span class="header-section-number">14.7.6</span> Checking the Goodness of Fit of our model</h3>
<p>To test the goodness of fit, we can use the following omnibus test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">residuals</span>(m1_a, <span class="dt">type =</span> <span class="st">&quot;gof&quot;</span>),<span class="dv">3</span>)</code></pre></div>
<pre><code>Sum of squared errors     Expected value|H0                    SD 
              158.955               158.740                 0.525 
                    Z                     P 
                0.408                 0.683 </code></pre>
<p>Our non-significant <em>p</em> value suggests that we cannot detect anything that’s obviously wrong in the model in terms of goodness of fit. That’s comforting.</p>
</div>
</div>
<div id="refitting-model-2-with-simply-imputed-data" class="section level2">
<h2><span class="header-section-number">14.8</span> Refitting Model 2 with simply imputed data</h2>
<p>I’ll walk through the same tasks for Model <code>m2</code> that I did above for Model <code>m1</code>. Again, we’re running this model after simple imputation of missing values.</p>
<p>Using the numeric version of the <code>genhealth</code> data, called <code>genh_n</code>, will ease the reviewing of later output, so we’ll do that here, making sure R knows that <code>genh_n</code> describes a categorical factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">datadist</span>(smartcle_imp1)
<span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;d&quot;</span>)

m2_a &lt;-<span class="st"> </span><span class="kw">lrm</span>(exerany <span class="op">~</span><span class="st"> </span><span class="kw">rcs</span>(bmi, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rcs</span>(physhealth, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>female <span class="op">+</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">catg</span>(genh_n) <span class="op">+</span><span class="st"> </span>
<span class="st">              </span><span class="kw">catg</span>(genh_n) <span class="op">%ia%</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>female <span class="op">%ia%</span><span class="st"> </span>bmi <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs, 
          <span class="dt">data =</span> smartcle_imp1, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)
m2_a</code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = exerany ~ rcs(bmi, 4) + rcs(physhealth, 5) + female + 
     internet30 * catg(genh_n) + catg(genh_n) %ia% physhealth + 
     female %ia% bmi + menthealth + sleephrs, data = smartcle_imp1, 
     x = TRUE, y = TRUE)
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs          1033    LR chi2     159.51    R2       0.214    C       0.744    
  0            247    d.f.            22    g        1.051    Dxy     0.487    
  1            786    Pr(&gt; chi2) &lt;0.0001    gr       2.860    gamma   0.487    
 max |deriv| 5e-12                          gp       0.179    tau-a   0.177    
                                            Brier    0.152                     
 
                       Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept              2.7525 1.9074  1.44  0.1490  
 bmi                   -0.0072 0.0763 -0.09  0.9250  
 bmi&#39;                  -0.2772 0.3288 -0.84  0.3992  
 bmi&#39;&#39;                  0.9199 0.9873  0.93  0.3515  
 physhealth             0.0287 0.0905  0.32  0.7514  
 physhealth&#39;           -0.1396 0.3555 -0.39  0.6946  
 female                -0.9550 0.8017 -1.19  0.2336  
 internet30             0.6099 0.7040  0.87  0.3863  
 genh_n=2              -0.5059 0.7507 -0.67  0.5004  
 genh_n=3              -0.8611 0.7053 -1.22  0.2221  
 genh_n=4              -1.1827 0.7535 -1.57  0.1165  
 genh_n=5              -2.6842 1.1987 -2.24  0.0251  
 genh_n=2 * physhealth -0.0253 0.0864 -0.29  0.7698  
 genh_n=3 * physhealth -0.0475 0.0842 -0.56  0.5723  
 genh_n=4 * physhealth -0.0471 0.0842 -0.56  0.5758  
 genh_n=5 * physhealth  0.0497 0.0917  0.54  0.5879  
 female * bmi           0.0111 0.0268  0.41  0.6803  
 menthealth            -0.0200 0.0116 -1.72  0.0859  
 sleephrs              -0.0536 0.0503 -1.07  0.2868  
 internet30 * genh_n=2  0.4193 0.8091  0.52  0.6043  
 internet30 * genh_n=3  0.1624 0.7592  0.21  0.8306  
 internet30 * genh_n=4 -0.1802 0.8176 -0.22  0.8255  
 internet30 * genh_n=5 -1.6615 0.9820 -1.69  0.0907  
 </code></pre>
<p>All right. We’ve again used 1033 observations, which is correct (after deleting the three with missing <code>exerany</code>. The model shows a Nagelkerke R<sup>2</sup> value of 0.214, and a C statistic of 0.744 after imputation. Each of these results are a little better than what we saw with <code>m1_a</code> but only a little. The likelihood ratio (drop in deviance) test is still highly significant.</p>
<div id="validating-summary-statistics-1" class="section level3">
<h3><span class="header-section-number">14.8.1</span> Validating Summary Statistics</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">432009</span>)
<span class="kw">validate</span>(m2_a)</code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.4870   0.5058 0.4590   0.0468          0.4402 40
R2            0.2145   0.2340 0.1849   0.0491          0.1654 40
Intercept     0.0000   0.0000 0.1729  -0.1729          0.1729 40
Slope         1.0000   1.0000 0.8473   0.1527          0.8473 40
Emax          0.0000   0.0000 0.0692   0.0692          0.0692 40
D             0.1534   0.1695 0.1307   0.0387          0.1147 40
U            -0.0019  -0.0019 0.0041  -0.0060          0.0041 40
Q             0.1554   0.1714 0.1266   0.0448          0.1106 40
B             0.1521   0.1502 0.1567  -0.0065          0.1585 40
g             1.0507   1.1335 0.9626   0.1708          0.8799 40
gp            0.1786   0.1866 0.1642   0.0224          0.1562 40</code></pre>
<p>Again, the model’s description of summary statistics is a little optimistic for both the C statistic and the Nagelkerke R<sup>2</sup>. In a new sample of data, model <code>m2_a</code> might be better expected to show a C statistic near …</p>
<p><span class="math display">\[ 
C = 0.5 + \frac{Dxy}{2} = 0.5 + \frac{0.4402}{2} = 0.7201
\]</span></p>
<p>rather than the 0.744 we saw initially, and that the Nagelkerke R<sup>2</sup> in new data will be closer to 0.165, than to the nominal 0.215 we saw above. So, after validation, this model actually looks worse than model <code>m1_a</code>.</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">nominal C</th>
<th align="right">nominal R<sup>2</sup></th>
<th align="right">validated C</th>
<th align="right">validated R<sup>2</sup></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>m1_a</code></td>
<td align="right">0.741</td>
<td align="right">0.204</td>
<td align="right">0.722</td>
<td align="right">0.170</td>
</tr>
<tr class="even">
<td align="right"><code>m2_a</code></td>
<td align="right">0.744</td>
<td align="right">0.214</td>
<td align="right">0.720</td>
<td align="right">0.165</td>
</tr>
</tbody>
</table>
<p>Again, as we walk through other output for model <code>m2_a</code>, remember that the our ability to discriminate exercisers from non-exercisers is still very much in question using either model.</p>
</div>
<div id="anova-for-the-model-1" class="section level3">
<h3><span class="header-section-number">14.8.2</span> ANOVA for the model</h3>
<p>Next, let’s look at the ANOVA comparisons for this model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m2_a)</code></pre></div>
<pre><code>                Wald Statistics          Response: exerany 

 Factor                                             Chi-Square d.f. P     
 bmi  (Factor+Higher Order Factors)                   9.39      4   0.0521
  All Interactions                                    0.17      1   0.6803
  Nonlinear                                           1.46      2   0.4831
 physhealth  (Factor+Higher Order Factors)           11.74      6   0.0680
  All Interactions                                    6.33      4   0.1760
  Nonlinear                                           0.15      1   0.6946
 female  (Factor+Higher Order Factors)               13.25      2   0.0013
  All Interactions                                    0.17      1   0.6803
 internet30  (Factor+Higher Order Factors)           18.03      5   0.0029
  All Interactions                                    7.49      4   0.1121
 genh_n  (Factor+Higher Order Factors)               39.00     12   0.0001
  All Interactions                                   11.80      8   0.1604
 genh_n * physhealth  (Factor+Higher Order Factors)   6.33      4   0.1760
 female * bmi  (Factor+Higher Order Factors)          0.17      1   0.6803
 menthealth                                           2.95      1   0.0859
 sleephrs                                             1.13      1   0.2868
 internet30 * genh_n  (Factor+Higher Order Factors)   7.49      4   0.1121
 TOTAL NONLINEAR                                      1.65      3   0.6474
 TOTAL INTERACTION                                   12.10      9   0.2075
 TOTAL NONLINEAR + INTERACTION                       13.40     12   0.3409
 TOTAL                                              131.03     22   &lt;.0001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m2_a))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-244-1.png" width="672" /></p>
<p>Here, it looks like just three of the variables (<code>genhealth</code>, <code>internet30</code>, and <code>female</code>) are carrying statistically significant predictive value.</p>
<p>Here is the AIC plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">anova</span>(m2_a), <span class="dt">what=</span><span class="st">&quot;aic&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
</div>
<div id="summarizing-effect-size-1" class="section level3">
<h3><span class="header-section-number">14.8.3</span> Summarizing Effect Size</h3>
<p>How big are the effects we see?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">summary</span>(m2_a))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-246-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m2_a)</code></pre></div>
<pre><code>             Effects              Response : exerany 

 Factor       Low  High  Diff. Effect     S.E.     Lower 0.95 Upper 0.95
 bmi          23.9 30.31 6.41  -0.4797500 0.221460 -0.913810  -0.045691 
  Odds Ratio  23.9 30.31 6.41   0.6189400       NA  0.400990   0.955340 
 physhealth    0.0  2.00 2.00   0.0055399 0.095955 -0.182530   0.193610 
  Odds Ratio   0.0  2.00 2.00   1.0056000       NA  0.833160   1.213600 
 female        0.0  1.00 1.00  -0.6558700 0.183810 -1.016100  -0.295600 
  Odds Ratio   0.0  1.00 1.00   0.5189900       NA  0.361990   0.744080 
 internet30    0.0  1.00 1.00   1.0291000 0.401140  0.242910   1.815300 
  Odds Ratio   0.0  1.00 1.00   2.7986000       NA  1.275000   6.143200 
 menthealth    0.0  2.00 2.00  -0.0399460 0.023258 -0.085530   0.005638 
  Odds Ratio   0.0  2.00 2.00   0.9608400       NA  0.918030   1.005700 
 sleephrs      6.0  8.00 2.00  -0.1072500 0.100690 -0.304600   0.090096 
  Odds Ratio   6.0  8.00 2.00   0.8983000       NA  0.737420   1.094300 
 genh_n - 1:2  2.0  1.00   NA   0.5059000 0.750690 -0.965430   1.977200 
  Odds Ratio   2.0  1.00   NA   1.6585000       NA  0.380820   7.222700 
 genh_n - 3:2  2.0  3.00   NA  -0.3552100 0.447130 -1.231600   0.521140 
  Odds Ratio   2.0  3.00   NA   0.7010200       NA  0.291830   1.684000 
 genh_n - 4:2  2.0  4.00   NA  -0.6768400 0.517450 -1.691000   0.337350 
  Odds Ratio   2.0  4.00   NA   0.5082200       NA  0.184330   1.401200 
 genh_n - 5:2  2.0  5.00   NA  -2.1783000 1.066000 -4.267700  -0.089045 
  Odds Ratio   2.0  5.00   NA   0.1132300       NA  0.014015   0.914800 

Adjusted to: bmi=27.03416 physhealth=0 female=0 internet30=0 genh_n=2  </code></pre>
<p>This output is easier to read as a result of using small <em>numeric</em> labels in <code>genh_n</code>, rather than the lengthy labels in <code>genhealth</code>. The sensible things to interpret are the odds ratios. For example,</p>
<ul>
<li>holding all other predictors constant, the effect of moving from <code>internet30</code> = 0 to <code>internet30</code> = 1 is that the odds of <code>exerany</code> increase by a factor of 2.80.</li>
<li>the odds ratio comparing two subjects with the same predictors except that Harry has a BMI of 30.31 (the 75th percentile of observed BMIs in our sample) and Marty has a BMI of 23.9 (the 25th percentile) is that Harry has 0.619 times the odds of exercising that Marty does. So Harry’s probability of exercise will also be lower.</li>
</ul>
<p>By sex, which group has a larger probability of <code>exerany</code>, holding all other predictors constant, by this model? Females or Males?</p>
</div>
<div id="plotting-the-model-with-ggplot-and-predict-1" class="section level3">
<h3><span class="header-section-number">14.8.4</span> Plotting the Model with <code>ggplot</code> and <code>Predict</code></h3>
<p>Again, consider a series of plots describing the model <code>m2_a</code> on the probability scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">Predict</span>(m2_a, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
<p>Note the small <code>kink</code> in the <code>bmi</code> plot. To what do you attribute this?</p>
</div>
<div id="plotting-the-model-with-a-nomogram-1" class="section level3">
<h3><span class="header-section-number">14.8.5</span> Plotting the model with a nomogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">nomogram</span>(m2_a, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<p>Note the impact of our interaction terms, <strong>and</strong> the cubic splines in <code>bmi</code> and <code>physhealth</code>. As with any nomogram, to make a prediction we:</p>
<ol style="list-style-type: decimal">
<li>find the values of each of our predictors in the scales, and travel vertically up to the Points line to read off the Points for that predictor.</li>
<li>sum up the Points across all predictors, and find that location in the Total Points line.</li>
<li>move vertically down from the total points line to find the estimated “linear predictor” (log odds ratio) and finally the “predicted value” (probability of our outcome <code>exerany</code> = 1.)</li>
</ol>
</div>
<div id="checking-the-goodness-of-fit-of-our-model-1" class="section level3">
<h3><span class="header-section-number">14.8.6</span> Checking the Goodness of Fit of our model</h3>
<p>To test the goodness of fit, we can use the following omnibus test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">residuals</span>(m2_a, <span class="dt">type =</span> <span class="st">&quot;gof&quot;</span>),<span class="dv">3</span>)</code></pre></div>
<pre><code>Sum of squared errors     Expected value|H0                    SD 
              157.102               157.011                 0.522 
                    Z                     P 
                0.174                 0.862 </code></pre>
<p>Our non-significant <em>p</em> value suggests that we cannot detect anything that’s obviously wrong in the model in terms of goodness of fit.</p>
</div>
</div>
<div id="comparing-model-2-to-model-1-after-simple-imputation" class="section level2">
<h2><span class="header-section-number">14.9</span> Comparing Model 2 to Model 1 after simple imputation</h2>
<p>We can refit the models with <code>glm</code> and then compare them with <code>anova</code>, <code>aic</code> and <code>bic</code> approaches, if we like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_a_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(exerany <span class="op">~</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">factor</span>(genh_n) <span class="op">+</span><span class="st"> </span>
<span class="st">                    </span>bmi <span class="op">*</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span>
<span class="st">                    </span>sleephrs, 
                <span class="dt">data =</span> smartcle_imp1, 
                <span class="dt">family =</span> binomial)

m2_a_glm &lt;-<span class="st"> </span><span class="kw">glm</span>(exerany <span class="op">~</span><span class="st"> </span><span class="kw">rcs</span>(bmi, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rcs</span>(physhealth, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>female <span class="op">+</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">factor</span>(genh_n) <span class="op">+</span><span class="st"> </span>
<span class="st">              </span><span class="kw">factor</span>(genh_n) <span class="op">%ia%</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>female <span class="op">%ia%</span><span class="st"> </span>bmi <span class="op">+</span><span class="st"> </span>
<span class="st">              </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs, 
          <span class="dt">data =</span> smartcle_imp1,
          <span class="dt">family =</span> binomial)</code></pre></div>
<div id="comparison-by-analysis-of-deviance" class="section level3">
<h3><span class="header-section-number">14.9.1</span> Comparison by Analysis of Deviance</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m1_a_glm, m2_a_glm)</code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: exerany ~ internet30 * factor(genh_n) + bmi * female + physhealth + 
    menthealth + sleephrs
Model 2: exerany ~ rcs(bmi, 4) + rcs(physhealth, 5) + female + internet30 * 
    factor(genh_n) + factor(genh_n) %ia% physhealth + female %ia% 
    bmi + menthealth + sleephrs
  Resid. Df Resid. Dev Df Deviance
1      1017     985.32            
2      1010     976.89  7   8.4245</code></pre>
<p>To obtain a <em>p</em> value, we can compare this drop in deviance to a <span class="math inline">\(\chi^2\)</span> distribution with 7 df, as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pchisq</span>(<span class="fl">8.4245</span>, <span class="dv">7</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>[1] 0.2966531</code></pre>
<p>So there’s no statistically significant advantage apparent from fitting the larger <code>m2_a</code> model.</p>
</div>
<div id="comparing-aic-and-bic" class="section level3">
<h3><span class="header-section-number">14.9.2</span> Comparing AIC and BIC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(m1_a_glm)</code></pre></div>
<pre><code>  null.deviance df.null    logLik      AIC      BIC deviance df.residual
1      1136.406    1032 -492.6596 1017.319 1096.363 985.3192        1017</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(m2_a_glm)</code></pre></div>
<pre><code>  null.deviance df.null    logLik      AIC     BIC deviance df.residual
1      1136.406    1032 -488.4473 1022.895 1136.52 976.8946        1010</code></pre>
<p>Model <code>m1_a_glm</code> shows lower AIC and BIC than does <code>m2_a_glm</code>, again suggesting no meaningful advantage for the larger model.</p>
</div>
</div>
<div id="dealing-with-missing-data-via-multiple-imputation" class="section level2">
<h2><span class="header-section-number">14.10</span> Dealing with Missing Data via Multiple Imputation</h2>
<p>Next, we’ll use the <code>aregImpute</code> function within the <code>Hmisc</code> package to predict all missing values for all of our variables, using additive regression bootstrapping and predictive mean matching. The steps for this work are as follows:</p>
<ol style="list-style-type: decimal">
<li><code>aregImpute</code> draws a sample with replacement from the observations where the target variable is observed, not missing.</li>
<li><code>aregImpute</code> then fits a flexible additive model to predict this target variable while finding the optimum transformation of it.</li>
<li><code>aregImpute</code> then uses this fitted flexible model to predict the target variable in all of the original observations.</li>
<li>Finally, <code>aregImpute</code> imputes each missing value of the target variable with the observed value whose predicted transformed value is closest to the predicted transformed value of the missing value.</li>
</ol>
<p>We’ll start with the <code>smartcle_imp0</code> data set, which contains only the subjects in the original <code>smartcle1</code> data where <code>exerany</code> is available, and which includes only the variables of interest to us, including both the factor (<code>genhealth</code>) and numeric (<code>genh_n</code>) versions of the genhealth data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(smartcle_imp0)</code></pre></div>
<pre><code>     SEQNO              exerany         physhealth       menthealth    
 Min.   :2.016e+09   Min.   :0.0000   Min.   : 0.000   Min.   : 0.000  
 1st Qu.:2.016e+09   1st Qu.:1.0000   1st Qu.: 0.000   1st Qu.: 0.000  
 Median :2.016e+09   Median :1.0000   Median : 0.000   Median : 0.000  
 Mean   :2.016e+09   Mean   :0.7609   Mean   : 3.949   Mean   : 2.701  
 3rd Qu.:2.016e+09   3rd Qu.:1.0000   3rd Qu.: 2.000   3rd Qu.: 2.000  
 Max.   :2.016e+09   Max.   :1.0000   Max.   :30.000   Max.   :30.000  
                                      NA&#39;s   :16       NA&#39;s   :11      
       genhealth        bmi            female         internet30    
 1_Excellent:172   Min.   :12.71   Min.   :0.0000   Min.   :0.0000  
 2_VeryGood :350   1st Qu.:23.70   1st Qu.:0.0000   1st Qu.:1.0000  
 3_Good     :344   Median :26.68   Median :1.0000   Median :1.0000  
 4_Fair     :121   Mean   :27.85   Mean   :0.6012   Mean   :0.8101  
 5_Poor     : 43   3rd Qu.:30.53   3rd Qu.:1.0000   3rd Qu.:1.0000  
 NA&#39;s       :  3   Max.   :66.06   Max.   :1.0000   Max.   :1.0000  
                   NA&#39;s   :83                       NA&#39;s   :6       
    sleephrs          genh_n     
 Min.   : 1.000   Min.   :1.000  
 1st Qu.: 6.000   1st Qu.:2.000  
 Median : 7.000   Median :2.000  
 Mean   : 7.022   Mean   :2.527  
 3rd Qu.: 8.000   3rd Qu.:3.000  
 Max.   :20.000   Max.   :5.000  
 NA&#39;s   :7        NA&#39;s   :3      </code></pre>
<p>The <code>smartcle_imp0</code> data set contains 1033 rows (subjects) and 10 columns (variables.)</p>
<div id="using-aregimpute-to-fit-a-multiple-imputation-model" class="section level3">
<h3><span class="header-section-number">14.10.1</span> Using <code>aregImpute</code> to fit a multiple imputation model</h3>
<p>To set up <code>aregImpute</code> here, we’ll need to specify:</p>
<ul>
<li>a suitable random seed with <code>set.seed</code> so we can replicate our work later</li>
<li>a data set via the <code>datadist</code> stuff shown below</li>
<li>the variables we want to include in the imputation process, which should include, at a minimum, any variables with missing values, and any variables we want to include in our outcome models</li>
<li><code>n.impute</code> = number of imputations, we’ll run 20 here<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a></li>
<li><code>nk</code> = number of knots to describe level of complexity, with our choice <code>nk = c(0, 3)</code> we’ll fit both linear models and models with restricted cubic splines with 3 knots (this approach will wind up throwing some warnings here because some of our variables with missing values have only a few options so fitting splines is tough.)</li>
<li><code>tlinear = FALSE</code> allows the target variable for imputation to have a non-linear transformation when <code>nk</code> is 3 or more. Here, I’ll use <code>tlinear = TRUE</code>, the default.</li>
<li><code>B = 10</code> specifies 10 bootstrap samples will be used</li>
<li><code>pr = FALSE</code> tells the machine not to print out which iteration is running as it goes.</li>
<li><code>data</code> specifies the source of the variables</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">432074</span>)
dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(smartcle_imp0)
<span class="kw">options</span>(<span class="dt">datadist =</span> <span class="st">&quot;dd&quot;</span>)

imp_fit &lt;-<span class="st"> </span><span class="kw">aregImpute</span>(<span class="op">~</span><span class="st"> </span>exerany <span class="op">+</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span>
<span class="st">                          </span>genh_n <span class="op">+</span><span class="st"> </span>bmi <span class="op">+</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>internet30 <span class="op">+</span><span class="st"> </span>sleephrs, 
                   <span class="dt">nk =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">tlinear =</span> <span class="ot">TRUE</span>,
                   <span class="dt">data =</span> smartcle_imp0, <span class="dt">B =</span> <span class="dv">10</span>, 
                   <span class="dt">n.impute =</span> <span class="dv">20</span>, <span class="dt">pr =</span> <span class="ot">FALSE</span>) </code></pre></div>
<p>OK. Here is the imputation model. The summary here isn’t especially critical. We want to see what was run, but to see what the results look like, we’ll need a plot, to come.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imp_fit</code></pre></div>
<pre><code>
Multiple Imputation using Bootstrap and PMM

aregImpute(formula = ~exerany + physhealth + menthealth + genh_n + 
    bmi + female + internet30 + sleephrs, data = smartcle_imp0, 
    n.impute = 20, nk = c(0, 3), tlinear = TRUE, pr = FALSE, 
    B = 10)

n: 1033     p: 8    Imputations: 20     nk: 0 

Number of NAs:
   exerany physhealth menthealth     genh_n        bmi     female 
         0         16         11          3         83          0 
internet30   sleephrs 
         6          7 

           type d.f.
exerany       l    1
physhealth    s    1
menthealth    s    1
genh_n        s    1
bmi           s    1
female        l    1
internet30    l    1
sleephrs      s    1

Transformation of Target Variables Forced to be Linear

R-squares for Predicting Non-Missing Values for Each Variable
Using Last Imputations of Predictors
physhealth menthealth     genh_n        bmi internet30   sleephrs 
     0.336      0.107      0.304      0.127      0.111      0.056 

Resampling results for determining the complexity of imputation models

Variable being imputed: physhealth 
                                         nk=0  nk=3
Bootstrap bias-corrected R^2            0.289 0.399
10-fold cross-validated  R^2            0.288 0.381
Bootstrap bias-corrected mean   |error| 4.911 4.014
10-fold cross-validated  mean   |error| 4.253 4.091
Bootstrap bias-corrected median |error| 3.261 1.784
10-fold cross-validated  median |error| 0.896 0.666

Variable being imputed: menthealth 
                                         nk=0  nk=3
Bootstrap bias-corrected R^2            0.103 0.116
10-fold cross-validated  R^2            0.110 0.128
Bootstrap bias-corrected mean   |error| 3.660 3.651
10-fold cross-validated  mean   |error| 3.018 3.075
Bootstrap bias-corrected median |error| 1.957 1.780
10-fold cross-validated  median |error| 0.715 0.786

Variable being imputed: genh_n 
                                         nk=0  nk=3
Bootstrap bias-corrected R^2            0.323 0.319
10-fold cross-validated  R^2            0.324 0.323
Bootstrap bias-corrected mean   |error| 0.690 0.691
10-fold cross-validated  mean   |error| 2.537 2.538
Bootstrap bias-corrected median |error| 0.644 0.648
10-fold cross-validated  median |error| 2.555 2.571

Variable being imputed: bmi 
                                           nk=0    nk=3
Bootstrap bias-corrected R^2             0.0715  0.0919
10-fold cross-validated  R^2             0.0825  0.0892
Bootstrap bias-corrected mean   |error|  4.5861  4.5264
10-fold cross-validated  mean   |error| 27.8377 27.8712
Bootstrap bias-corrected median |error|  3.5091  3.5217
10-fold cross-validated  median |error| 26.8401 26.7857

Variable being imputed: internet30 
                                          nk=0   nk=3
Bootstrap bias-corrected R^2            0.0843 0.0760
10-fold cross-validated  R^2            0.1016 0.0825
Bootstrap bias-corrected mean   |error| 0.2798 0.2857
10-fold cross-validated  mean   |error| 0.9636 0.9594
Bootstrap bias-corrected median |error| 0.1883 0.1819
10-fold cross-validated  median |error| 0.7757 0.7467

Variable being imputed: sleephrs 
                                          nk=0    nk=3
Bootstrap bias-corrected R^2            0.0075 -0.0072
10-fold cross-validated  R^2            0.0330  0.0149
Bootstrap bias-corrected mean   |error| 1.0102  1.0506
10-fold cross-validated  mean   |error| 7.0313  7.0163
Bootstrap bias-corrected median |error| 0.9287  0.9000
10-fold cross-validated  median |error| 7.0066  6.9739</code></pre>
<p>OK, let’s plot these imputed values. Note that we had six predictors with missing values in our data set, and so if we plot each of those, we’ll wind up with six plots. I’ll arrange them in a grid with three rows and two columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(imp_fit)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-257-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<p>From these cumulative distribution functions, we can see that, for example,</p>
<ul>
<li>we imputed <code>bmi</code> values mostly between 20 and 35, with a few values below 20 or above 40.</li>
<li>most of our imputed <code>sleephrs</code> were between 5 and 10</li>
<li>we imputed 1 for <code>internet30</code> for about 70% of the subjects, and 0 for the other 30%.</li>
</ul>
<p>This predictive mean matching method never imputes a value for a variable that does not already exist in the data.</p>
</div>
</div>
<div id="combining-the-imputation-and-outcome-models" class="section level2">
<h2><span class="header-section-number">14.11</span> Combining the Imputation and Outcome Models</h2>
<p>So, now we have an imputation model, called <code>imp_fit</code>. and two outcome models: <code>m1</code> and <code>m2</code>. What do we do with them?</p>
<div id="model-1-with-multiple-imputation" class="section level3">
<h3><span class="header-section-number">14.11.1</span> Model 1 with Multiple Imputation</h3>
<p>To build the <code>m1_imp</code> multiple imputation fit for model <code>m1</code>, we use the <code>fit.mult.impute</code> command, and specify the model, the fitter (here, <code>lrm</code>), the imputation model (<code>xtrans = imp_fit</code>) and the data set prior to imputation (<code>smartcle_imp0</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_imp &lt;-<span class="st"> </span><span class="kw">fit.mult.impute</span>(exerany <span class="op">~</span><span class="st"> </span>
<span class="st">            </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">catg</span>(genh_n) <span class="op">+</span><span class="st"> </span>bmi <span class="op">*</span><span class="st"> </span>female <span class="op">+</span>
<span class="st">            </span>physhealth <span class="op">+</span><span class="st"> </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs,
            <span class="dt">fitter =</span> lrm, <span class="dt">xtrans =</span> imp_fit,
            <span class="dt">data =</span> smartcle_imp0, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>
Variance Inflation Factors Due to Imputation:

            Intercept            internet30              genh_n=2 
                 1.03                  1.00                  1.01 
             genh_n=3              genh_n=4              genh_n=5 
                 1.00                  1.01                  1.02 
                  bmi                female            physhealth 
                 1.06                  1.08                  1.05 
           menthealth              sleephrs internet30 * genh_n=2 
                 1.01                  1.02                  1.01 
internet30 * genh_n=3 internet30 * genh_n=4 internet30 * genh_n=5 
                 1.00                  1.01                  1.03 
         bmi * female 
                 1.08 

Rate of Missing Information:

            Intercept            internet30              genh_n=2 
                 0.03                  0.00                  0.01 
             genh_n=3              genh_n=4              genh_n=5 
                 0.00                  0.01                  0.02 
                  bmi                female            physhealth 
                 0.05                  0.07                  0.04 
           menthealth              sleephrs internet30 * genh_n=2 
                 0.01                  0.02                  0.01 
internet30 * genh_n=3 internet30 * genh_n=4 internet30 * genh_n=5 
                 0.00                  0.01                  0.03 
         bmi * female 
                 0.08 

d.f. for t-distribution for Tests of Single Coefficients:

            Intercept            internet30              genh_n=2 
             21695.29            4552554.82             342982.63 
             genh_n=3              genh_n=4              genh_n=5 
           2393040.31             340219.46              43771.65 
                  bmi                female            physhealth 
              6985.80               3594.27               9984.27 
           menthealth              sleephrs internet30 * genh_n=2 
             87510.83              39656.28             292980.96 
internet30 * genh_n=3 internet30 * genh_n=4 internet30 * genh_n=5 
           6057039.66             610087.87              23370.34 
         bmi * female 
              3152.92 

The following fit components were averaged over the 20 model fits:

  stats linear.predictors </code></pre>
<p>OK. Let’s get the familiar description of an <code>lrm</code> model, after this multiple imputation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_imp</code></pre></div>
<pre><code>Logistic Regression Model
 
 fit.mult.impute(formula = exerany ~ internet30 * catg(genh_n) + 
     bmi * female + physhealth + menthealth + sleephrs, fitter = lrm, 
     xtrans = imp_fit, data = smartcle_imp0, x = TRUE, y = TRUE)
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs          1033    LR chi2     153.52    R2       0.207    C       0.743    
  0            247    d.f.            15    g        1.031    Dxy     0.487    
  1            786    Pr(&gt; chi2) &lt;0.0001    gr       2.803    gamma   0.487    
 max |deriv| 1e-12                          gp       0.176    tau-a   0.177    
                                            Brier    0.153                     
 
                       Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept              3.3183 0.9782  3.39  0.0007  
 internet30             0.6499 0.7013  0.93  0.3540  
 genh_n=2              -0.4613 0.7507 -0.61  0.5389  
 genh_n=3              -0.9069 0.6978 -1.30  0.1937  
 genh_n=4              -1.3287 0.7392 -1.80  0.0722  
 genh_n=5              -0.9257 0.8342 -1.11  0.2671  
 bmi                   -0.0408 0.0216 -1.89  0.0588  
 female                -0.9153 0.7786 -1.18  0.2398  
 physhealth            -0.0234 0.0103 -2.27  0.0235  
 menthealth            -0.0192 0.0115 -1.68  0.0934  
 sleephrs              -0.0407 0.0496 -0.82  0.4120  
 internet30 * genh_n=2  0.3503 0.8117  0.43  0.6661  
 internet30 * genh_n=3  0.1110 0.7549  0.15  0.8832  
 internet30 * genh_n=4 -0.1851 0.8117 -0.23  0.8196  
 internet30 * genh_n=5 -1.2268 0.9748 -1.26  0.2082  
 bmi * female           0.0108 0.0263  0.41  0.6822  
 </code></pre>
<p>We can obtain an ANOVA plot and an AIC plot to look at the predictors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(<span class="kw">anova</span>(m1_imp))
<span class="kw">plot</span>(<span class="kw">anova</span>(m1_imp), <span class="dt">what=</span><span class="st">&quot;aic&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<p>Here’s the summary of effect sizes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m1_imp)</code></pre></div>
<pre><code>             Effects              Response : exerany 

 Factor       Low  High  Diff. Effect    S.E.     Lower 0.95 Upper 0.95
 internet30    0.0  1.00 1.00   1.000300 0.411430  0.193880   1.8066000
  Odds Ratio   0.0  1.00 1.00   2.719000       NA  1.214000   6.0899000
 bmi          23.7 30.53 6.83  -0.279000 0.147670 -0.568430   0.0104310
  Odds Ratio  23.7 30.53 6.83   0.756540       NA  0.566410   1.0105000
 female        0.0  1.00 1.00  -0.628260 0.181140 -0.983290  -0.2732400
  Odds Ratio   0.0  1.00 1.00   0.533520       NA  0.374080   0.7609100
 physhealth    0.0  2.00 2.00  -0.046783 0.020654 -0.087264  -0.0063023
  Odds Ratio   0.0  2.00 2.00   0.954290       NA  0.916440   0.9937200
 menthealth    0.0  2.00 2.00  -0.038477 0.022932 -0.083422   0.0064689
  Odds Ratio   0.0  2.00 2.00   0.962250       NA  0.919960   1.0065000
 sleephrs      6.0  8.00 2.00  -0.081454 0.099287 -0.276050   0.1131500
  Odds Ratio   6.0  8.00 2.00   0.921770       NA  0.758770   1.1198000
 genh_n - 1:2  2.0  1.00   NA   0.461310 0.750680 -1.010000   1.9326000
  Odds Ratio   2.0  1.00   NA   1.586200       NA  0.364220   6.9076000
 genh_n - 3:2  2.0  3.00   NA  -0.445620 0.442710 -1.313300   0.4220800
  Odds Ratio   2.0  3.00   NA   0.640430       NA  0.268930   1.5251000
 genh_n - 4:2  2.0  4.00   NA  -0.867380 0.500240 -1.847800   0.1130700
  Odds Ratio   2.0  4.00   NA   0.420050       NA  0.157580   1.1197000
 genh_n - 5:2  2.0  5.00   NA  -0.464420 0.626480 -1.692300   0.7634700
  Odds Ratio   2.0  5.00   NA   0.628500       NA  0.184090   2.1457000

Adjusted to: internet30=0 genh_n=2 bmi=26.68 female=0  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">summary</span>(m1_imp))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<p>And here is the nomogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">nomogram</span>(m1_imp, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
<p>Here are the descriptive model plots, on the original probability scale for our <code>exerany</code> outcome:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">Predict</span>(m1_imp), <span class="dt">fun =</span> plogis)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<p>We can still do things like validate the summary statistics, too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validate</span>(m1_imp)</code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.4889   0.5155 0.4739   0.0416          0.4473 40
R2            0.2070   0.2299 0.1912   0.0388          0.1682 40
Intercept     0.0000   0.0000 0.1047  -0.1047          0.1047 40
Slope         1.0000   1.0000 0.8922   0.1078          0.8922 40
Emax          0.0000   0.0000 0.0442   0.0442          0.0442 40
D             0.1476   0.1659 0.1355   0.0304          0.1173 40
U            -0.0019  -0.0019 0.0022  -0.0041          0.0022 40
Q             0.1496   0.1678 0.1333   0.0345          0.1151 40
B             0.1533   0.1499 0.1563  -0.0064          0.1597 40
g             1.0307   1.1056 0.9773   0.1283          0.9024 40
gp            0.1764   0.1851 0.1686   0.0165          0.1599 40</code></pre>
</div>
<div id="model-2-with-multiple-imputation" class="section level3">
<h3><span class="header-section-number">14.11.2</span> Model 2 with Multiple Imputation</h3>
<p>The same approach is used to build the <code>m2_imp</code> multiple imputation fit for model <code>m2</code>, using the <code>fit.mult.impute</code> command, and specifying the model, the fitter (here, <code>lrm</code>), the imputation model (<code>xtrans = imp_fit</code>) and the data set prior to imputation (<code>smartcle_imp0</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2_imp &lt;-<span class="st"> </span><span class="kw">fit.mult.impute</span>(exerany <span class="op">~</span><span class="st"> </span>
<span class="st">            </span><span class="kw">rcs</span>(bmi, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rcs</span>(physhealth, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>female <span class="op">+</span><span class="st"> </span>internet30 <span class="op">*</span><span class="st"> </span><span class="kw">catg</span>(genh_n) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="kw">catg</span>(genh_n) <span class="op">%ia%</span><span class="st"> </span>physhealth <span class="op">+</span><span class="st"> </span>female <span class="op">%ia%</span><span class="st"> </span>bmi <span class="op">+</span><span class="st"> </span>
<span class="st">            </span>menthealth <span class="op">+</span><span class="st"> </span>sleephrs,
            <span class="dt">fitter =</span> lrm, <span class="dt">xtrans =</span> imp_fit,
            <span class="dt">data =</span> smartcle_imp0, <span class="dt">x =</span> <span class="ot">TRUE</span>, <span class="dt">y =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>
Variance Inflation Factors Due to Imputation:

            Intercept                   bmi                  bmi&#39; 
                 1.07                  1.08                  1.06 
                bmi&#39;&#39;            physhealth           physhealth&#39; 
                 1.06                  1.04                  1.02 
               female            internet30              genh_n=2 
                 1.08                  1.00                  1.01 
             genh_n=3              genh_n=4              genh_n=5 
                 1.00                  1.01                  1.01 
genh_n=2 * physhealth genh_n=3 * physhealth genh_n=4 * physhealth 
                 1.03                  1.03                  1.02 
genh_n=5 * physhealth          female * bmi            menthealth 
                 1.03                  1.09                  1.01 
             sleephrs internet30 * genh_n=2 internet30 * genh_n=3 
                 1.03                  1.01                  1.00 
internet30 * genh_n=4 internet30 * genh_n=5 
                 1.01                  1.04 

Rate of Missing Information:

            Intercept                   bmi                  bmi&#39; 
                 0.07                  0.07                  0.06 
                bmi&#39;&#39;            physhealth           physhealth&#39; 
                 0.06                  0.04                  0.02 
               female            internet30              genh_n=2 
                 0.08                  0.00                  0.01 
             genh_n=3              genh_n=4              genh_n=5 
                 0.00                  0.01                  0.01 
genh_n=2 * physhealth genh_n=3 * physhealth genh_n=4 * physhealth 
                 0.03                  0.03                  0.02 
genh_n=5 * physhealth          female * bmi            menthealth 
                 0.03                  0.08                  0.01 
             sleephrs internet30 * genh_n=2 internet30 * genh_n=3 
                 0.03                  0.01                  0.00 
internet30 * genh_n=4 internet30 * genh_n=5 
                 0.01                  0.04 

d.f. for t-distribution for Tests of Single Coefficients:

            Intercept                   bmi                  bmi&#39; 
              4380.39               3700.10               5557.48 
                bmi&#39;&#39;            physhealth           physhealth&#39; 
              5611.05              14728.96              42868.19 
               female            internet30              genh_n=2 
              3252.44            3009564.42             305690.58 
             genh_n=3              genh_n=4              genh_n=5 
           1329373.30             318205.87             190432.29 
genh_n=2 * physhealth genh_n=3 * physhealth genh_n=4 * physhealth 
             21003.64              22615.76              38202.98 
genh_n=5 * physhealth          female * bmi            menthealth 
             21998.83               3002.51             111867.55 
             sleephrs internet30 * genh_n=2 internet30 * genh_n=3 
             26186.82             211617.58            2865315.54 
internet30 * genh_n=4 internet30 * genh_n=5 
            551890.44              10977.39 

The following fit components were averaged over the 20 model fits:

  stats linear.predictors </code></pre>
<p>OK. Let’s get the familiar description of an <code>lrm</code> model, after this multiple imputation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2_imp</code></pre></div>
<pre><code>Logistic Regression Model
 
 fit.mult.impute(formula = exerany ~ rcs(bmi, 4) + rcs(physhealth, 
     5) + female + internet30 * catg(genh_n) + catg(genh_n) %ia% 
     physhealth + female %ia% bmi + menthealth + sleephrs, fitter = lrm, 
     xtrans = imp_fit, data = smartcle_imp0, x = TRUE, y = TRUE)
 
                       Model Likelihood     Discrimination    Rank Discrim.    
                          Ratio Test           Indexes           Indexes       
 Obs          1033    LR chi2     162.26    R2       0.218    C       0.746    
  0            247    d.f.            22    g        1.062    Dxy     0.492    
  1            786    Pr(&gt; chi2) &lt;0.0001    gr       2.892    gamma   0.492    
 max |deriv| 5e-12                          gp       0.180    tau-a   0.179    
                                            Brier    0.152                     
 
                       Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept              2.9915 1.9954  1.50  0.1338  
 bmi                   -0.0164 0.0812 -0.20  0.8397  
 bmi&#39;                  -0.2350 0.3356 -0.70  0.4837  
 bmi&#39;&#39;                  0.7236 0.9089  0.80  0.4260  
 physhealth             0.0261 0.0862  0.30  0.7624  
 physhealth&#39;           -0.2434 0.3696 -0.66  0.5102  
 female                -0.9680 0.8140 -1.19  0.2344  
 internet30             0.6182 0.7059  0.88  0.3812  
 genh_n=2              -0.4851 0.7558 -0.64  0.5210  
 genh_n=3              -0.8620 0.7066 -1.22  0.2225  
 genh_n=4              -1.2144 0.7554 -1.61  0.1079  
 genh_n=5              -2.7928 1.2040 -2.32  0.0204  
 genh_n=2 * physhealth -0.0061 0.0803 -0.08  0.9397  
 genh_n=3 * physhealth -0.0325 0.0775 -0.42  0.6750  
 genh_n=4 * physhealth -0.0322 0.0772 -0.42  0.6766  
 genh_n=5 * physhealth  0.0634 0.0856  0.74  0.4591  
 female * bmi           0.0111 0.0272  0.41  0.6831  
 menthealth            -0.0197 0.0117 -1.68  0.0923  
 sleephrs              -0.0554 0.0510 -1.09  0.2774  
 internet30 * genh_n=2  0.3882 0.8163  0.48  0.6344  
 internet30 * genh_n=3  0.1368 0.7617  0.18  0.8575  
 internet30 * genh_n=4 -0.1712 0.8203 -0.21  0.8347  
 internet30 * genh_n=5 -1.4939 0.9985 -1.50  0.1346  
 </code></pre>
<p>We can obtain an ANOVA plot and an AIC plot to look at the predictors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(<span class="kw">anova</span>(m2_imp))
<span class="kw">plot</span>(<span class="kw">anova</span>(m2_imp), <span class="dt">what=</span><span class="st">&quot;aic&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<p>Here’s the summary of effect sizes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m2_imp)</code></pre></div>
<pre><code>             Effects              Response : exerany 

 Factor       Low  High  Diff. Effect    S.E.     Lower 0.95 Upper 0.95
 bmi          23.7 30.53 6.83  -0.498810 0.233540 -0.956540  -0.0410830
  Odds Ratio  23.7 30.53 6.83   0.607250       NA  0.384220   0.9597500
 physhealth    0.0  2.00 2.00   0.037808 0.100250 -0.158680   0.2343000
  Odds Ratio   0.0  2.00 2.00   1.038500       NA  0.853270   1.2640000
 female        0.0  1.00 1.00  -0.671780 0.189360 -1.042900  -0.3006400
  Odds Ratio   0.0  1.00 1.00   0.510800       NA  0.352420   0.7403400
 internet30    0.0  1.00 1.00   1.006400 0.412260  0.198370   1.8144000
  Odds Ratio   0.0  1.00 1.00   2.735700       NA  1.219400   6.1374000
 menthealth    0.0  2.00 2.00  -0.039395 0.023405 -0.085267   0.0064773
  Odds Ratio   0.0  2.00 2.00   0.961370       NA  0.918270   1.0065000
 sleephrs      6.0  8.00 2.00  -0.110820 0.102030 -0.310800   0.0891530
  Odds Ratio   6.0  8.00 2.00   0.895100       NA  0.732860   1.0932000
 genh_n - 1:2  2.0  1.00   NA   0.485110 0.755780 -0.996190   1.9664000
  Odds Ratio   2.0  1.00   NA   1.624400       NA  0.369290   7.1450000
 genh_n - 3:2  2.0  3.00   NA  -0.376840 0.455990 -1.270600   0.5168800
  Odds Ratio   2.0  3.00   NA   0.686030       NA  0.280670   1.6768000
 genh_n - 4:2  2.0  4.00   NA  -0.729310 0.526230 -1.760700   0.3020700
  Odds Ratio   2.0  4.00   NA   0.482240       NA  0.171920   1.3527000
 genh_n - 5:2  2.0  5.00   NA  -2.307700 1.074000 -4.412600  -0.2026900
  Odds Ratio   2.0  5.00   NA   0.099493       NA  0.012123   0.8165300

Adjusted to: bmi=26.68 physhealth=0 female=0 internet30=0 genh_n=2  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">summary</span>(m2_imp))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
<p>And here is the nomogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">nomogram</span>(m2_imp, <span class="dt">fun =</span> plogis))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-269-1.png" width="672" /></p>
<p>Here are the descriptive model plots, on the scale of Pr(exerany = 1):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">Predict</span>(m2_imp), <span class="dt">fun =</span> plogis)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p>Validation of summary statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validate</span>(m2_imp)</code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected  n
Dxy           0.4950   0.5193 0.4672   0.0521          0.4430 40
R2            0.2179   0.2461 0.1885   0.0576          0.1603 40
Intercept     0.0000   0.0000 0.1847  -0.1847          0.1847 40
Slope         1.0000   1.0000 0.8311   0.1689          0.8311 40
Emax          0.0000   0.0000 0.0759   0.0759          0.0759 40
D             0.1561   0.1787 0.1335   0.0452          0.1109 40
U            -0.0019  -0.0019 0.0054  -0.0073          0.0054 40
Q             0.1580   0.1807 0.1281   0.0526          0.1055 40
B             0.1514   0.1473 0.1557  -0.0084          0.1598 40
g             1.0618   1.1583 0.9678   0.1905          0.8713 40
gp            0.1801   0.1901 0.1651   0.0250          0.1551 40</code></pre>
</div>
</div>
<div id="models-with-and-without-imputation" class="section level2">
<h2><span class="header-section-number">14.12</span> Models with and without Imputation</h2>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">1</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Imputation</td>
<td align="right">Simple</td>
<td align="right">Multiple</td>
<td align="right">Sim.</td>
<td align="right">Mult.</td>
</tr>
<tr class="even">
<td align="right">nominal R<sup>2</sup></td>
<td align="right">0.204</td>
<td align="right">0.204</td>
<td align="right">0.214</td>
<td align="right">0.218</td>
</tr>
<tr class="odd">
<td align="right">nominal C</td>
<td align="right">0.741</td>
<td align="right">0.741</td>
<td align="right">0.744</td>
<td align="right">0.746</td>
</tr>
<tr class="even">
<td align="right">validated R<sup>2</sup></td>
<td align="right">0.170</td>
<td align="right">0.168</td>
<td align="right">0.165</td>
<td align="right">0.160</td>
</tr>
<tr class="odd">
<td align="right">validated C</td>
<td align="right">0.722</td>
<td align="right">0.724</td>
<td align="right">0.720</td>
<td align="right">0.722</td>
</tr>
</tbody>
</table>
<p>So, what can we conclude about the discrimination results?</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>100 is generally safe but time-consuming. In the old days, we used to say 5. A reasonable idea is to identify the fraction of missingness in your variable with the most missingness, and if that’s 0.10, then you should run at least 100(0.10) = 10 sets of imputations.<a href="logistic-regression-and-the-smartcle1-data.html#fnref10">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-regression-and-the-resect-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-regression-and-the-smartcle1-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/14_logistic2.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
